import{e as Ot,r as x,j as e,R as W,S as ma,D as xa,f as nt,L as _t,B as fa,g as pa,h as we,i as ga}from"./react-D9ISAnAG.js";import{V as Lt,R as Mt,A as zt,C as Ut,T as Bt,D as Wt,P as ya,S as ja,a as $t,O as Ht,b as ba,c as Vt,d as it,e as Gt,f as Yt,L as qt,g as Kt,h as Xt,i as Jt,I as va,j as Zt,k as Na,l as Qt,m as wa,n as Ea,o as Ta,p as es,q as Sa,r as ts,s as ss,t as Ca,u as as,v as Fa,w as ns,x as is,y as ka,z as Da,B as rs,E as Ra,F as Pa,G as ls,H as os,J as cs,K as ds,M as Aa,N as Ia,Q as hs,U as Oa,W as us,X as ms,Y as _a,Z as xs,_ as fs,$ as La,a0 as ps,a1 as gs,a2 as ys,a3 as js,a4 as bs,a5 as vs,a6 as Ns,a7 as Ma,a8 as za}from"./radix-ui-Dkg1cM9f.js";import{t as Ua}from"./tailwind-plugins-D696Ktp4.js";import{X as Be,S as Ba,M as Wa,T as rt,C as lt,a as qe,P as ws,b as ot,c as $a,d as De,U as be,R as vt,e as Ke,Z as he,f as Xe,E as Ha,g as Va,B as Je,I as Ze,h as Se,F as Qe,i as et,j as ct,k as Me,l as Ga,A as Nt,m as wt,n as Et,o as Tt,p as Ya,q as Es,r as qa,s as Ka,t as Xa,u as Ja,v as Za,w as Qa,G as en,x as tt,y as tn,z as sn,D as an,L as nn,H as dt}from"./lucide-C9hsdsQt.js";import{G as Ts,s as St,b as Ss,P as st,a as rn,c as ln,S as on,d as cn,r as Ae}from"./pdf-tools-C1iXIf6M.js";import{L as ze}from"./router-ZHLP2sU8.js";import{Q as dn,a as hn}from"./react-query-fsOz5h-F.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const l of r.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function a(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(i){if(i.ep)return;i.ep=!0;const r=a(i);fetch(i.href,r)}})();const Ct=s=>typeof s=="boolean"?`${s}`:s===0?"0":s,Ft=Ot,ve=(s,t)=>a=>{var n;if((t==null?void 0:t.variants)==null)return Ft(s,a==null?void 0:a.class,a==null?void 0:a.className);const{variants:i,defaultVariants:r}=t,l=Object.keys(i).map(m=>{const u=a==null?void 0:a[m],c=r==null?void 0:r[m];if(u===null)return null;const h=Ct(u)||Ct(c);return i[m][h]}),o=a&&Object.entries(a).reduce((m,u)=>{let[c,h]=u;return h===void 0||(m[c]=h),m},{}),d=t==null||(n=t.compoundVariants)===null||n===void 0?void 0:n.reduce((m,u)=>{let{class:c,className:h,...v}=u;return Object.entries(v).every(w=>{let[N,E]=w;return Array.isArray(E)?E.includes({...r,...o}[N]):{...r,...o}[N]===E})?[...m,c,h]:m},[]);return Ft(s,l,d,a==null?void 0:a.class,a==null?void 0:a.className)};function O(...s){return Ua(Ot(s))}const un=ya,Cs=x.forwardRef(({className:s,...t},a)=>e.jsx(Lt,{ref:a,className:O("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",s),...t,"data-oid":"s.f4x0l"}));Cs.displayName=Lt.displayName;const mn=ve("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),xn=x.forwardRef(({className:s,variant:t,...a},n)=>e.jsx(Mt,{ref:n,className:O(mn({variant:t}),s),...a,"data-oid":"vcjgg6i"}));xn.displayName=Mt.displayName;const fn=x.forwardRef(({className:s,...t},a)=>e.jsx(zt,{ref:a,className:O("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",s),...t,"data-oid":"w320mq5"}));fn.displayName=zt.displayName;const pn=x.forwardRef(({className:s,...t},a)=>e.jsx(Ut,{ref:a,className:O("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",s),"toast-close":"",...t,"data-oid":"j8_uvk:",children:e.jsx(Be,{className:"h-4 w-4","data-oid":":vd5g6l"})}));pn.displayName=Ut.displayName;const gn=x.forwardRef(({className:s,...t},a)=>e.jsx(Bt,{ref:a,className:O("text-sm font-semibold",s),...t,"data-oid":"ed1qpvw"}));gn.displayName=Bt.displayName;const yn=x.forwardRef(({className:s,...t},a)=>e.jsx(Wt,{ref:a,className:O("text-sm opacity-90",s),...t,"data-oid":"yy.pzi9"}));yn.displayName=Wt.displayName;const jn=()=>e.jsx(un,{"data-oid":"6.mn:_0",children:e.jsx(Cs,{"data-oid":"-d9kf2l"})}),bn={theme:"system",setTheme:()=>null},Fs=x.createContext(bn);function vn({children:s,defaultTheme:t="dark",storageKey:a="pdf4ever-theme",...n}){const[i,r]=x.useState(()=>localStorage.getItem(a)||t);x.useEffect(()=>{const o=window.document.documentElement;if(o.classList.remove("light","dark"),i==="system"){const d=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";o.classList.add(d);return}o.classList.add(i)},[i]);const l={theme:i,setTheme:o=>{localStorage.setItem(a,o),r(o)}};return e.jsx(Fs.Provider,{...n,value:l,"data-oid":":qp6u-m",children:s})}const Nn=()=>{const s=x.useContext(Fs);if(s===void 0)throw new Error("useTheme must be used within a ThemeProvider");return s},wn=ve("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),R=x.forwardRef(({className:s,variant:t,size:a,asChild:n=!1,...i},r)=>{const l=n?ja:"button";return e.jsx(l,{className:O(wn({variant:t,size:a,className:s})),ref:r,...i,"data-oid":"-5u4-3m"})});R.displayName="Button";const z=x.forwardRef(({className:s,type:t,...a},n)=>e.jsx("input",{type:t,className:O("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:n,...a,"data-oid":"xkro7lb"}));z.displayName="Input";const En=ve("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),M=x.forwardRef(({className:s,...t},a)=>e.jsx($t,{ref:a,className:O(En(),s),...t,"data-oid":"rl-1a3o"}));M.displayName=$t.displayName;const Tn=ba,ks=x.forwardRef(({className:s,...t},a)=>e.jsx(Ht,{ref:a,className:O("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...t,"data-oid":"5qktnfj"}));ks.displayName=Ht.displayName;const Sn=x.forwardRef(({className:s,children:t,...a},n)=>e.jsxs(Tn,{"data-oid":"-ox--v-",children:[e.jsx(ks,{"data-oid":"kbem9zl"}),e.jsxs(Vt,{ref:n,className:O("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...a,"data-oid":"r-5j-k5",children:[t,e.jsxs(it,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground","data-oid":"7gqik.n",children:[e.jsx(Be,{className:"h-4 w-4","data-oid":"kwmq4hl"}),e.jsx("span",{className:"sr-only","data-oid":"t-rn3ax",children:"Close"})]})]})]}));Sn.displayName=Vt.displayName;const Cn=x.forwardRef(({className:s,children:t,...a},n)=>e.jsx(Gt,{ref:n,className:O("text-lg font-semibold leading-none tracking-tight",s),...a,"data-oid":"ezxoukh",children:t}));Cn.displayName=Gt.displayName;const Fn=x.forwardRef(({className:s,children:t,...a},n)=>e.jsx(Yt,{ref:n,className:O("text-sm text-muted-foreground",s),...a,"data-oid":"b8a-ucv",children:t}));Fn.displayName=Yt.displayName;const kn=x.forwardRef((s,t)=>e.jsx(it,{ref:t,...s,"data-oid":"ex_b5jw"}));kn.displayName=it.displayName;const Dn=x.forwardRef(({className:s,...t},a)=>e.jsx(qt,{ref:a,className:O("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",s),...t,"data-oid":"l1h4bs6"}));Dn.displayName=qt.displayName;const Rn=x.forwardRef(({className:s,...t},a)=>e.jsx(Kt,{ref:a,className:O("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",s),...t,"data-oid":"5wnt-bf"}));Rn.displayName=Kt.displayName;const Pn=x.forwardRef(({className:s,...t},a)=>e.jsx(Xt,{ref:a,className:O("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...t,"data-oid":"e_en3q6"}));Pn.displayName=Xt.displayName;const An=ve("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),In=x.forwardRef(({className:s,variant:t,...a},n)=>e.jsx("div",{ref:n,role:"alert",className:O(An({variant:t}),s),...a,"data-oid":"2qufk4:"}));In.displayName="Alert";const On=x.forwardRef(({className:s,...t},a)=>e.jsx("h5",{ref:a,className:O("mb-1 font-medium leading-none tracking-tight",s),...t,"data-oid":"k.wkkl:"}));On.displayName="AlertTitle";const _n=x.forwardRef(({className:s,...t},a)=>e.jsx("div",{ref:a,className:O("text-sm [&_p]:leading-relaxed",s),...t,"data-oid":"em40voh"}));_n.displayName="AlertDescription";const Ln=x.createContext(void 0);function Mn({children:s}){const[t,a]=x.useState(null),[n,i]=x.useState(!0),[r,l]=x.useState(null);x.useEffect(()=>{if(typeof window<"u"&&!window.location.hostname.includes("replit")){i(!1);return}o()},[]);const o=async()=>{try{const h=await fetch("/api/auth/user",{credentials:"include"});if(h.ok){const v=await h.json();a(v)}}catch(h){console.error("Auth check failed:",h)}finally{i(!1)}},c={user:t,login:async(h,v)=>{i(!0),l(null);try{const w=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({email:h,password:v})}),N=await w.json();if(!w.ok)throw new Error(N.error||"Login failed");a(N.user)}catch(w){l(w instanceof Error?w.message:"Login failed")}finally{i(!1)}},signup:async(h,v,w)=>{i(!0),l(null);try{const N=await fetch("/api/auth/signup",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({email:h,password:v,name:w})}),E=await N.json();if(!N.ok)throw new Error(E.error||"Signup failed");a(E.user)}catch(N){l(N instanceof Error?N.message:"Signup failed")}finally{i(!1)}},logout:async()=>{i(!0);try{await fetch("/api/auth/logout",{method:"POST",credentials:"include"}),a(null)}catch(h){console.error("Logout failed:",h)}finally{i(!1)}},isLoading:n,error:r};return e.jsx(Ln.Provider,{value:c,"data-oid":"d:4zizb",children:s})}function zn(){const{theme:s,setTheme:t}=Nn(),a=()=>{t(s==="light"?"dark":"light")};return e.jsxs(R,{variant:"ghost",size:"icon",onClick:a,className:"h-9 w-9 rounded-lg hover:bg-muted transition-colors","data-oid":"zj05xty",children:[e.jsx(Ba,{className:"h-4 w-4 rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0","data-oid":"v.ru6l:"}),e.jsx(Wa,{className:"absolute h-4 w-4 rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100","data-oid":"k1w9vv:"}),e.jsx("span",{className:"sr-only","data-oid":"3-9_5bi",children:"Toggle theme"})]})}const V=x.forwardRef(({className:s,...t},a)=>e.jsx("div",{ref:a,className:O("rounded-lg border bg-card text-card-foreground shadow-sm",s),...t,"data-oid":"07h4zeb"}));V.displayName="Card";const ne=x.forwardRef(({className:s,...t},a)=>e.jsx("div",{ref:a,className:O("flex flex-col space-y-1.5 p-6",s),...t,"data-oid":"gs4d_ov"}));ne.displayName="CardHeader";const ie=x.forwardRef(({className:s,...t},a)=>e.jsx("div",{ref:a,className:O("text-2xl font-semibold leading-none tracking-tight",s),...t,"data-oid":"srxm3ap"}));ie.displayName="CardTitle";const Un=x.forwardRef(({className:s,...t},a)=>e.jsx("div",{ref:a,className:O("text-sm text-muted-foreground",s),...t,"data-oid":"ktc9i.m"}));Un.displayName="CardDescription";const G=x.forwardRef(({className:s,...t},a)=>e.jsx("div",{ref:a,className:O("p-6 pt-0",s),...t,"data-oid":"uj45tt9"}));G.displayName="CardContent";const Bn=x.forwardRef(({className:s,...t},a)=>e.jsx("div",{ref:a,className:O("flex items-center p-6 pt-0",s),...t,"data-oid":"mrkos5c"}));Bn.displayName="CardFooter";const Ce=x.forwardRef(({className:s,value:t,...a},n)=>e.jsx(Jt,{ref:n,className:O("relative h-4 w-full overflow-hidden rounded-full bg-secondary",s),...a,"data-oid":"d19.2te",children:e.jsx(va,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(t||0)}%)`},"data-oid":"6q76ma5"})}));Ce.displayName=Jt.displayName;const Ee=x.forwardRef(({className:s,...t},a)=>e.jsx(Zt,{className:O("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",s),...t,ref:a,"data-oid":"_qay8bt",children:e.jsx(Na,{className:O("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0"),"data-oid":"lzku.lj"})}));Ee.displayName=Zt.displayName;const Wn=ve("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function Fe({className:s,variant:t,...a}){return e.jsx("div",{className:O(Wn({variant:t}),s),...a,"data-oid":"z_:izyu"})}function $n({detectedFonts:s,isAnalyzing:t,analysisProgress:a,onFontMappingChange:n,settings:i,onSettingsChange:r}){const l=(d,m)=>{r({[d]:m})},o=d=>d.confidence>.8?e.jsx(lt,{className:"h-3 w-3 text-green-500"}):d.confidence>.5?e.jsx(qe,{className:"h-3 w-3 text-yellow-500"}):e.jsx(qe,{className:"h-3 w-3 text-red-500"});return e.jsxs("div",{className:"space-y-4","data-testid":"font-recognition-panel",children:[e.jsxs(V,{children:[e.jsx(ne,{className:"pb-3",children:e.jsxs(ie,{className:"text-sm flex items-center gap-2",children:[e.jsx(rt,{className:"h-4 w-4 text-primary"}),"Font Recognition"]})}),e.jsxs(G,{className:"space-y-3",children:[t&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"font-medium",children:"Analyzing document"}),e.jsxs("span",{className:"text-muted-foreground",children:[Math.round(a),"%"]})]}),e.jsx(Ce,{value:a,className:"h-2","data-testid":"analysis-progress"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Processing fonts and text regions..."})]}),!t&&s.length>0&&e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-green-800",children:"Recognition Complete"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),e.jsx("span",{className:"text-xs text-green-600",children:"Active"})]})]}),e.jsxs("p",{className:"text-xs text-green-600 mt-1",children:["Found ",s.length," font",s.length!==1?"s":""]})]})]})]}),s.length>0&&e.jsxs(V,{children:[e.jsx(ne,{className:"pb-3",children:e.jsxs(ie,{className:"text-sm",children:["Detected Fonts (",s.length,")"]})}),e.jsx(G,{children:e.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:s.map(d=>e.jsxs("div",{className:O("flex items-center justify-between p-2 rounded-lg border",d.isSystemFont?"bg-green-50 border-green-200":"bg-amber-50 border-amber-200"),"data-testid":`detected-font-${d.id}`,children:[e.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[o(d),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium truncate",children:d.fontFamily}),d.fontWeight==="bold"&&e.jsx(Fe,{variant:"secondary",className:"text-xs px-1 py-0",children:"B"}),d.fontStyle==="italic"&&e.jsx(Fe,{variant:"secondary",className:"text-xs px-1 py-0",children:"I"})]}),d.fallbackFont&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Fallback: ",d.fallbackFont]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-xs font-medium",children:[d.instances," instance",d.instances!==1?"s":""]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[Math.round(d.confidence*100),"% confidence"]})]})]},d.id))})})]}),e.jsxs(V,{children:[e.jsx(ne,{className:"pb-3",children:e.jsx(ie,{className:"text-sm",children:"Font Matching"})}),e.jsxs(G,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx("label",{className:"text-sm font-medium",children:"Auto-match fonts"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Automatically match detected fonts to system fonts"})]}),e.jsx(Ee,{checked:i.autoFontMatch,onCheckedChange:d=>l("autoFontMatch",d),"data-testid":"switch-auto-match"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx("label",{className:"text-sm font-medium",children:"Use fallback fonts"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Use similar fonts when exact matches are not available"})]}),e.jsx(Ee,{checked:i.useFallbackFonts,onCheckedChange:d=>l("useFallbackFonts",d),"data-testid":"switch-fallback-fonts"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx("label",{className:"text-sm font-medium",children:"Real-time preview"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Show font changes as you edit"})]}),e.jsx(Ee,{checked:i.realTimePreview??!1,onCheckedChange:d=>l("realTimePreview",d),"data-testid":"switch-realtime-preview"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx("label",{className:"text-sm font-medium",children:"Show warnings"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Display alerts for font mismatches"})]}),e.jsx(Ee,{checked:i.showFontWarnings,onCheckedChange:d=>l("showFontWarnings",d),"data-testid":"switch-font-warnings"})]})]})]})]})}function Hn({settings:s,onSettingChange:t,editorState:a}){const n=Object.values(a.detectedFonts).flat();return e.jsxs("div",{className:"space-y-4","data-testid":"inline-edit-tool",children:[e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:[e.jsx("h4",{className:"text-sm font-medium text-blue-800 mb-2",children:"Inline Text Editing"}),e.jsx("p",{className:"text-xs text-blue-600",children:"Click on any text in the PDF to edit it directly. Font recognition will automatically match the original styling."})]}),e.jsx($n,{detectedFonts:n,isAnalyzing:!1,analysisProgress:0,onFontMappingChange:()=>{},settings:{autoFontMatch:s.autoFontMatch??!0,useFallbackFonts:s.useFallbackFonts??!0,showFontWarnings:s.showFontWarnings??!1},onSettingsChange:i=>{Object.entries(i).forEach(([r,l])=>{t(r,l)})}})]})}const Vn={name:"inlineEdit",label:"Inline Edit",icon:e.jsx(ws,{className:"h-4 w-4"}),component:Hn,category:"text",shortcut:"E",defaultSettings:{autoFontMatch:!0,useFallbackFonts:!0,realTimePreview:!0,showFontWarnings:!1,fontFamily:"Arial",fontSize:14,color:"#000000",bold:!1,italic:!1,textAlign:"left"},description:"Click on text in the PDF to edit it inline with automatic font matching"},re=x.forwardRef(({className:s,...t},a)=>e.jsxs(Qt,{ref:a,className:O("relative flex w-full touch-none select-none items-center",s),...t,"data-oid":"9kv6z0s",children:[e.jsx(wa,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary","data-oid":"m9ibfpu",children:e.jsx(Ea,{className:"absolute h-full bg-primary","data-oid":":qk4m45"})}),e.jsx(Ta,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50","data-oid":"p34mmlx"})]}));re.displayName=Qt.displayName;const K=Ra,X=Pa,Y=x.forwardRef(({className:s,children:t,...a},n)=>e.jsxs(es,{ref:n,className:O("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",s),...a,"data-oid":"0.778bz",children:[t,e.jsx(Sa,{asChild:!0,"data-oid":"s88.gfl",children:e.jsx(ot,{className:"h-4 w-4 opacity-50","data-oid":"pnfd5o0"})})]}));Y.displayName=es.displayName;const Ds=x.forwardRef(({className:s,...t},a)=>e.jsx(ts,{ref:a,className:O("flex cursor-default items-center justify-center py-1",s),...t,"data-oid":"l5js1ub",children:e.jsx($a,{className:"h-4 w-4","data-oid":"mlz.byh"})}));Ds.displayName=ts.displayName;const Rs=x.forwardRef(({className:s,...t},a)=>e.jsx(ss,{ref:a,className:O("flex cursor-default items-center justify-center py-1",s),...t,"data-oid":"_awijz_",children:e.jsx(ot,{className:"h-4 w-4","data-oid":"5muezs4"})}));Rs.displayName=ss.displayName;const q=x.forwardRef(({className:s,children:t,position:a="popper",...n},i)=>e.jsx(Ca,{"data-oid":"weioq8d",children:e.jsxs(as,{ref:i,className:O("relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]",a==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:a,...n,"data-oid":"as3xcts",children:[e.jsx(Ds,{"data-oid":"9sr2mgb"}),e.jsx(Fa,{className:O("p-1",a==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),"data-oid":"7t0ej.v",children:t}),e.jsx(Rs,{"data-oid":"wpurb9k"})]})}));q.displayName=as.displayName;const Gn=x.forwardRef(({className:s,...t},a)=>e.jsx(ns,{ref:a,className:O("py-1.5 pl-8 pr-2 text-sm font-semibold",s),...t,"data-oid":"8gs7ty-"}));Gn.displayName=ns.displayName;const L=x.forwardRef(({className:s,children:t,...a},n)=>e.jsxs(is,{ref:n,className:O("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...a,"data-oid":"okjpj1w",children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center","data-oid":"tv250zd",children:e.jsx(ka,{"data-oid":"0ped7b6",children:e.jsx(De,{className:"h-4 w-4","data-oid":"x1-v__g"})})}),e.jsx(Da,{"data-oid":"ug.y8:8",children:t})]}));L.displayName=is.displayName;const Yn=x.forwardRef(({className:s,...t},a)=>e.jsx(rs,{ref:a,className:O("-mx-1 my-1 h-px bg-muted",s),...t,"data-oid":"39d3wfy"}));Yn.displayName=rs.displayName;const qn=({settings:s})=>{const t={width:`${s.brushSize||3}px`,height:`${s.brushSize||3}px`,backgroundColor:s.color||"#000000",borderRadius:"50%",opacity:s.opacity??1};return e.jsx("div",{className:"p-2 border rounded-md bg-white dark:bg-gray-800 flex items-center justify-center h-20",children:e.jsx("div",{style:t})})},Kn=({settings:s,onSettingChange:t,compact:a=!1})=>a?e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(z,{type:"color",value:s.color||"#000000",onChange:n=>t("color",n.target.value),className:"w-8 h-8 p-0 cursor-pointer",title:"Brush Color"}),e.jsx(z,{type:"number",value:s.brushSize||3,onChange:n=>t("brushSize",parseInt(n.target.value)||3),className:"w-16",min:1,max:50,title:"Brush Size"}),e.jsx(z,{type:"range",min:10,max:100,step:5,value:(s.opacity??1)*100,onChange:n=>t("opacity",parseInt(n.target.value)/100),className:"w-20",title:`Opacity: ${Math.round((s.opacity??1)*100)}%`}),e.jsxs(K,{value:s.smoothing||"medium",onValueChange:n=>t("smoothing",n),children:[e.jsx(Y,{className:"w-20",children:e.jsx(X,{})}),e.jsxs(q,{children:[e.jsx(L,{value:"none",children:"None"}),e.jsx(L,{value:"low",children:"Low"}),e.jsx(L,{value:"medium",children:"Medium"}),e.jsx(L,{value:"high",children:"High"})]})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(M,{className:"text-xs",children:"Brush Color"}),e.jsx(z,{type:"color",value:s.color||"#000000",onChange:n=>t("color",n.target.value),className:"w-full h-8 p-0 cursor-pointer"})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs(M,{className:"text-xs",children:["Opacity: ",Math.round((s.opacity??1)*100),"%"]}),e.jsx(re,{value:[(s.opacity??1)*100],onValueChange:([n])=>t("opacity",n/100),min:10,max:100,step:5})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs(M,{className:"text-xs",children:["Brush Size: ",s.brushSize||3,"px"]}),e.jsx(re,{value:[s.brushSize||3],onValueChange:([n])=>t("brushSize",n),min:1,max:50,step:1})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(M,{className:"text-xs",children:"Smoothing"}),e.jsxs(K,{value:s.smoothing||"medium",onValueChange:n=>t("smoothing",n),children:[e.jsx(Y,{children:e.jsx(X,{placeholder:"Select level"})}),e.jsxs(q,{children:[e.jsx(L,{value:"none",children:"None"}),e.jsx(L,{value:"low",children:"Low"}),e.jsx(L,{value:"medium",children:"Medium"}),e.jsx(L,{value:"high",children:"High"})]})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(M,{className:"text-xs",children:"Preview"}),e.jsx(qn,{settings:s})]})]}),Ps=ve("inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 gap-2",{variants:{variant:{default:"bg-transparent",outline:"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground"},size:{default:"h-10 px-3 min-w-10",sm:"h-9 px-2.5 min-w-9",lg:"h-11 px-5 min-w-11"}},defaultVariants:{variant:"default",size:"default"}}),Xn=x.forwardRef(({className:s,variant:t,size:a,...n},i)=>e.jsx(ls,{ref:i,className:O(Ps({variant:t,size:a,className:s})),...n,"data-oid":"67m5bc:"}));Xn.displayName=ls.displayName;const As=x.createContext({size:"default",variant:"default"}),We=x.forwardRef(({className:s,variant:t,size:a,children:n,...i},r)=>e.jsx(os,{ref:r,className:O("flex items-center justify-center gap-1",s),...i,"data-oid":"kqg11zt",children:e.jsx(As.Provider,{value:{variant:t,size:a},"data-oid":"m0k62iz",children:n})}));We.displayName=os.displayName;const ke=x.forwardRef(({className:s,children:t,variant:a,size:n,...i},r)=>{const l=x.useContext(As);return e.jsx(cs,{ref:r,className:O(Ps({variant:l.variant||a,size:l.size||n}),s),...i,"data-oid":"nxvg55m",children:t})});ke.displayName=cs.displayName;const kt=[{name:"Yellow",value:"#FFFF00"},{name:"Pink",value:"#FFC0CB"},{name:"Green",value:"#90EE90"},{name:"Blue",value:"#ADD8E6"}],Is=({settings:s,onSettingChange:t,compact:a=!1})=>{const n=s.color||"#FFFF00";return a?e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(z,{type:"color",value:n,onChange:i=>t("color",i.target.value),className:"w-8 h-8 p-0 cursor-pointer",title:"Highlight Color"}),kt.map(i=>e.jsx("button",{className:`w-6 h-6 rounded border-2 ${n.toUpperCase()===i.value?"border-primary":"border-gray-300"}`,style:{backgroundColor:i.value},onClick:()=>t("color",i.value),title:i.name},i.name)),e.jsx(z,{type:"range",min:10,max:100,step:5,value:(s.opacity||.5)*100,onChange:i=>t("opacity",parseInt(i.target.value)/100),className:"w-20",title:`Opacity: ${Math.round((s.opacity||.5)*100)}%`}),e.jsxs(K,{value:s.blendMode||"multiply",onValueChange:i=>t("blendMode",i),children:[e.jsx(Y,{className:"w-24",children:e.jsx(X,{})}),e.jsxs(q,{children:[e.jsx(L,{value:"multiply",children:"Multiply"}),e.jsx(L,{value:"overlay",children:"Overlay"}),e.jsx(L,{value:"screen",children:"Screen"}),e.jsx(L,{value:"normal",children:"Normal"})]})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(M,{className:"text-xs",children:"Highlight Style"}),e.jsxs(K,{value:s.style||"solid",onValueChange:i=>t("style",i),children:[e.jsx(Y,{children:e.jsx(X,{placeholder:"Select style"})}),e.jsxs(q,{children:[e.jsx(L,{value:"solid",children:"Solid"}),e.jsx(L,{value:"underline",children:"Underline"}),e.jsx(L,{value:"strikethrough",children:"Strikethrough"}),e.jsx(L,{value:"squiggly",children:"Squiggly"})]})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(M,{className:"text-xs",children:"Highlight Color"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(z,{type:"color",value:n,onChange:i=>t("color",i.target.value),className:"w-10 h-10 p-0 cursor-pointer"}),e.jsx(We,{type:"single",value:n.toUpperCase(),onValueChange:i=>{i&&t("color",i)},className:"grid grid-cols-4 gap-1 w-full",children:kt.map(i=>e.jsx(ke,{value:i.value,"aria-label":i.name,className:O("w-full h-10 rounded-md border-2 border-transparent focus:z-10","data-[state=on]:border-primary"),style:{backgroundColor:i.value}},i.name))})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs(M,{className:"text-xs",children:["Opacity: ",Math.round((s.opacity||.5)*100),"%"]}),e.jsx(re,{value:[(s.opacity||.5)*100],onValueChange:([i])=>t("opacity",i/100),min:10,max:100,step:5})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(M,{className:"text-xs",children:"Blend Mode"}),e.jsxs(K,{value:s.blendMode||"multiply",onValueChange:i=>t("blendMode",i),children:[e.jsx(Y,{children:e.jsx(X,{placeholder:"Select blend mode"})}),e.jsxs(q,{children:[e.jsx(L,{value:"multiply",children:"Multiply (Recommended)"}),e.jsx(L,{value:"overlay",children:"Overlay"}),e.jsx(L,{value:"screen",children:"Screen"}),e.jsx(L,{value:"normal",children:"Normal"})]})]}),e.jsx("p",{className:"text-[11px] text-muted-foreground pt-1",children:"`‘` Multiply `‘` provides the most natural, ink-like appearance."})]})]})},Os=({settings:s,onSettingChange:t,compact:a=!1})=>{const{state:n,dispatch:i}=ee(),{selectedElementId:r,selectedElementType:l,imageElements:o,currentPage:d}=n,m=x.useRef(null),u=l==="image"&&r,c=u?Object.values(o).flat().find(g=>g.id===r):null,h=(c==null?void 0:c.opacity)??s.opacity??1,v=(c==null?void 0:c.rotation)??s.rotation??0,w=(c==null?void 0:c.borderWidth)??s.borderWidth??0,N=(c==null?void 0:c.borderColor)??s.borderColor??"#000000",E=(g,j)=>{u&&c?(i({type:"UPDATE_IMAGE_ELEMENT",payload:{page:c.page,id:c.id,updates:{[g]:j}}}),i({type:"SAVE_TO_HISTORY"})):t(g,j)},p=g=>{var b;const j=(b=g.target.files)==null?void 0:b[0];if(!j)return;if(!["image/jpeg","image/jpg","image/png","image/gif","image/webp","image/svg+xml"].includes(j.type)){alert("Please select a valid image file (JPEG, PNG, GIF, WebP, or SVG)");return}if(j.size>10*1024*1024){alert("Image file is too large. Please select a file smaller than 10MB.");return}const f=new FileReader;f.onload=A=>{var y;const F=(y=A.target)==null?void 0:y.result,k=new Image;k.onload=()=>{let S=k.width,_=k.height;if(S>300||_>300){const B=Math.min(300/S,300/_);S*=B,_*=B}const $={id:`image-${Date.now()}`,page:d,src:F,x:100,y:100,width:S,height:_,rotation:0,opacity:1,borderWidth:0,borderColor:"#000000"};i({type:"ADD_IMAGE_ELEMENT",payload:{page:d,element:$}}),i({type:"SET_SELECTED_ELEMENTS",payload:{ids:[$.id],type:"image"}}),i({type:"SAVE_TO_HISTORY"})},k.src=F},f.readAsDataURL(j),g.target.value=""},C=g=>{E("rotation",(v+g)%360)};return a?e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(R,{onClick:()=>{var g;return(g=m.current)==null?void 0:g.click()},size:"sm",variant:"outline",children:[e.jsx(be,{className:"h-3 w-3 mr-1"}),"Upload"]}),e.jsx("input",{ref:m,type:"file",accept:"image/jpeg,image/jpg,image/png,image/gif,image/webp,image/svg+xml",onChange:p,className:"hidden"}),e.jsx(z,{type:"range",min:0,max:100,step:5,value:h*100,onChange:g=>E("opacity",parseInt(g.target.value)/100),className:"w-20",disabled:!u,title:`Opacity: ${Math.round(h*100)}%`}),e.jsx(z,{type:"number",value:v,onChange:g=>E("rotation",parseInt(g.target.value)||0),className:"w-16",min:-360,max:360,disabled:!u,title:"Rotation"}),e.jsx(R,{variant:"outline",size:"sm",onClick:()=>C(-90),disabled:!u,children:e.jsx(vt,{className:"h-3 w-3"})}),e.jsx(R,{variant:"outline",size:"sm",onClick:()=>C(90),disabled:!u,children:e.jsx(Ke,{className:"h-3 w-3"})})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:u?"Adjust properties of the selected image.":"Upload and place a new image on the page."}),!u&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs(R,{onClick:()=>{var g;return(g=m.current)==null?void 0:g.click()},className:"w-full",variant:"outline",children:[e.jsx(be,{className:"h-4 w-4 mr-2"}),"Upload Image"]}),e.jsx("input",{ref:m,type:"file",accept:"image/jpeg,image/jpg,image/png,image/gif,image/webp,image/svg+xml",onChange:p,className:"hidden"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Supports JPEG, PNG, GIF, WebP, SVG (max 10MB)"})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs(M,{className:"text-xs",children:["Opacity: ",Math.round(h*100),"%"]}),e.jsx(re,{value:[h*100],onValueChange:([g])=>E("opacity",g/100),min:0,max:100,step:5,disabled:!u})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs(M,{className:"text-xs",children:["Rotation: ",v,"°"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(z,{type:"number",value:v,onChange:g=>E("rotation",parseInt(g.target.value)||0),className:"w-full",min:-360,max:360,disabled:!u}),e.jsx(R,{variant:"outline",size:"icon",onClick:()=>C(-90),disabled:!u,children:e.jsx(vt,{size:16})}),e.jsx(R,{variant:"outline",size:"icon",onClick:()=>C(90),disabled:!u,children:e.jsx(Ke,{size:16})})]}),e.jsx(re,{value:[v],onValueChange:([g])=>E("rotation",g),min:0,max:360,step:1,disabled:!u})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs(M,{className:"text-xs",children:["Border Width: ",w,"px"]}),e.jsx(re,{value:[w],onValueChange:([g])=>E("borderWidth",g),min:0,max:20,step:1,disabled:!u})]}),w>0&&e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(M,{className:"text-xs",children:"Border Color"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(z,{type:"color",value:N,onChange:g=>E("borderColor",g.target.value),className:"w-12 h-8 p-1 border rounded",disabled:!u}),e.jsx(z,{type:"text",value:N,onChange:g=>E("borderColor",g.target.value),className:"flex-1",placeholder:"#000000",disabled:!u})]})]}),u&&c&&e.jsxs("div",{className:"pt-2 border-t space-y-1",children:[e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Size: ",Math.round(c.width)," × ",Math.round(c.height),"px"]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Position: (",Math.round(c.x),", ",Math.round(c.y),")"]})]})]})};Ts.workerSrc="/pdf.worker.js";console.log("PDF.js worker configured with a static path:",Ts.workerSrc);const Dt=[{code:"eng",name:"English"},{code:"spa",name:"Spanish"},{code:"fra",name:"French"},{code:"deu",name:"German"},{code:"chi_sim",name:"Chinese (Simplified)"},{code:"jpn",name:"Japanese"},{code:"kor",name:"Korean"},{code:"rus",name:"Russian"},{code:"ara",name:"Arabic"},{code:"por",name:"Portuguese"}];class fe{static getInstance(){return fe.instance||(fe.instance=new fe),fe.instance}async performOCR(t,a="eng",n=1,i=1,r){const l=await St.createWorker(a,1,{logger:o=>{if(o.status==="recognizing text"&&r){const d=o.progress/i,m=(n-1)/i+d;r(Math.round(m*100))}}});try{await l.setParameters({tessedit_pageseg_mode:St.PSM.AUTO});const{data:o}=await l.recognize(t),d=(o.words||[]).filter(m=>m.text.trim()&&m.confidence>30).map((m,u)=>({id:`ocr-${n}-${u}`,text:m.text,confidence:m.confidence,boundingBox:{x0:m.bbox.x0,y0:m.bbox.y0,x1:m.bbox.x1,y1:m.bbox.y1},page:n}));return{ocrText:o.text||"",ocrResults:d}}catch(o){throw console.error("OCR recognition failed:",o),new Error("OCR recognition failed.")}finally{await l.terminate()}}async performPDFOCR(t,a="eng",n){const i=await t.arrayBuffer(),r=await Ss({data:i}).promise;let l=[];const o=[];let d;for(let m=1;m<=r.numPages;m++){const u=await r.getPage(m),c=u.getViewport({scale:1.5}),h=document.createElement("canvas"),v=h.getContext("2d");if(!v)continue;h.width=c.width,h.height=c.height,await u.render({canvasContext:v,viewport:c}).promise;const w=h.toDataURL("image/png");m===1&&(d=w);const{ocrText:N,ocrResults:E}=await this.performOCR(w,a,m,r.numPages,n);o.push(N),l=l.concat(E)}return{ocrText:o.join(`

`),ocrResults:l,previewUrl:d}}async extractPDFText(t,a){try{const i=await(await t.getPage(a)).getTextContent();let r="";const l=[];return i.items.forEach((o,d)=>{"str"in o&&o.str.trim()&&(r+=o.str+" ",l.push({id:`pdf-text-${d}`,text:o.str,confidence:100,boundingBox:{x0:o.transform[4],y0:o.transform[5],x1:o.transform[4]+(o.width||0),y1:o.transform[5]+(o.height||0)},page:a}))}),{extractedText:r.trim(),results:l}}catch(n){throw console.error("PDF text extraction error:",n),new Error("PDF text extraction failed.")}}highlightTextOnCanvas(t,a){if(!(a!=null&&a.current))return;const i=a.current.getContext("2d");i&&(i.save(),i.globalAlpha=.4,i.fillStyle="#FFD700",i.fillRect(t.boundingBox.x0,t.boundingBox.y0,t.boundingBox.x1-t.boundingBox.x0,t.boundingBox.y1-t.boundingBox.y0),i.restore())}}const Ve=fe.getInstance(),ht=x.forwardRef(({className:s,...t},a)=>e.jsx("textarea",{className:O("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:a,...t,"data-oid":":t2mfxk"}));ht.displayName="Textarea";const Re=x.forwardRef(({className:s,children:t,...a},n)=>e.jsxs(ds,{ref:n,className:O("relative overflow-hidden",s),...a,"data-oid":"3_s2ust",children:[e.jsx(Aa,{className:"h-full w-full rounded-[inherit]","data-oid":"e1wu-hi",children:t}),e.jsx(_s,{"data-oid":"cqa3lp0"}),e.jsx(Ia,{"data-oid":"s8l5rgy"})]}));Re.displayName=ds.displayName;const _s=x.forwardRef(({className:s,orientation:t="vertical",...a},n)=>e.jsx(hs,{ref:n,orientation:t,className:O("flex touch-none select-none transition-colors",t==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",t==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",s),...a,"data-oid":"jrn7g65",children:e.jsx(Oa,{className:"relative flex-1 rounded-full bg-border","data-oid":"margv-_"})}));_s.displayName=hs.displayName;const Jn=({compact:s=!1})=>{const{state:t,dispatch:a}=ee(),{canvasRef:n,currentPage:i,scale:r}=t,[l,o]=x.useState(!1),[d,m]=x.useState(0),[u,c]=x.useState(""),[h,v]=x.useState([]),[w,N]=x.useState("eng"),[E,p]=x.useState(null),[C,g]=x.useState(null),j=x.useCallback((y,D)=>{c(y),v(D),a({type:"SET_OCR_RESULTS",payload:{page:i,results:D}})},[a,i]),T=x.useCallback(async y=>{o(!0),m(0),p(null),g(null),c(""),v([]);try{if(y.type==="application/pdf"){const{ocrText:D,ocrResults:S,previewUrl:_}=await Ve.performPDFOCR(y,w,m);j(D,S),_&&g(_)}else if(y.type.startsWith("image/")){const D=URL.createObjectURL(y);g(D);const{ocrText:S,ocrResults:_}=await Ve.performOCR(y,w,1,1,m);j(S,_)}else throw new Error("Unsupported file type. Please upload an image or PDF.")}catch(D){p(D instanceof Error?D.message:"An unknown error occurred.")}finally{o(!1)}},[j,w]),f=y=>{var S;const D=(S=y.target.files)==null?void 0:S[0];D&&T(D)},b=y=>{if(y.preventDefault(),l)return;const D=y.dataTransfer.files[0];D&&T(D)},A=x.useCallback(async()=>{if(!(n!=null&&n.current))return;const D=n.current.toDataURL("image/png"),S=await(await fetch(D)).blob(),_=new File([S],"canvas.png",{type:"image/png"});await T(_)},[n,T]),F=y=>{const D=t.toolSettings.text,S={id:`text-${Date.now()}`,page:i,text:y.text,x:y.boundingBox.x0/r,y:y.boundingBox.y0/r,width:(y.boundingBox.x1-y.boundingBox.x0)/r,height:(y.boundingBox.y1-y.boundingBox.y0)/r,fontFamily:D.fontFamily||"Helvetica",fontSize:D.fontSize||12,color:D.color||"#000000",bold:D.bold||!1,italic:D.italic||!1,underline:D.underline||!1,textAlign:"left",lineHeight:1.2,rotation:0};a({type:"ADD_TEXT_ELEMENT",payload:{page:i,element:S}}),a({type:"SAVE_TO_HISTORY"})},k=y=>{n!=null&&n.current&&Ve.highlightTextOnCanvas(y,n)};return s?e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(K,{value:w,onValueChange:N,disabled:l,children:[e.jsx(Y,{className:"w-20",children:e.jsx(X,{})}),e.jsx(q,{children:Dt.map(y=>e.jsx(L,{value:y.code,children:y.name},y.code))})]}),e.jsxs(R,{onClick:A,disabled:l||!(n!=null&&n.current),size:"sm",variant:"outline",children:[e.jsx(he,{className:"h-3 w-3 mr-1"}),"Scan"]}),e.jsxs(R,{onClick:()=>{var y;return(y=document.getElementById("ocr-file-input"))==null?void 0:y.click()},disabled:l,size:"sm",variant:"outline",children:[e.jsx(be,{className:"h-3 w-3 mr-1"}),"Upload"]}),e.jsx("input",{id:"ocr-file-input",type:"file",className:"hidden",onChange:f,accept:"image/*,application/pdf"}),l&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ce,{value:d,className:"w-16 h-2"}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[Math.round(d),"%"]})]}),h.length>0&&e.jsxs("span",{className:"text-xs text-muted-foreground",children:[h.length," regions found"]})]}):e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsx(V,{children:e.jsx(G,{className:"pt-6",children:e.jsxs("div",{className:"border-2 border-dashed rounded-lg p-6 text-center cursor-pointer transition-colors hover:bg-gray-50 dark:hover:bg-black/20",onClick:()=>{var y;return(y=document.getElementById("ocr-file-input"))==null?void 0:y.click()},onDrop:b,onDragOver:y=>y.preventDefault(),children:[e.jsx(be,{className:"mx-auto h-8 w-8 text-gray-400"}),e.jsx("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-300",children:"Drag & drop or click to upload"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Image or PDF file"}),e.jsx("input",{id:"ocr-file-input",type:"file",className:"hidden",onChange:f,accept:"image/*,application/pdf"})]})})}),C&&e.jsx("img",{src:C,alt:"Preview",className:"max-h-40 mx-auto rounded border"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(R,{onClick:A,disabled:l||!(n!=null&&n.current),className:"flex-1",children:[e.jsx(he,{className:"h-4 w-4 mr-2"})," Scan Current View"]}),e.jsxs(K,{value:w,onValueChange:N,disabled:l,children:[e.jsx(Y,{className:"w-[120px]",children:e.jsx(X,{})}),e.jsx(q,{children:Dt.map(y=>e.jsx(L,{value:y.code,children:y.name},y.code))})]})]}),l&&e.jsx(Ce,{value:d,className:"w-full"}),E&&e.jsx("p",{className:"text-sm text-red-600",children:E}),u&&e.jsxs(V,{children:[e.jsx(ne,{children:e.jsxs(ie,{className:"text-base flex justify-between items-center",children:["Extracted Text",e.jsxs(R,{size:"sm",variant:"outline",onClick:()=>navigator.clipboard.writeText(u),children:[e.jsx(Xe,{className:"h-3 w-3 mr-2"}),"Copy"]})]})}),e.jsx(G,{children:e.jsx(ht,{value:u,readOnly:!0,className:"min-h-32 font-mono text-xs"})})]}),h.length>0&&e.jsxs(V,{children:[e.jsx(ne,{children:e.jsx(ie,{className:"text-base",children:"Detected Text Regions"})}),e.jsx(G,{children:e.jsx(Re,{className:"h-48",children:e.jsx("div",{className:"space-y-2",children:h.map(y=>e.jsxs("div",{className:"flex items-center justify-between p-2 border rounded hover:bg-muted/50",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium",children:y.text}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Confidence: ",Math.round(y.confidence),"%"]})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(R,{size:"icon",variant:"ghost",className:"h-7 w-7",onClick:()=>k(y),title:"Highlight on page",children:e.jsx(Ha,{className:"h-4 w-4"})}),e.jsx(R,{size:"icon",variant:"ghost",className:"h-7 w-7",onClick:()=>F(y),title:"Add as text box",children:e.jsx(Va,{className:"h-4 w-4"})})]})]},y.id))})})})]})]})},Z=x.forwardRef(({className:s,orientation:t="horizontal",decorative:a=!0,...n},i)=>e.jsx(us,{ref:i,decorative:a,orientation:t,className:O("shrink-0 bg-border",t==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",s),...n,"data-oid":"f7-g1x8"}));Z.displayName=us.displayName;const Zn=({settings:s,tool:t})=>{const a=t==="line",n={width:"100%",height:a?"2px":"50px",backgroundColor:s.fillColor==="transparent"?"#ffffff":s.fillColor,borderStyle:s.strokeStyle||"solid",borderWidth:`${s.strokeWidth||2}px`,borderColor:s.strokeColor||"#000000",borderRadius:t==="rectangle"?`${s.cornerRadius||0}px`:t==="circle"?"50%":"0",opacity:s.opacity};return a&&(n.backgroundColor=s.strokeColor||"#000000",n.border="none"),e.jsx("div",{className:"p-2 border rounded-md bg-white dark:bg-gray-800 flex items-center justify-center",children:e.jsx("div",{style:n})})},je=({settings:s,onSettingChange:t,compact:a=!1})=>{const{state:n}=ee(),{currentTool:i}=n,r=i==="line",l=i==="rectangle";return a?e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(z,{type:"color",value:s.strokeColor||"#000000",onChange:o=>t("strokeColor",o.target.value),className:"w-8 h-8 p-0 cursor-pointer",title:"Stroke Color"}),!r&&e.jsx(z,{type:"color",value:s.fillColor==="transparent"?"#ffffff":s.fillColor,onChange:o=>t("fillColor",o.target.value),className:"w-8 h-8 p-0 cursor-pointer",title:"Fill Color"}),e.jsx(z,{type:"number",value:s.strokeWidth||2,onChange:o=>t("strokeWidth",parseInt(o.target.value)||2),className:"w-16",min:1,max:50,title:"Stroke Width"}),e.jsxs(K,{value:s.strokeStyle||"solid",onValueChange:o=>t("strokeStyle",o),children:[e.jsx(Y,{className:"w-20",children:e.jsx(X,{})}),e.jsxs(q,{children:[e.jsx(L,{value:"solid",children:"Solid"}),e.jsx(L,{value:"dashed",children:"Dashed"}),e.jsx(L,{value:"dotted",children:"Dotted"})]})]}),l&&e.jsx(z,{type:"number",value:s.cornerRadius||0,onChange:o=>t("cornerRadius",parseInt(o.target.value)||0),className:"w-16",min:0,max:50,title:"Corner Radius"})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(M,{className:"text-xs",children:"Stroke Color"}),e.jsx(z,{type:"color",value:s.strokeColor||"#000000",onChange:o=>t("strokeColor",o.target.value),className:"w-full h-8 p-0 cursor-pointer"})]}),!r&&e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(M,{className:"text-xs",children:"Fill Color"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(z,{type:"color",value:s.fillColor==="transparent"?"#ffffff":s.fillColor,onChange:o=>t("fillColor",o.target.value),className:"w-full h-8 p-0 cursor-pointer"}),e.jsx(R,{variant:s.fillColor==="transparent"?"secondary":"ghost",className:"text-xs p-2 h-8",onClick:()=>t("fillColor","transparent"),children:"Transparent"})]})]}),!r&&e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs(M,{className:"text-xs",children:["Fill Opacity: ",Math.round((s.opacity??1)*100),"%"]}),e.jsx(re,{value:[(s.opacity??1)*100],onValueChange:([o])=>t("opacity",o/100),min:0,max:100,step:5})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs(M,{className:"text-xs",children:["Stroke Width: ",s.strokeWidth||2,"px"]}),e.jsx(re,{value:[s.strokeWidth||2],onValueChange:([o])=>t("strokeWidth",o),min:1,max:50,step:1})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(M,{className:"text-xs",children:"Stroke Style"}),e.jsxs(K,{value:s.strokeStyle||"solid",onValueChange:o=>t("strokeStyle",o),children:[e.jsx(Y,{children:e.jsx(X,{placeholder:"Select style"})}),e.jsxs(q,{children:[e.jsx(L,{value:"solid",children:"Solid"}),e.jsx(L,{value:"dashed",children:"Dashed"}),e.jsx(L,{value:"dotted",children:"Dotted"})]})]})]}),l&&e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs(M,{className:"text-xs",children:["Corner Radius: ",s.cornerRadius||0,"px"]}),e.jsx(re,{value:[s.cornerRadius||0],onValueChange:([o])=>t("cornerRadius",o),min:0,max:50,step:1})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(M,{className:"text-xs",children:"Preview"}),e.jsx(Zn,{settings:s,tool:i})]})]})},Ls={Arial:"/fonts/arial.ttf",Helvetica:"/fonts/helvetica.ttf","Times New Roman":"/fonts/times-new-roman.ttf","Courier New":"/fonts/courier-new.ttf",Verdana:"/fonts/verdana.ttf",Georgia:"/fonts/georgia.ttf","Trebuchet MS":"/fonts/trebuchet-ms.ttf",Tahoma:"/fonts/tahoma.ttf",Impact:"/fonts/impact.ttf","Comic Sans MS":"/fonts/comic-sans-ms.ttf",Roboto:"/fonts/roboto.ttf","Open Sans":"/fonts/open-sans.ttf",Lato:"/fonts/lato.ttf",Montserrat:"/fonts/montserrat.ttf",Oswald:"/fonts/oswald.ttf",Raleway:"/fonts/raleway.ttf","PT Sans":"/fonts/pt-sans.ttf","Source Sans Pro":"/fonts/source-sans-pro.ttf",Merriweather:"/fonts/merriweather.ttf","Noto Sans":"/fonts/noto-sans.ttf",Ubuntu:"/fonts/ubuntu.ttf",Nunito:"/fonts/nunito.ttf","Work Sans":"/fonts/work-sans.ttf",Rubik:"/fonts/rubik.ttf",Poppins:"/fonts/poppins.ttf",Inter:"/fonts/inter.ttf","Fira Sans":"/fonts/fira-sans.ttf",Cabin:"/fonts/cabin.ttf","Playfair Display":"/fonts/playfair-display.ttf","Titillium Web":"/fonts/titillium-web.ttf",Inconsolata:"/fonts/inconsolata.ttf","IBM Plex Sans":"/fonts/ibm-plex-sans.ttf",Quicksand:"/fonts/quicksand.ttf",Assistant:"/fonts/assistant.ttf",Mukta:"/fonts/mukta.ttf",Arimo:"/fonts/arimo.ttf",Karla:"/fonts/karla.ttf","Josefin Sans":"/fonts/josefin-sans.ttf",Manrope:"/fonts/manrope.ttf","Zilla Slab":"/fonts/zilla-slab.ttf","Space Grotesk":"/fonts/space-grotesk.ttf",Barlow:"/fonts/barlow.ttf",Cairo:"/fonts/cairo.ttf","DM Sans":"/fonts/dm-sans.ttf",Mulish:"/fonts/mulish.ttf",Heebo:"/fonts/heebo.ttf","Exo 2":"/fonts/exo-2.ttf","Be Vietnam Pro":"/fonts/be-vietnam-pro.ttf",Anton:"/fonts/anton.ttf"};function Qn(){return Object.keys(Ls)}async function Ms(s){const t={};for(const[a,n]of Object.entries(Ls))try{const i=await fetch(n);if(i.ok){const r=await i.arrayBuffer(),l=await s.embedFont(r);t[a]=l}else console.warn(`Font file not found and will not be available: ${a} at ${n}`)}catch(i){console.warn(`Failed to load font "${a}". It will not be available.`,i)}return t}const ei=Ms,zs=x.createContext(void 0);function ti({children:s}){const[t,a]=x.useState({}),[n,i]=x.useState(!0),[r,l]=x.useState(0),[o,d]=x.useState([]);x.useEffect(()=>{async function u(){i(!0);try{const c=await st.create(),h=Qn();d(h);const v=5,w=Object.entries(h),N=w.length,E={};for(let p=0;p<N;p+=v){const C=w.slice(p,p+v),g=await ei(c);Object.assign(E,g),l(Math.round((p+C.length)/N*100))}a(E)}catch(c){console.error("Failed to load fonts:",c)}finally{i(!1),l(100)}}u()},[]);const m=async(u,c)=>{try{const h=await st.create(),v=await fetch(c);if(v.ok){const w=await v.arrayBuffer(),N=await h.embedFont(w);return a(E=>({...E,[u]:N})),!0}return!1}catch(h){return console.error(`Failed to load custom font ${u}:`,h),!1}};return e.jsx(zs.Provider,{value:{loadedFonts:t,availableFonts:o,isLoading:n,loadProgress:r,loadCustomFont:m},"data-oid":"er3fl9i",children:s})}function si(){const s=x.useContext(zs);if(s===void 0)throw new Error("useFonts must be used within a FontProvider");return s}const ai=({selectedFont:s,onFontChange:t,fontSize:a,onFontSizeChange:n,onStyleChange:i,styles:r})=>{const{availableFonts:l,isLoading:o}=si(),d=()=>{i({...r,bold:!r.bold})},m=()=>{i({...r,italic:!r.italic})};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs(M,{className:"text-xs flex items-center gap-1.5",children:[e.jsx(rt,{size:12})," Font Family"]}),e.jsxs(K,{value:s,onValueChange:t,disabled:o,children:[e.jsx(Y,{children:e.jsx(X,{placeholder:o?"Loading fonts...":"Select font"})}),e.jsx(q,{children:e.jsx(Re,{className:"h-64",children:l.map(u=>e.jsx(L,{value:u,children:e.jsx("span",{style:{fontFamily:u},children:u})},u))})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(M,{className:"text-xs",children:"Font Size"}),e.jsx(z,{type:"number",value:a,onChange:u=>n(Number(u.target.value)),className:"w-full",min:6,max:288,placeholder:"Size"})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(M,{className:"text-xs",children:"Style"}),e.jsxs(We,{type:"multiple",value:Object.keys(r).filter(u=>r[u]),className:"w-full",children:[e.jsx(ke,{value:"bold","aria-label":"Toggle bold",onClick:d,className:"w-full",children:e.jsx(Je,{size:16})}),e.jsx(ke,{value:"italic","aria-label":"Toggle italic",onClick:m,className:"w-full",children:e.jsx(Ze,{size:16})})]})]})]})]})},ni=({settings:s})=>{const t={fontFamily:s.fontFamily||"Helvetica",fontSize:`${s.fontSize||16}px`,color:s.color||"#000000",fontWeight:s.bold?"bold":"normal",fontStyle:s.italic?"italic":"normal",textDecoration:s.underline?"underline":"none",textAlign:s.textAlign,lineHeight:s.lineHeight||1.2,padding:"8px",border:"1px solid hsl(var(--border))",borderRadius:"var(--radius)",backgroundColor:"hsl(var(--background))",whiteSpace:"nowrap",overflow:"hidden"};return e.jsx("div",{style:t,children:"The quick brown fox..."})},Us=({settings:s,onSettingChange:t,compact:a=!1})=>a?e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(K,{value:s.fontFamily||"Helvetica",onValueChange:n=>t("fontFamily",n),children:[e.jsx(Y,{className:"w-32",children:e.jsx(X,{placeholder:"Font"})}),e.jsxs(q,{children:[e.jsx(L,{value:"Helvetica",children:"Helvetica"}),e.jsx(L,{value:"Arial",children:"Arial"}),e.jsx(L,{value:"Times",children:"Times"}),e.jsx(L,{value:"Courier",children:"Courier"})]})]}),e.jsx(z,{type:"number",value:s.fontSize||16,onChange:n=>t("fontSize",parseInt(n.target.value)||16),className:"w-16",min:8,max:72}),e.jsx(z,{type:"color",value:s.color||"#000000",onChange:n=>t("color",n.target.value),className:"w-8 h-8 p-0 cursor-pointer"}),e.jsxs(K,{value:s.textAlign||"left",onValueChange:n=>t("textAlign",n),children:[e.jsx(Y,{className:"w-20",children:e.jsx(X,{})}),e.jsxs(q,{children:[e.jsx(L,{value:"left",children:"Left"}),e.jsx(L,{value:"center",children:"Center"}),e.jsx(L,{value:"right",children:"Right"}),e.jsx(L,{value:"justify",children:"Justify"})]})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsx(ai,{selectedFont:s.fontFamily||"Helvetica",onFontChange:n=>t("fontFamily",n),fontSize:s.fontSize||16,onFontSizeChange:n=>t("fontSize",n),styles:{bold:!!s.bold,italic:!!s.italic},onStyleChange:n=>{t("bold",n.bold),t("italic",n.italic)}}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(M,{className:"text-xs",children:"Text Color"}),e.jsx(z,{type:"color",value:s.color||"#000000",onChange:n=>t("color",n.target.value),className:"w-full h-8 p-0 cursor-pointer"})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(M,{className:"text-xs",children:"Alignment"}),e.jsxs(K,{value:s.textAlign||"left",onValueChange:n=>t("textAlign",n),children:[e.jsx(Y,{children:e.jsx(X,{placeholder:"Select alignment"})}),e.jsxs(q,{children:[e.jsx(L,{value:"left",children:"Left"}),e.jsx(L,{value:"center",children:"Center"}),e.jsx(L,{value:"right",children:"Right"}),e.jsx(L,{value:"justify",children:"Justify"})]})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs(M,{className:"text-xs",children:["Line Height: ",s.lineHeight||1.2]}),e.jsx(re,{value:[(s.lineHeight||1.2)*10],onValueChange:([n])=>t("lineHeight",n/10),min:8,max:30,step:1})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(M,{className:"text-xs",children:"Preview"}),e.jsx(ni,{settings:s})]})]}),Rt=[{name:"Black",hex:"#000000"},{name:"White",hex:"#FFFFFF"},{name:"Red",hex:"#FF0000"},{name:"Green",hex:"#008000"},{name:"Blue",hex:"#0000FF"},{name:"Yellow",hex:"#FFFF00"},{name:"Orange",hex:"#FFA500"},{name:"Purple",hex:"#800080"},{name:"Gray",hex:"#808080"},{name:"Dark Gray",hex:"#404040"},{name:"Light Gray",hex:"#C0C0C0"},{name:"Navy",hex:"#000080"}],Bs=({settings:s,onSettingChange:t,compact:a=!1})=>{const n=s.color||"#FFFFFF";return a?e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(z,{type:"color",value:n,onChange:i=>t("color",i.target.value),className:"w-8 h-8 p-0 cursor-pointer",title:"Cover-Up Color"}),Rt.slice(0,5).map(i=>e.jsx("button",{className:`w-6 h-6 rounded border-2 ${n.toUpperCase()===i.hex.toUpperCase()?"border-primary":"border-gray-300"}`,style:{backgroundColor:i.hex},onClick:()=>t("color",i.hex),title:i.name},i.name))]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(M,{className:"text-xs",children:"Cover-Up Color"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(z,{type:"color",value:n,onChange:i=>t("color",i.target.value),className:"w-10 h-10 p-0 cursor-pointer"}),e.jsx("p",{className:"text-sm font-mono text-muted-foreground bg-muted px-2 py-1 rounded-md",children:n.toUpperCase()})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(M,{className:"text-xs",children:"Common Colors"}),e.jsx(We,{type:"single",value:n.toUpperCase(),onValueChange:i=>{i&&t("color",i)},className:"grid grid-cols-5 gap-1 w-full",children:Rt.slice(0,10).map(i=>e.jsx(ke,{value:i.hex.toUpperCase(),"aria-label":i.name,className:O("w-full h-8 rounded-md border-2 border-transparent focus:z-10","data-[state=on]:border-primary"),style:{backgroundColor:i.hex}},i.name))})]}),e.jsx("p",{className:"text-[11px] text-muted-foreground pt-1",children:'The `"` Whiteout `"` tool covers content with a solid color. For irreversible, secure redaction, a dedicated redaction tool should be used.'})]})},ii={rectangle:je,circle:je,line:je,highlight:Is,text:Us,image:Os,whiteout:Bs},Ie=({settings:s,onSettingChange:t,compact:a=!1})=>{const{state:n,dispatch:i}=ee(),{selectedElementType:r,selectedElementId:l,selectedElementIds:o,annotations:d,textElements:m,imageElements:u,whiteoutBlocks:c,currentPage:h}=n,v=()=>{if(!l||!r)return;const g={annotation:()=>i({type:"DELETE_ANNOTATION",payload:{page:h,id:l}}),text:()=>i({type:"DELETE_TEXT_ELEMENT",payload:{page:h,id:l}}),image:()=>i({type:"DELETE_IMAGE_ELEMENT",payload:{page:h,id:l}}),whiteout:()=>i({type:"DELETE_WHITEOUT_BLOCK",payload:{page:h,id:l}})},j=r==="annotation"?"annotation":r;g[j]&&(g[j](),i({type:"SET_SELECTED_ELEMENT",payload:{id:null,type:null}}),i({type:"SAVE_TO_HISTORY"}))},w=()=>{if(!l||!r||!N)return;const g=20,j=`${r}-${Date.now()}`;if(r==="annotation"||["rectangle","circle","line","highlight"].includes(r)){const T={...N,id:j,x:N.x+g,y:N.y+g};i({type:"ADD_ANNOTATION",payload:{page:h,annotation:T}})}else if(r==="text"){const T={...N,id:j,x:N.x+g,y:N.y+g};i({type:"ADD_TEXT_ELEMENT",payload:{page:h,element:T}})}else if(r==="image"){const T={...N,id:j,x:N.x+g,y:N.y+g};i({type:"ADD_IMAGE_ELEMENT",payload:{page:h,element:T}})}else if(r==="whiteout"){const T={...N,id:j,x:N.x+g,y:N.y+g};i({type:"ADD_WHITEOUT_BLOCK",payload:{page:h,block:T}})}i({type:"SAVE_TO_HISTORY"})};if(a)return e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:o.length>1?`${o.length} elements selected`:l?`${r} selected`:"Click element to select"}),l&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(R,{size:"sm",variant:"outline",onClick:w,className:"h-6 px-2",children:e.jsx(Xe,{className:"h-3 w-3"})}),e.jsx(R,{size:"sm",variant:"outline",onClick:v,className:"h-6 px-2 text-red-600",children:e.jsx(Se,{className:"h-3 w-3"})})]})]});if(!l||!r)return e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"text-sm font-medium mb-3",children:"Selection Tool"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Click an element on the page to select it and view its properties."}),e.jsx(Z,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-xs font-medium",children:"Selection Options"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center space-x-2 text-xs",children:[e.jsx("input",{type:"checkbox",checked:s.showBounds||!1,onChange:g=>t("showBounds",g.target.checked),className:"rounded"}),e.jsx("span",{children:"Show element bounds"})]}),e.jsxs("label",{className:"flex items-center space-x-2 text-xs",children:[e.jsx("input",{type:"checkbox",checked:s.snapToGrid||!1,onChange:g=>t("snapToGrid",g.target.checked),className:"rounded"}),e.jsx("span",{children:"Snap to grid"})]})]})]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[e.jsx("p",{className:"font-medium mb-1",children:"Keyboard Shortcuts:"}),e.jsxs("ul",{className:"space-y-1 text-xs",children:[e.jsxs("li",{children:["• ",e.jsx("kbd",{className:"px-1 py-0.5 bg-gray-100 rounded text-xs",children:"Delete"})," - Remove selected element(s)"]}),e.jsxs("li",{children:["• ",e.jsx("kbd",{className:"px-1 py-0.5 bg-gray-100 rounded text-xs",children:"Ctrl+A"})," - Select all elements"]}),e.jsxs("li",{children:["• ",e.jsx("kbd",{className:"px-1 py-0.5 bg-gray-100 rounded text-xs",children:"Ctrl+C"})," - Copy element(s)"]}),e.jsxs("li",{children:["• ",e.jsx("kbd",{className:"px-1 py-0.5 bg-gray-100 rounded text-xs",children:"Ctrl+V"})," - Paste element(s)"]}),e.jsxs("li",{children:["• ",e.jsx("kbd",{className:"px-1 py-0.5 bg-gray-100 rounded text-xs",children:"Ctrl+D"})," - Duplicate element(s)"]}),e.jsxs("li",{children:["• ",e.jsx("kbd",{className:"px-1 py-0.5 bg-gray-100 rounded text-xs",children:"Ctrl+Click"})," - Multi-select"]})]})]})]})]});let N;if(["annotation","rectangle","circle","line","highlight"].includes(r)?N=Object.values(d).flat().find(g=>g.id===l):r==="text"?N=Object.values(m).flat().find(g=>g.id===l):r==="image"?N=Object.values(u).flat().find(g=>g.id===l):r==="whiteout"&&(N=Object.values(c).flat().find(g=>g.id===l)),!N)return e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"text-sm font-medium mb-2",children:"Element Not Found"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"The selected element could not be found. It may have been deleted or moved to another page."}),e.jsx(R,{size:"sm",variant:"outline",className:"mt-2",onClick:()=>i({type:"SET_SELECTED_ELEMENT",payload:{id:null,type:null}}),children:"Clear Selection"})]});const E="type"in N?N.type:r,p=ii[E];if(!p)return e.jsxs("div",{className:"p-4",children:[e.jsxs("h3",{className:"text-sm font-medium capitalize",children:[r," Selected"]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"This element has no configurable properties."})]});const C=(g,j)=>{if(!N)return;const{id:T,page:f}=N;["rectangle","circle","line","highlight"].includes(E)?i({type:"UPDATE_ANNOTATION",payload:{page:f,id:T,updates:{[g]:j}}}):E==="text"?i({type:"UPDATE_TEXT_ELEMENT",payload:{page:f,id:T,updates:{[g]:j}}}):E==="image"?i({type:"UPDATE_IMAGE_ELEMENT",payload:{page:f,id:T,updates:{[g]:j}}}):E==="whiteout"&&i({type:"UPDATE_WHITEOUT_BLOCK",payload:{page:f,id:T,updates:{[g]:j}}})};return e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"text-sm font-medium capitalize mb-2",children:o.length>1?`${o.length} Elements Selected`:`${E} Selected`}),e.jsxs("div",{className:"flex gap-1 mb-3",children:[e.jsx(R,{size:"sm",variant:"outline",onClick:w,className:"h-8 px-2",title:"Duplicate element",children:e.jsx(Xe,{className:"h-3 w-3"})}),e.jsx(R,{size:"sm",variant:"outline",onClick:v,className:"h-8 px-2 text-red-600 hover:text-red-700",title:"Delete element",children:e.jsx(Se,{className:"h-3 w-3"})})]}),e.jsx("div",{className:"text-xs text-muted-foreground mb-3 space-y-1",children:o.length===1?e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:["Position: ",Math.round(N.x),", ",Math.round(N.y)]}),e.jsxs("div",{children:["Size: ",Math.round(N.width||0)," × ",Math.round(N.height||0)]}),"rotation"in N&&N.rotation&&e.jsxs("div",{children:["Rotation: ",N.rotation,"°"]})]}):e.jsx("div",{children:"Multiple elements selected - use toolbar actions to manipulate all at once"})}),e.jsx(Z,{className:"mb-4"})]}),p&&o.length===1&&e.jsx(p,{settings:N,onSettingChange:C,editorState:n}),o.length>1&&e.jsxs("div",{className:"text-xs text-muted-foreground p-3 bg-blue-50 rounded border",children:[e.jsx("p",{className:"font-medium mb-1",children:"Multi-Selection Active"}),e.jsx("p",{children:"Use the action buttons above to delete or duplicate all selected elements. Individual properties are not available for multi-selection."})]})]})},Oe=x.forwardRef(({className:s,...t},a)=>e.jsx(ms,{ref:a,className:O("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",s),...t,"data-oid":"evt02my",children:e.jsx(_a,{className:O("flex items-center justify-center text-current"),"data-oid":"8wpa5ts",children:e.jsx(De,{className:"h-4 w-4","data-oid":"86ksnwq"})})}));Oe.displayName=ms.displayName;const Pt=[{value:"text",label:"Text Field",icon:"📝"},{value:"textarea",label:"Text Area",icon:"📄"},{value:"checkbox",label:"Checkbox",icon:"☑️"},{value:"radio",label:"Radio Button",icon:"🔘"},{value:"dropdown",label:"Dropdown",icon:"📋"},{value:"date",label:"Date Field",icon:"📅"},{value:"signature",label:"Signature",icon:"✍️"}],ri=({settings:s,onSettingChange:t,editorState:a,compact:n=!1})=>{var o,d;const i=s.fieldType||"text",r=((o=a==null?void 0:a.formFields)==null?void 0:o[a==null?void 0:a.currentPage])||[],l=m=>{t("fieldType",m);const u={text:{width:150,height:30,placeholder:"Enter text"},textarea:{width:200,height:80,placeholder:"Enter text"},checkbox:{width:20,height:20},radio:{width:20,height:20},dropdown:{width:150,height:30,options:["Option 1","Option 2","Option 3"]},date:{width:120,height:30},signature:{width:200,height:60}},c=u[m]||u.text;Object.entries(c).forEach(([h,v])=>{t(h,v)})};return n?e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(K,{value:i,onValueChange:l,children:[e.jsx(Y,{className:"w-32",children:e.jsx(X,{placeholder:"Field type"})}),e.jsx(q,{children:Pt.map(m=>e.jsx(L,{value:m.value,children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"text-xs",children:m.icon}),e.jsx("span",{className:"text-xs",children:m.label})]})},m.value))})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(z,{type:"number",value:s.width||150,onChange:m=>t("width",parseInt(m.target.value)),className:"w-16 h-8",placeholder:"W"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"×"}),e.jsx(z,{type:"number",value:s.height||30,onChange:m=>t("height",parseInt(m.target.value)),className:"w-16 h-8",placeholder:"H"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Oe,{checked:s.required||!1,onCheckedChange:m=>t("required",m)}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"Required"})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(M,{className:"text-xs",children:"Field Type"}),e.jsxs(K,{value:i,onValueChange:l,children:[e.jsx(Y,{children:e.jsx(X,{placeholder:"Select field type"})}),e.jsx(q,{children:Pt.map(m=>e.jsx(L,{value:m.value,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:m.icon}),e.jsx("span",{children:m.label})]})},m.value))})]})]}),e.jsx(Z,{}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"text-xs font-medium text-muted-foreground",children:"Field Properties"}),["text","textarea","date"].includes(i)&&e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(M,{className:"text-xs",children:"Placeholder Text"}),e.jsx(z,{value:s.placeholder||"",onChange:m=>t("placeholder",m.target.value),placeholder:"Enter placeholder text",className:"text-xs"})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(M,{className:"text-xs",children:"Field Label"}),e.jsx(z,{value:s.label||"",onChange:m=>t("label",m.target.value),placeholder:"Enter field label",className:"text-xs"})]}),["text","textarea"].includes(i)&&e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(M,{className:"text-xs",children:"Default Value"}),e.jsx(z,{value:s.defaultValue||"",onChange:m=>t("defaultValue",m.target.value),placeholder:"Enter default value",className:"text-xs"})]}),i==="dropdown"&&e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(M,{className:"text-xs",children:"Options (one per line)"}),e.jsx(ht,{value:((d=s.options)==null?void 0:d.join(`
`))||"",onChange:m=>t("options",m.target.value.split(`
`).filter(Boolean)),placeholder:`Option 1
Option 2
Option 3`,className:"text-xs h-20"})]}),i==="radio"&&e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(M,{className:"text-xs",children:"Group Name"}),e.jsx(z,{value:s.groupName||"",onChange:m=>t("groupName",m.target.value),placeholder:"radio-group-1",className:"text-xs"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(M,{className:"text-xs",children:"Width"}),e.jsx(z,{type:"number",value:s.width||150,onChange:m=>t("width",parseInt(m.target.value)),className:"text-xs"})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(M,{className:"text-xs",children:"Height"}),e.jsx(z,{type:"number",value:s.height||30,onChange:m=>t("height",parseInt(m.target.value)),className:"text-xs"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Oe,{id:"required",checked:s.required||!1,onCheckedChange:m=>t("required",m)}),e.jsx(M,{htmlFor:"required",className:"text-xs",children:"Required field"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Oe,{id:"readonly",checked:s.readonly||!1,onCheckedChange:m=>t("readonly",m)}),e.jsx(M,{htmlFor:"readonly",className:"text-xs",children:"Read-only"})]})]})]}),e.jsx(Z,{}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(M,{className:"text-xs",children:"Current Page Fields"}),e.jsx("div",{className:"text-xs text-muted-foreground bg-muted p-2 rounded",children:r.length===0?"No form fields on this page":`${r.length} field(s) on page ${a.currentPage}`})]}),e.jsxs("div",{className:"text-[11px] text-muted-foreground p-2 bg-blue-50 dark:bg-blue-950 rounded",children:[e.jsx("p",{className:"font-medium mb-1",children:"How to use:"}),e.jsxs("ol",{className:"space-y-1 list-decimal list-inside",children:[e.jsx("li",{children:"Select field type and configure properties"}),e.jsx("li",{children:"Click on the PDF to place the field"}),e.jsx("li",{children:"Use Select tool to move and resize fields"})]})]})]})};var Ws={exports:{}};const li={},oi=Object.freeze(Object.defineProperty({__proto__:null,default:li},Symbol.toStringTag,{value:"Module"})),At=rn(oi);/**
 * [js-sha256]{@link https://github.com/emn178/js-sha256}
 *
 * @version 0.11.1
 * @author Chen, Yi-Cyuan [emn178@gmail.com]
 * @copyright Chen, Yi-Cyuan 2014-2025
 * @license MIT
 */(function(s){(function(){var t="input is invalid type",a=typeof window=="object",n=a?window:{};n.JS_SHA256_NO_WINDOW&&(a=!1);var i=!a&&typeof self=="object",r=!n.JS_SHA256_NO_NODE_JS&&typeof process=="object"&&process.versions&&process.versions.node&&process.type!="renderer";r?n=ln:i&&(n=self);var l=!n.JS_SHA256_NO_COMMON_JS&&!0&&s.exports,o=!n.JS_SHA256_NO_ARRAY_BUFFER&&typeof ArrayBuffer<"u",d="0123456789abcdef".split(""),m=[-2147483648,8388608,32768,128],u=[24,16,8,0],c=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],h=["hex","array","digest","arrayBuffer"],v=[];(n.JS_SHA256_NO_NODE_JS||!Array.isArray)&&(Array.isArray=function(f){return Object.prototype.toString.call(f)==="[object Array]"}),o&&(n.JS_SHA256_NO_ARRAY_BUFFER_IS_VIEW||!ArrayBuffer.isView)&&(ArrayBuffer.isView=function(f){return typeof f=="object"&&f.buffer&&f.buffer.constructor===ArrayBuffer});var w=function(f,b){return function(A){return new g(b,!0).update(A)[f]()}},N=function(f){var b=w("hex",f);r&&(b=E(b,f)),b.create=function(){return new g(f)},b.update=function(k){return b.create().update(k)};for(var A=0;A<h.length;++A){var F=h[A];b[F]=w(F,f)}return b},E=function(f,b){var A=At,F=At.Buffer,k=b?"sha224":"sha256",y;F.from&&!n.JS_SHA256_NO_BUFFER_FROM?y=F.from:y=function(S){return new F(S)};var D=function(S){if(typeof S=="string")return A.createHash(k).update(S,"utf8").digest("hex");if(S==null)throw new Error(t);return S.constructor===ArrayBuffer&&(S=new Uint8Array(S)),Array.isArray(S)||ArrayBuffer.isView(S)||S.constructor===F?A.createHash(k).update(y(S)).digest("hex"):f(S)};return D},p=function(f,b){return function(A,F){return new j(A,b,!0).update(F)[f]()}},C=function(f){var b=p("hex",f);b.create=function(k){return new j(k,f)},b.update=function(k,y){return b.create(k).update(y)};for(var A=0;A<h.length;++A){var F=h[A];b[F]=p(F,f)}return b};function g(f,b){b?(v[0]=v[16]=v[1]=v[2]=v[3]=v[4]=v[5]=v[6]=v[7]=v[8]=v[9]=v[10]=v[11]=v[12]=v[13]=v[14]=v[15]=0,this.blocks=v):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],f?(this.h0=3238371032,this.h1=914150663,this.h2=812702999,this.h3=4144912697,this.h4=4290775857,this.h5=1750603025,this.h6=1694076839,this.h7=3204075428):(this.h0=1779033703,this.h1=3144134277,this.h2=1013904242,this.h3=2773480762,this.h4=1359893119,this.h5=2600822924,this.h6=528734635,this.h7=1541459225),this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0,this.is224=f}g.prototype.update=function(f){if(!this.finalized){var b,A=typeof f;if(A!=="string"){if(A==="object"){if(f===null)throw new Error(t);if(o&&f.constructor===ArrayBuffer)f=new Uint8Array(f);else if(!Array.isArray(f)&&(!o||!ArrayBuffer.isView(f)))throw new Error(t)}else throw new Error(t);b=!0}for(var F,k=0,y,D=f.length,S=this.blocks;k<D;){if(this.hashed&&(this.hashed=!1,S[0]=this.block,this.block=S[16]=S[1]=S[2]=S[3]=S[4]=S[5]=S[6]=S[7]=S[8]=S[9]=S[10]=S[11]=S[12]=S[13]=S[14]=S[15]=0),b)for(y=this.start;k<D&&y<64;++k)S[y>>>2]|=f[k]<<u[y++&3];else for(y=this.start;k<D&&y<64;++k)F=f.charCodeAt(k),F<128?S[y>>>2]|=F<<u[y++&3]:F<2048?(S[y>>>2]|=(192|F>>>6)<<u[y++&3],S[y>>>2]|=(128|F&63)<<u[y++&3]):F<55296||F>=57344?(S[y>>>2]|=(224|F>>>12)<<u[y++&3],S[y>>>2]|=(128|F>>>6&63)<<u[y++&3],S[y>>>2]|=(128|F&63)<<u[y++&3]):(F=65536+((F&1023)<<10|f.charCodeAt(++k)&1023),S[y>>>2]|=(240|F>>>18)<<u[y++&3],S[y>>>2]|=(128|F>>>12&63)<<u[y++&3],S[y>>>2]|=(128|F>>>6&63)<<u[y++&3],S[y>>>2]|=(128|F&63)<<u[y++&3]);this.lastByteIndex=y,this.bytes+=y-this.start,y>=64?(this.block=S[16],this.start=y-64,this.hash(),this.hashed=!0):this.start=y}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}},g.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var f=this.blocks,b=this.lastByteIndex;f[16]=this.block,f[b>>>2]|=m[b&3],this.block=f[16],b>=56&&(this.hashed||this.hash(),f[0]=this.block,f[16]=f[1]=f[2]=f[3]=f[4]=f[5]=f[6]=f[7]=f[8]=f[9]=f[10]=f[11]=f[12]=f[13]=f[14]=f[15]=0),f[14]=this.hBytes<<3|this.bytes>>>29,f[15]=this.bytes<<3,this.hash()}},g.prototype.hash=function(){var f=this.h0,b=this.h1,A=this.h2,F=this.h3,k=this.h4,y=this.h5,D=this.h6,S=this.h7,_=this.blocks,$,B,J,te,U,se,ae,oe,ue,me,le;for($=16;$<64;++$)U=_[$-15],B=(U>>>7|U<<25)^(U>>>18|U<<14)^U>>>3,U=_[$-2],J=(U>>>17|U<<15)^(U>>>19|U<<13)^U>>>10,_[$]=_[$-16]+B+_[$-7]+J<<0;for(le=b&A,$=0;$<64;$+=4)this.first?(this.is224?(oe=300032,U=_[0]-1413257819,S=U-150054599<<0,F=U+24177077<<0):(oe=704751109,U=_[0]-210244248,S=U-1521486534<<0,F=U+143694565<<0),this.first=!1):(B=(f>>>2|f<<30)^(f>>>13|f<<19)^(f>>>22|f<<10),J=(k>>>6|k<<26)^(k>>>11|k<<21)^(k>>>25|k<<7),oe=f&b,te=oe^f&A^le,ae=k&y^~k&D,U=S+J+ae+c[$]+_[$],se=B+te,S=F+U<<0,F=U+se<<0),B=(F>>>2|F<<30)^(F>>>13|F<<19)^(F>>>22|F<<10),J=(S>>>6|S<<26)^(S>>>11|S<<21)^(S>>>25|S<<7),ue=F&f,te=ue^F&b^oe,ae=S&k^~S&y,U=D+J+ae+c[$+1]+_[$+1],se=B+te,D=A+U<<0,A=U+se<<0,B=(A>>>2|A<<30)^(A>>>13|A<<19)^(A>>>22|A<<10),J=(D>>>6|D<<26)^(D>>>11|D<<21)^(D>>>25|D<<7),me=A&F,te=me^A&f^ue,ae=D&S^~D&k,U=y+J+ae+c[$+2]+_[$+2],se=B+te,y=b+U<<0,b=U+se<<0,B=(b>>>2|b<<30)^(b>>>13|b<<19)^(b>>>22|b<<10),J=(y>>>6|y<<26)^(y>>>11|y<<21)^(y>>>25|y<<7),le=b&A,te=le^b&F^me,ae=y&D^~y&S,U=k+J+ae+c[$+3]+_[$+3],se=B+te,k=f+U<<0,f=U+se<<0,this.chromeBugWorkAround=!0;this.h0=this.h0+f<<0,this.h1=this.h1+b<<0,this.h2=this.h2+A<<0,this.h3=this.h3+F<<0,this.h4=this.h4+k<<0,this.h5=this.h5+y<<0,this.h6=this.h6+D<<0,this.h7=this.h7+S<<0},g.prototype.hex=function(){this.finalize();var f=this.h0,b=this.h1,A=this.h2,F=this.h3,k=this.h4,y=this.h5,D=this.h6,S=this.h7,_=d[f>>>28&15]+d[f>>>24&15]+d[f>>>20&15]+d[f>>>16&15]+d[f>>>12&15]+d[f>>>8&15]+d[f>>>4&15]+d[f&15]+d[b>>>28&15]+d[b>>>24&15]+d[b>>>20&15]+d[b>>>16&15]+d[b>>>12&15]+d[b>>>8&15]+d[b>>>4&15]+d[b&15]+d[A>>>28&15]+d[A>>>24&15]+d[A>>>20&15]+d[A>>>16&15]+d[A>>>12&15]+d[A>>>8&15]+d[A>>>4&15]+d[A&15]+d[F>>>28&15]+d[F>>>24&15]+d[F>>>20&15]+d[F>>>16&15]+d[F>>>12&15]+d[F>>>8&15]+d[F>>>4&15]+d[F&15]+d[k>>>28&15]+d[k>>>24&15]+d[k>>>20&15]+d[k>>>16&15]+d[k>>>12&15]+d[k>>>8&15]+d[k>>>4&15]+d[k&15]+d[y>>>28&15]+d[y>>>24&15]+d[y>>>20&15]+d[y>>>16&15]+d[y>>>12&15]+d[y>>>8&15]+d[y>>>4&15]+d[y&15]+d[D>>>28&15]+d[D>>>24&15]+d[D>>>20&15]+d[D>>>16&15]+d[D>>>12&15]+d[D>>>8&15]+d[D>>>4&15]+d[D&15];return this.is224||(_+=d[S>>>28&15]+d[S>>>24&15]+d[S>>>20&15]+d[S>>>16&15]+d[S>>>12&15]+d[S>>>8&15]+d[S>>>4&15]+d[S&15]),_},g.prototype.toString=g.prototype.hex,g.prototype.digest=function(){this.finalize();var f=this.h0,b=this.h1,A=this.h2,F=this.h3,k=this.h4,y=this.h5,D=this.h6,S=this.h7,_=[f>>>24&255,f>>>16&255,f>>>8&255,f&255,b>>>24&255,b>>>16&255,b>>>8&255,b&255,A>>>24&255,A>>>16&255,A>>>8&255,A&255,F>>>24&255,F>>>16&255,F>>>8&255,F&255,k>>>24&255,k>>>16&255,k>>>8&255,k&255,y>>>24&255,y>>>16&255,y>>>8&255,y&255,D>>>24&255,D>>>16&255,D>>>8&255,D&255];return this.is224||_.push(S>>>24&255,S>>>16&255,S>>>8&255,S&255),_},g.prototype.array=g.prototype.digest,g.prototype.arrayBuffer=function(){this.finalize();var f=new ArrayBuffer(this.is224?28:32),b=new DataView(f);return b.setUint32(0,this.h0),b.setUint32(4,this.h1),b.setUint32(8,this.h2),b.setUint32(12,this.h3),b.setUint32(16,this.h4),b.setUint32(20,this.h5),b.setUint32(24,this.h6),this.is224||b.setUint32(28,this.h7),f};function j(f,b,A){var F,k=typeof f;if(k==="string"){var y=[],D=f.length,S=0,_;for(F=0;F<D;++F)_=f.charCodeAt(F),_<128?y[S++]=_:_<2048?(y[S++]=192|_>>>6,y[S++]=128|_&63):_<55296||_>=57344?(y[S++]=224|_>>>12,y[S++]=128|_>>>6&63,y[S++]=128|_&63):(_=65536+((_&1023)<<10|f.charCodeAt(++F)&1023),y[S++]=240|_>>>18,y[S++]=128|_>>>12&63,y[S++]=128|_>>>6&63,y[S++]=128|_&63);f=y}else if(k==="object"){if(f===null)throw new Error(t);if(o&&f.constructor===ArrayBuffer)f=new Uint8Array(f);else if(!Array.isArray(f)&&(!o||!ArrayBuffer.isView(f)))throw new Error(t)}else throw new Error(t);f.length>64&&(f=new g(b,!0).update(f).array());var $=[],B=[];for(F=0;F<64;++F){var J=f[F]||0;$[F]=92^J,B[F]=54^J}g.call(this,b,A),this.update(B),this.oKeyPad=$,this.inner=!0,this.sharedMemory=A}j.prototype=new g,j.prototype.finalize=function(){if(g.prototype.finalize.call(this),this.inner){this.inner=!1;var f=this.array();g.call(this,this.is224,this.sharedMemory),this.update(this.oKeyPad),this.update(f),g.prototype.finalize.call(this)}};var T=N();T.sha256=T,T.sha224=N(!0),T.sha256.hmac=C(),T.sha224.hmac=C(!0),l?s.exports=T:(n.sha256=T.sha256,n.sha224=T.sha224)})()})(Ws);var ci=Ws.exports;class pe{constructor(){this.savedSignatures=[]}static getInstance(){return pe.instance||(pe.instance=new pe),pe.instance}generateSignatureHash(t){return ci.sha256(t)}createSignatureData(t){return{dataUrl:t,hash:this.generateSignatureHash(t),timestamp:new Date().toISOString(),verified:!0}}validateSignature(t){return!t.dataUrl||!t.hash?!1:this.generateSignatureHash(t.dataUrl)===t.hash}createSignaturePlacement(t,a,n,i=150,r=75,l=1){return{x:t,y:a,width:i,height:r,src:n,page:l}}resizeSignature(t,a,n){const i=document.createElement("canvas"),r=i.getContext("2d");if(!r)throw new Error("Could not get canvas context");return i.width=a,i.height=n,r.drawImage(t,0,0,a,n),i.toDataURL("image/png")}trimSignatureCanvas(t){const a=t.getContext("2d");if(!a)throw new Error("Could not get canvas context");const i=a.getImageData(0,0,t.width,t.height).data;let r=t.width,l=0,o=t.height,d=0;for(let v=0;v<t.height;v++)for(let w=0;w<t.width;w++)i[(v*t.width+w)*4+3]>0&&(r=Math.min(r,w),l=Math.max(l,w),o=Math.min(o,v),d=Math.max(d,v));const m=document.createElement("canvas"),u=m.getContext("2d");if(!u)throw new Error("Could not get trimmed canvas context");const c=l-r+1,h=d-o+1;return m.width=c,m.height=h,u.drawImage(t,r,o,c,h,0,0,c,h),m.toDataURL("image/png")}saveSignature(t){this.savedSignatures.push(t)}getSavedSignatures(){return[...this.savedSignatures]}deleteSignature(t){const a=this.savedSignatures.findIndex(n=>n.hash===t);return a!==-1?(this.savedSignatures.splice(a,1),!0):!1}}const Q=pe.getInstance(),di=({onSave:s,onComplete:t,onSigned:a,onClose:n,showCancel:i=!1,width:r=400,height:l=200})=>{const o=x.useRef(null),d=x.useCallback(()=>{var u;(u=o.current)==null||u.clear()},[]),m=x.useCallback(()=>{if(!o.current||o.current.isEmpty())return;const u=o.current.getTrimmedCanvas().toDataURL("image/png"),c=Q.createSignatureData(u);s==null||s(u),t==null||t(u),a==null||a(c),d()},[s,t,a,d]);return e.jsxs("div",{className:"border-2 border-dashed border-gray-400 rounded-lg p-4 bg-white max-w-full mx-auto","data-oid":"ox05nz9",children:[e.jsx(ma,{ref:o,penColor:"black",backgroundColor:"#f8f9fa",canvasProps:{width:r,height:l,className:"border rounded bg-gray-100"},"data-oid":"45hr3m3"}),e.jsxs("div",{className:"mt-4 flex justify-center gap-4 flex-wrap","data-oid":"pb:pit-",children:[e.jsx("button",{onClick:d,className:"px-4 py-2 font-bold border-none rounded bg-indigo-600 text-white hover:bg-indigo-700 cursor-pointer","data-oid":"tu_emb8",children:"Clear"}),e.jsx("button",{onClick:m,className:"px-4 py-2 font-bold border-none rounded bg-indigo-600 text-white hover:bg-indigo-700 cursor-pointer","data-oid":"al09pns",children:"Save"}),i&&e.jsx("button",{onClick:n,className:"px-4 py-2 font-bold border-none rounded bg-gray-600 text-white hover:bg-gray-700 cursor-pointer","data-oid":"lag2utn",children:"Cancel"})]})]})},hi=({signatureDataUrl:s,onPlace:t,currentPage:a=1})=>{const[n,i]=x.useState([]),r=x.useCallback(l=>{if(!s)return;const o=l.currentTarget.getBoundingClientRect(),d=l.clientX-o.left,m=l.clientY-o.top,u=Q.createSignaturePlacement(d,m,s,150,75,a);i(c=>[...c,u]),t==null||t(u)},[s,t,a]);return e.jsx("div",{className:"relative w-full h-full border-2 border-dashed border-gray-400 bg-gray-50 min-h-48 cursor-crosshair",onClick:r,"data-oid":"rq1_7id",children:n.map((l,o)=>e.jsx("img",{src:l.src,alt:"Signature",className:"absolute pointer-events-none",style:{left:l.x,top:l.y,width:l.width,height:l.height},"data-oid":"6wf46ta"},o))})},ui=()=>{const{state:s,dispatch:t}=ee(),[a,n]=x.useState(!1),[i,r]=x.useState([]),[l,o]=x.useState(void 0),[d,m]=x.useState(!1);W.useEffect(()=>{r(Q.getSavedSignatures())},[]);const u=x.useCallback(()=>{n(!0)},[]),c=x.useCallback(()=>{n(!1),r(Q.getSavedSignatures())},[]),h=x.useCallback(p=>{Q.deleteSignature(p),r(Q.getSavedSignatures())},[]),v=x.useCallback(p=>Q.validateSignature(p),[]),w=x.useCallback(p=>{o(p);const C=Q.createSignatureData(p);Q.saveSignature(C),r(Q.getSavedSignatures()),m(!0)},[]),N=x.useCallback(p=>{t({type:"ADD_IMAGE_ELEMENT",payload:{page:s.currentPage,element:{id:`signature-${Date.now()}`,x:p.x,y:p.y,width:p.width,height:p.height,src:p.src,rotation:0,page:p.page}}})},[t,s.currentPage]),E=x.useCallback(()=>{o(void 0),m(!1)},[]);return e.jsxs(V,{className:"w-full",children:[e.jsx(ne,{className:"pb-3",children:e.jsxs(ie,{className:"text-sm flex items-center gap-2",children:[e.jsx(Qe,{className:"h-4 w-4"}),"Digital Signature"]})}),e.jsxs(G,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(R,{onClick:u,className:"w-full",variant:a?"secondary":"default",children:[e.jsx(et,{className:"h-4 w-4 mr-2"}),a?"Hide Signature Pad":"Create New Signature"]}),a&&e.jsxs("div",{className:"border rounded-lg p-4 bg-gray-50",children:[!d&&e.jsx(di,{onSave:w,onClose:E,showCancel:!0,width:400,height:150}),d&&l&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"font-semibold text-gray-700",children:"Click anywhere on the document below to place your signature:"}),e.jsx(hi,{signatureDataUrl:l,onPlace:N}),e.jsx("div",{className:"flex justify-center",children:e.jsx(R,{onClick:E,children:"Done"})})]}),e.jsx("div",{className:"mt-3 flex justify-end",children:e.jsx(R,{variant:"outline",size:"sm",onClick:c,children:"Done"})})]})]}),e.jsx(Z,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"text-sm font-medium",children:"Saved Signatures"}),e.jsx(Fe,{variant:"secondary",className:"text-xs",children:i.length})]}),e.jsx(Re,{className:"h-48 w-full border rounded-md",children:e.jsx("div",{className:"p-2 space-y-2",children:i.length===0?e.jsx("div",{className:"text-center py-8 text-sm text-gray-500",children:"No saved signatures"}):i.map((p,C)=>e.jsx("div",{className:"border rounded-lg p-3 bg-white hover:bg-gray-50 transition-colors",children:e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"mb-2",children:e.jsx("img",{src:p.dataUrl,alt:`Signature ${C+1}`,className:"h-12 max-w-full object-contain border rounded bg-white"})}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[v(p)?e.jsx(lt,{className:"h-3 w-3 text-green-600"}):e.jsx(ct,{className:"h-3 w-3 text-red-600"}),e.jsx("span",{className:"text-xs font-medium",children:v(p)?"Verified":"Invalid"})]}),p.timestamp&&e.jsxs("div",{className:"text-xs text-gray-500",children:["Created: ",new Date(p.timestamp).toLocaleDateString()]}),e.jsxs("div",{className:"text-xs text-gray-400 font-mono",children:["Hash: ",p.hash.substring(0,12),"..."]})]})]}),e.jsx("div",{className:"flex flex-col gap-1",children:e.jsx(R,{variant:"outline",size:"sm",onClick:()=>h(p.hash),className:"h-6 w-6 p-0",children:e.jsx(Se,{className:"h-3 w-3"})})})]})},p.hash))})})]}),e.jsx(Z,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Me,{className:"h-4 w-4 text-blue-600"}),e.jsx("h4",{className:"text-sm font-medium",children:"Security Features"})]}),e.jsxs("div",{className:"text-xs text-gray-600 space-y-1",children:[e.jsx("div",{children:"• Signatures are cryptographically hashed"}),e.jsx("div",{children:"• Tampering detection with SHA-256"}),e.jsx("div",{children:"• Timestamp verification included"}),e.jsx("div",{children:"• Local storage for privacy"})]})]}),e.jsxs("div",{className:"text-xs text-gray-500 bg-blue-50 p-2 rounded",children:[e.jsx("strong",{children:"How to use:"}),e.jsxs("ol",{className:"mt-1 space-y-1 ml-3 list-decimal",children:[e.jsx("li",{children:"Create a new signature using the signature pad"}),e.jsx("li",{children:'Click "Save" to store your signature'}),e.jsx("li",{children:"Click anywhere on the PDF to place your signature"}),e.jsx("li",{children:"Signatures are embedded as images in the PDF"})]})]})]})]})},mi=({compact:s=!1})=>{const{state:t}=ee(),[a,n]=x.useState(!1),[i,r]=x.useState([]);W.useEffect(()=>{r(Q.getSavedSignatures())},[]);const l=x.useCallback(()=>{n(!0)},[]),o=x.useCallback(()=>{n(!1),r(Q.getSavedSignatures())},[]),d=x.useCallback(u=>{Q.deleteSignature(u),r(Q.getSavedSignatures())},[]),m=x.useCallback(u=>Q.validateSignature(u),[]);return s?e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(R,{onClick:l,size:"sm",variant:a?"secondary":"outline",children:[e.jsx(et,{className:"h-3 w-3 mr-1"}),a?"Hide":"Create"]}),i.length>0&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Qe,{className:"h-3 w-3"}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[i.length," saved"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Me,{className:"h-3 w-3 text-blue-600"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"Verified"})]})]}):e.jsxs(V,{className:"w-full",children:[e.jsx(ne,{className:"pb-3",children:e.jsxs(ie,{className:"text-sm flex items-center gap-2",children:[e.jsx(Qe,{className:"h-4 w-4"}),"Digital Signature"]})}),e.jsxs(G,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(R,{onClick:l,className:"w-full",variant:a?"secondary":"default",children:[e.jsx(et,{className:"h-4 w-4 mr-2"}),a?"Hide Signature Pad":"Create New Signature"]}),a&&e.jsxs("div",{className:"border rounded-lg p-4 bg-gray-50",children:[e.jsx(ui,{}),e.jsx("div",{className:"mt-3 flex justify-end",children:e.jsx(R,{variant:"outline",size:"sm",onClick:o,children:"Done"})})]})]}),e.jsx(Z,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"text-sm font-medium",children:"Saved Signatures"}),e.jsx(Fe,{variant:"secondary",className:"text-xs",children:i.length})]}),e.jsx(Re,{className:"h-48 w-full border rounded-md",children:e.jsx("div",{className:"p-2 space-y-2",children:i.length===0?e.jsx("div",{className:"text-center py-8 text-sm text-gray-500",children:"No saved signatures"}):i.map((u,c)=>e.jsx("div",{className:"border rounded-lg p-3 bg-white hover:bg-gray-50 transition-colors",children:e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"mb-2",children:e.jsx("img",{src:u.dataUrl,alt:`Signature ${c+1}`,className:"h-12 max-w-full object-contain border rounded bg-white"})}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[m(u)?e.jsx(lt,{className:"h-3 w-3 text-green-600"}):e.jsx(ct,{className:"h-3 w-3 text-red-600"}),e.jsx("span",{className:"text-xs font-medium",children:m(u)?"Verified":"Invalid"})]}),u.timestamp&&e.jsxs("div",{className:"text-xs text-gray-500",children:["Created: ",new Date(u.timestamp).toLocaleDateString()]}),e.jsxs("div",{className:"text-xs text-gray-400 font-mono",children:["Hash: ",u.hash.substring(0,12),"..."]})]})]}),e.jsx("div",{className:"flex flex-col gap-1",children:e.jsx(R,{variant:"outline",size:"sm",onClick:()=>d(u.hash),className:"h-6 w-6 p-0",children:e.jsx(Se,{className:"h-3 w-3"})})})]})},u.hash))})})]}),e.jsx(Z,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Me,{className:"h-4 w-4 text-blue-600"}),e.jsx("h4",{className:"text-sm font-medium",children:"Security Features"})]}),e.jsxs("div",{className:"text-xs text-gray-600 space-y-1",children:[e.jsx("div",{children:"• Signatures are cryptographically hashed"}),e.jsx("div",{children:"• Tampering detection with SHA-256"}),e.jsx("div",{children:"• Timestamp verification included"}),e.jsx("div",{children:"• Local storage for privacy"})]})]}),e.jsxs("div",{className:"text-xs text-gray-500 bg-blue-50 p-2 rounded",children:[e.jsx("strong",{children:"How to use:"}),e.jsxs("ol",{className:"mt-1 space-y-1 ml-3 list-decimal",children:[e.jsx("li",{children:"Create a new signature using the signature pad"}),e.jsx("li",{children:'Click "Save" to store your signature'}),e.jsx("li",{children:"Click anywhere on the PDF to place your signature"}),e.jsx("li",{children:"Signatures are embedded as images in the PDF"})]})]})]})]})},Ue={select:{name:"select",label:"Select",icon:W.createElement("span",{},"⚬"),component:Ie,category:"basic",defaultSettings:{},description:"Select and move elements"},inlineEdit:Vn,text:{name:"text",label:"Text",icon:W.createElement("span",{},"T"),component:Us,category:"text",defaultSettings:{fontSize:14,color:"#000000"},description:"Add text"},highlight:{name:"highlight",label:"Highlight",icon:W.createElement("span",{},"🖍"),component:Is,category:"annotation",defaultSettings:{color:"#FFFF00",opacity:.5},description:"Highlight text"},rectangle:{name:"rectangle",label:"Rectangle",icon:W.createElement("span",{},"▭"),component:je,category:"shape",defaultSettings:{strokeColor:"#000000",fillColor:"transparent"},description:"Draw rectangles"},circle:{name:"circle",label:"Circle",icon:W.createElement("span",{},"○"),component:je,category:"shape",defaultSettings:{strokeColor:"#000000",fillColor:"transparent"},description:"Draw circles"},freeform:{name:"freeform",label:"Freeform",icon:W.createElement("span",{},"✏"),component:Kn,category:"draw",defaultSettings:{color:"#000000",brushSize:3},description:"Free drawing"},form:{name:"form",label:"Form",icon:W.createElement("span",{},"📝"),component:ri,category:"form",defaultSettings:{fieldType:"text",width:150,height:30,required:!1,readonly:!1},description:"Add form fields"},eraser:{name:"eraser",label:"Eraser",icon:W.createElement("span",{},"🧽"),component:Ie,category:"edit",defaultSettings:{size:10},description:"Erase content"},checkmark:{name:"checkmark",label:"Checkmark",icon:W.createElement("span",{},"✓"),component:Ie,category:"annotation",defaultSettings:{color:"#00FF00"},description:"Add checkmarks"},"x-mark":{name:"x-mark",label:"X Mark",icon:W.createElement("span",{},"✗"),component:Ie,category:"annotation",defaultSettings:{color:"#FF0000"},description:"Add X marks"},line:{name:"line",label:"Line",icon:W.createElement("span",{},"―"),component:je,category:"shape",defaultSettings:{strokeColor:"#000000",strokeWidth:2},description:"Draw lines"},image:{name:"image",label:"Image",icon:W.createElement("span",{},"🖼"),component:Os,category:"media",defaultSettings:{opacity:1,rotation:0},description:"Add images"},whiteout:{name:"whiteout",label:"Whiteout",icon:W.createElement("span",{},"⬜"),component:Bs,category:"edit",defaultSettings:{color:"#FFFFFF"},description:"Cover content"},ocr:{name:"ocr",label:"OCR",icon:W.createElement("span",{},"👁"),component:Jn,category:"utility",defaultSettings:{},description:"Extract text"},signature:{name:"signature",label:"Signature",icon:W.createElement("span",{},"✍"),component:mi,category:"form",defaultSettings:{},description:"Add digital signatures"}};function xe(s){if(!s)return{color:Ae(0,0,0),opacity:1};if(s==="transparent")return{color:Ae(0,0,0),opacity:0};const t=s.replace("#","");if(t.length===6){const a=parseInt(t.slice(0,2),16)/255,n=parseInt(t.slice(2,4),16)/255,i=parseInt(t.slice(4,6),16)/255;return{color:Ae(a,n,i),opacity:1}}return{color:Ae(0,0,0),opacity:1}}async function xi(s,t,a,n,i,r=[],l){l==null||l(10,"Loading PDF document...");const o=await st.load(s);l==null||l(20,"Loading fonts...");const d=await Ms(o),m=o.getPages();a.length+t.length+n.length+i.length+r.length;for(let c=0;c<m.length;c++){const h=m[c],v=c+1,{height:w}=h.getSize();l==null||l(30+c/m.length*50,`Processing page ${v}/${m.length}...`);const N=a.filter(j=>j.page===v);for(const j of N){const T=w-j.y-j.height,{color:f,opacity:b}=xe(j.fillColor),{color:A,opacity:F}=xe(j.strokeColor||j.color),k=j.opacity||.3,y={borderWidth:j.strokeWidth,borderColor:A,borderOpacity:F};j.type==="rectangle"?h.drawRectangle({...y,x:j.x,y:T,width:j.width,height:j.height,color:f,opacity:b}):j.type==="highlight"?h.drawRectangle({x:j.x,y:T,width:j.width,height:j.height,color:xe(j.color).color,opacity:k}):j.type==="circle"&&h.drawEllipse({...y,x:j.x+j.width/2,y:T+j.height/2,xScale:j.width/2,yScale:j.height/2,color:f,opacity:b})}const E=t.filter(j=>j.page===v);for(const j of E){const T=d[j.fontFamily]||await o.embedFont(on.Helvetica);h.drawText(j.text,{x:j.x,y:w-j.y-j.fontSize,font:T,size:j.fontSize,color:xe(j.color).color,lineHeight:j.lineHeight*j.fontSize})}const p=n.filter(j=>j.page===v);for(const j of p){const{color:T}=xe(j.color||"#FFFFFF");h.drawRectangle({x:j.x,y:w-j.y-j.height,width:j.width,height:j.height,color:T})}const C=i.filter(j=>j.page===v);for(const j of C){const T=Uint8Array.from(atob(j.src.split(",")[1]),b=>b.charCodeAt(0));let f;if(j.src.startsWith("data:image/jpeg")||j.src.startsWith("data:image/jpg"))f=await o.embedJpg(T);else if(j.src.startsWith("data:image/png"))f=await o.embedPng(T);else{console.warn(`Unsupported image type for ${j.id}. Only JPG and PNG are supported.`);continue}h.drawImage(f,{x:j.x,y:w-j.y-j.height,width:j.width,height:j.height,rotate:cn(-j.rotation),opacity:j.opacity??1})}const g=r.filter(j=>j.page===v);for(const j of g)for(const T of j.paths){if(T.points.length<2)continue;const{color:f}=xe(T.color),b=T.points.map(A=>({x:A.x,y:w-A.y}));for(let A=1;A<b.length;A++){const F=b[A-1],k=b[A];h.drawLine({start:{x:F.x,y:F.y},end:{x:k.x,y:k.y},thickness:T.brushSize,color:f,opacity:T.opacity,lineCap:"round"})}}}l==null||l(90,"Finalizing PDF...");const u=await o.save();return l==null||l(100,"PDF saved successfully!"),u}function fi(s,t){const a=new Blob([new Uint8Array(s)],{type:"application/pdf"}),n=URL.createObjectURL(a),i=document.createElement("a");i.href=n,i.download=t,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(i.href)}const $s={pdfDocument:null,originalPdfData:null,currentPage:1,totalPages:0,scale:1,rotation:0,isLoading:!1,fileName:"",annotations:{},textElements:{},formFields:{},whiteoutBlocks:{},ocrResults:{},extractedTextRegions:{},detectedFonts:{},imageElements:{},selectedElementId:null,selectedElementIds:[],selectedElementType:null,signatureElements:{},freeformElements:{},currentTool:"select",canvasRef:null,toolSettings:Object.values(Ue).reduce((s,t)=>(s[t.name]={...t.defaultSettings},s),{}),history:[],historyIndex:-1,fontMatchingEnabled:!0,inlineEditingRegion:null};function pi(s,t){switch(t.type){case"LOAD_SUCCESS":{const n={annotations:{},formFields:{},whiteoutBlocks:{},textElements:{},imageElements:{},signatureElements:{},freeformElements:{},extractedTextRegions:{}};return{...$s,pdfDocument:t.payload.doc,originalPdfData:t.payload.data,totalPages:t.payload.doc.numPages,fileName:t.payload.file.name,history:[n],historyIndex:0}}case"SET_LOADING":return{...s,isLoading:t.payload};case"SET_CURRENT_PAGE":return{...s,currentPage:t.payload};case"SET_SCALE":return{...s,scale:t.payload};case"SET_ROTATION":return{...s,rotation:t.payload};case"SET_CURRENT_TOOL":return{...s,currentTool:t.payload};case"SET_SELECTED_ELEMENT":return{...s,selectedElementId:t.payload.id,selectedElementIds:t.payload.id?[t.payload.id]:[],selectedElementType:t.payload.type};case"SET_SELECTED_ELEMENTS":return{...s,selectedElementId:t.payload.ids.length>0?t.payload.ids[0]:null,selectedElementIds:t.payload.ids,selectedElementType:t.payload.type};case"ADD_TO_SELECTION":const a=s.selectedElementIds.includes(t.payload.id)?s.selectedElementIds.filter(n=>n!==t.payload.id):[...s.selectedElementIds,t.payload.id];return{...s,selectedElementId:a.length>0?a[0]:null,selectedElementIds:a,selectedElementType:a.length>0?t.payload.type:null};case"CLEAR_SELECTION":return{...s,selectedElementId:null,selectedElementIds:[],selectedElementType:null};case"ADD_ANNOTATION":return{...s,annotations:{...s.annotations,[t.payload.page]:[...s.annotations[t.payload.page]||[],t.payload.annotation]}};case"UPDATE_ANNOTATION":return{...s,annotations:{...s.annotations,[t.payload.page]:(s.annotations[t.payload.page]||[]).map(n=>n.id===t.payload.id?{...n,...t.payload.updates}:n)}};case"DELETE_ANNOTATION":return{...s,annotations:{...s.annotations,[t.payload.page]:(s.annotations[t.payload.page]||[]).filter(n=>n.id!==t.payload.id)}};case"ADD_IMAGE_ELEMENT":return{...s,imageElements:{...s.imageElements,[t.payload.page]:[...s.imageElements[t.payload.page]||[],t.payload.element]}};case"UPDATE_IMAGE_ELEMENT":return{...s,imageElements:{...s.imageElements,[t.payload.page]:(s.imageElements[t.payload.page]||[]).map(n=>n.id===t.payload.id?{...n,...t.payload.updates}:n)}};case"DELETE_IMAGE_ELEMENT":return{...s,imageElements:{...s.imageElements,[t.payload.page]:(s.imageElements[t.payload.page]||[]).filter(n=>n.id!==t.payload.id)}};case"ADD_TEXT_ELEMENT":return{...s,textElements:{...s.textElements,[t.payload.page]:[...s.textElements[t.payload.page]||[],t.payload.element]}};case"UPDATE_TEXT_ELEMENT":return{...s,textElements:{...s.textElements,[t.payload.page]:(s.textElements[t.payload.page]||[]).map(n=>n.id===t.payload.id?{...n,...t.payload.updates}:n)}};case"DELETE_TEXT_ELEMENT":return{...s,textElements:{...s.textElements,[t.payload.page]:(s.textElements[t.payload.page]||[]).filter(n=>n.id!==t.payload.id)}};case"ADD_WHITEOUT_BLOCK":return{...s,whiteoutBlocks:{...s.whiteoutBlocks,[t.payload.page]:[...s.whiteoutBlocks[t.payload.page]||[],t.payload.block]}};case"UPDATE_WHITEOUT_BLOCK":return{...s,whiteoutBlocks:{...s.whiteoutBlocks,[t.payload.page]:(s.whiteoutBlocks[t.payload.page]||[]).map(n=>n.id===t.payload.id?{...n,...t.payload.updates}:n)}};case"DELETE_WHITEOUT_BLOCK":return{...s,whiteoutBlocks:{...s.whiteoutBlocks,[t.payload.page]:(s.whiteoutBlocks[t.payload.page]||[]).filter(n=>n.id!==t.payload.id)}};case"ADD_FORM_FIELD":return{...s,formFields:{...s.formFields,[t.payload.page]:[...s.formFields[t.payload.page]||[],t.payload.field]}};case"UPDATE_FORM_FIELD":return{...s,formFields:{...s.formFields,[t.payload.page]:(s.formFields[t.payload.page]||[]).map(n=>n.id===t.payload.id?{...n,...t.payload.updates}:n)}};case"DELETE_FORM_FIELD":return{...s,formFields:{...s.formFields,[t.payload.page]:(s.formFields[t.payload.page]||[]).filter(n=>n.id!==t.payload.id)}};case"ADD_FREEFORM_ELEMENT":return{...s,freeformElements:{...s.freeformElements,[t.payload.page]:[...s.freeformElements[t.payload.page]||[],t.payload.element]}};case"UPDATE_FREEFORM_ELEMENT":return{...s,freeformElements:{...s.freeformElements,[t.payload.page]:(s.freeformElements[t.payload.page]||[]).map(n=>n.id===t.payload.id?{...n,...t.payload.updates}:n)}};case"DELETE_FREEFORM_ELEMENT":return{...s,freeformElements:{...s.freeformElements,[t.payload.page]:(s.freeformElements[t.payload.page]||[]).filter(n=>n.id!==t.payload.id)}};case"SET_OCR_RESULTS":return{...s,ocrResults:{...s.ocrResults,[t.payload.page]:t.payload.results}};case"SET_EXTRACTED_TEXT_REGIONS":return{...s,extractedTextRegions:{...s.extractedTextRegions,[t.payload.page]:t.payload.regions}};case"SET_DETECTED_FONTS":return{...s,detectedFonts:{...s.detectedFonts,[t.payload.page]:t.payload.fonts}};case"SET_INLINE_EDITING_REGION":return{...s,inlineEditingRegion:t.payload};case"UPDATE_TEXT_REGION":{const{page:n,id:i,updates:r}=t.payload;return{...s,extractedTextRegions:{...s.extractedTextRegions,[n]:(s.extractedTextRegions[n]||[]).map(l=>l.id===i?{...l,...r}:l)}}}case"UPDATE_TOOL_SETTING":return{...s,toolSettings:{...s.toolSettings,[t.payload.toolId]:{...s.toolSettings[t.payload.toolId],[t.payload.key]:t.payload.value}}};case"SAVE_TO_HISTORY":{const n={annotations:s.annotations,formFields:s.formFields,whiteoutBlocks:s.whiteoutBlocks,textElements:s.textElements,imageElements:s.imageElements,signatureElements:s.signatureElements,freeformElements:s.freeformElements,extractedTextRegions:s.extractedTextRegions},i=s.history.slice(0,s.historyIndex+1);return i.push(n),{...s,history:i,historyIndex:i.length-1}}case"UNDO":{if(s.historyIndex<=0)return s;const n=s.historyIndex-1,i=s.history[n];return{...s,...i,pdfDocument:s.pdfDocument,originalPdfData:s.originalPdfData,totalPages:s.totalPages,fileName:s.fileName,historyIndex:n}}case"REDO":{if(s.historyIndex>=s.history.length-1)return s;const n=s.historyIndex+1,i=s.history[n];return{...s,...i,pdfDocument:s.pdfDocument,originalPdfData:s.originalPdfData,totalPages:s.totalPages,fileName:s.fileName,historyIndex:n}}default:return s}}const Hs=x.createContext(void 0);function gi({children:s}){const[t,a]=x.useReducer(pi,$s),n=x.useRef(null),i=x.useRef(null),r=x.useRef(null),l=x.useCallback(async u=>{a({type:"SET_LOADING",payload:!0});try{const c=await u.arrayBuffer(),h=new Uint8Array(c),v=await Ss({data:h}).promise;a({type:"LOAD_SUCCESS",payload:{doc:v,file:u,data:h}})}catch(c){console.error("Failed to load PDF:",c),a({type:"SET_LOADING",payload:!1})}},[]),o=x.useCallback(async u=>{const c=u||t.currentPage;if(!(!t.pdfDocument||!n.current)){r.current&&r.current.cancel(),a({type:"SET_LOADING",payload:!0});try{const h=n.current,v=await t.pdfDocument.getPage(c),w=v.getViewport({scale:t.scale,rotation:t.rotation});h.height=w.height,h.width=w.width;const N=h.getContext("2d");if(N){const E=v.render({canvasContext:N,viewport:w});r.current=E,await E.promise,r.current=null}}catch(h){r.current=null,typeof h=="object"&&h!==null&&"name"in h&&h.name!=="RenderingCancelledException"&&console.error("PDF rendering failed:",h)}finally{a({type:"SET_LOADING",payload:!1})}}},[t.pdfDocument,t.currentPage,t.scale,t.rotation]),d=x.useCallback(async()=>{if(!t.originalPdfData){alert("No PDF file loaded to save.");return}a({type:"SET_LOADING",payload:!0});try{const u=Object.values(t.annotations).flat(),c=Object.values(t.textElements).flat(),h=Object.values(t.whiteoutBlocks).flat(),v=Object.values(t.imageElements).flat(),w=Object.values(t.freeformElements).flat(),N=await xi(t.originalPdfData,c,u,h,v,w,(p,C)=>{console.log(`Save progress: ${p}% - ${C}`)}),E=t.fileName.replace(".pdf","-edited.pdf");fi(N,E)}catch(u){console.error("Failed to save PDF:",u),alert("An error occurred while saving the PDF. See the console for details.")}finally{a({type:"SET_LOADING",payload:!1})}},[t.originalPdfData,t.annotations,t.textElements,t.whiteoutBlocks,t.fileName,t.imageElements,t.freeformElements]),m={state:t,dispatch:a,canvasRef:n,fileInputRef:i,loadPDF:l,renderPage:o,savePDF:d};return e.jsx(Hs.Provider,{value:m,children:s})}function ee(){const s=x.useContext(Hs);if(!s)throw new Error("usePDFEditor must be used within a PDFEditorProvider");return s}const yi=1,ji=1e6;let Ge=0;function bi(){return Ge=(Ge+1)%Number.MAX_SAFE_INTEGER,Ge.toString()}const Ye=new Map,It=s=>{if(Ye.has(s))return;const t=setTimeout(()=>{Ye.delete(s),Te({type:"REMOVE_TOAST",toastId:s})},ji);Ye.set(s,t)},vi=(s,t)=>{switch(t.type){case"ADD_TOAST":return{...s,toasts:[t.toast,...s.toasts].slice(0,yi)};case"UPDATE_TOAST":return{...s,toasts:s.toasts.map(a=>a.id===t.toast.id?{...a,...t.toast}:a)};case"DISMISS_TOAST":{const{toastId:a}=t;return a?It(a):s.toasts.forEach(n=>{It(n.id)}),{...s,toasts:s.toasts.map(n=>n.id===a||a===void 0?{...n,open:!1}:n)}}case"REMOVE_TOAST":return t.toastId===void 0?{...s,toasts:[]}:{...s,toasts:s.toasts.filter(a=>a.id!==t.toastId)}}},_e=[];let Le={toasts:[]};function Te(s){Le=vi(Le,s),_e.forEach(t=>{t(Le)})}function Ni({...s}){const t=bi(),a=i=>Te({type:"UPDATE_TOAST",toast:{...i,id:t}}),n=()=>Te({type:"DISMISS_TOAST",toastId:t});return Te({type:"ADD_TOAST",toast:{...s,id:t,open:!0,onOpenChange:i=>{i||n()}}}),{id:t,dismiss:n,update:a}}function wi(){const[s,t]=x.useState(Le);return x.useEffect(()=>(_e.push(t),()=>{const a=_e.indexOf(t);a>-1&&_e.splice(a,1)}),[s]),{...s,toast:Ni,dismiss:a=>Te({type:"DISMISS_TOAST",toastId:a})}}function Ei({page:s,textRegions:t,scale:a,rotation:n,onRegionClick:i,showRegions:r}){const l=(o,d)=>{d.stopPropagation(),i(o)};return!r||t.length===0?null:e.jsx("div",{className:"absolute inset-0 pointer-events-none z-10","data-testid":"text-extraction-layer","data-page":s,children:t.map(o=>e.jsx("div",{className:O("absolute border-2 border-transparent transition-all duration-200 cursor-text pointer-events-auto","hover:border-blue-500 hover:bg-blue-50/20",o.isEditing&&"border-blue-500 bg-blue-50/30"),style:{left:o.x*a,top:o.y*a,width:o.width*a,height:o.height*a,transform:n!==0?`rotate(${n}deg)`:void 0,transformOrigin:"top left"},onClick:d=>l(o,d),title:`Click to edit: ${o.text.substring(0,50)}${o.text.length>50?"...":""}`,"data-testid":`text-region-${o.id}`,"data-font-name":o.fontName,"data-font-size":o.fontSize,"data-text":o.text},o.id))})}function Ti({textElements:s,selectedElementId:t,selectedElementIds:a=[],scale:n,page:i,dispatch:r,currentTool:l="select"}){const[o,d]=x.useState(null),m=(c,h)=>{r({type:"UPDATE_TEXT_ELEMENT",payload:{page:i,id:c,updates:h}})},u=(c,h)=>{h.stopPropagation(),(l==="select"||l==="text")&&(h.ctrlKey||h.metaKey?r({type:"ADD_TO_SELECTION",payload:{id:c,type:"text"}}):r({type:"SET_SELECTED_ELEMENT",payload:{id:c,type:"text"}}))};return x.useEffect(()=>{s.find(h=>h.id===t&&h.text==="New Text Box")&&d(t)},[t,s]),e.jsx("div",{className:"absolute inset-0 pointer-events-none",children:s.map(c=>e.jsx(Si,{element:c,isSelected:t===c.id||a.includes(c.id),isEditing:o===c.id,onUpdate:m,onSelect:u,onSetEditing:d,onSaveHistory:()=>r({type:"SAVE_TO_HISTORY"}),scale:n},c.id))})}const Si=({element:s,isSelected:t,isEditing:a,onUpdate:n,onSelect:i,onSetEditing:r,onSaveHistory:l,scale:o})=>{const d=x.useRef(null),m=x.useRef(null);x.useEffect(()=>{if(a&&d.current){const v=d.current;v.style.height="auto",v.style.height=`${v.scrollHeight}px`,n(s.id,{height:v.scrollHeight/o})}},[s.text,a,o,n,s.id]),x.useEffect(()=>{a&&d.current&&(d.current.focus(),d.current.select())},[a]);const u=v=>{v.stopPropagation(),r(s.id)},c=()=>{r(null),l()},h={fontFamily:s.fontFamily,fontSize:s.fontSize*o,color:s.color,fontWeight:s.bold?"bold":"normal",fontStyle:s.italic?"italic":"normal",textDecoration:s.underline?"underline":"none",textAlign:s.textAlign,lineHeight:s.lineHeight,width:"100%",height:"100%",backgroundColor:"transparent",border:"none",outline:"none",resize:"none",padding:0,margin:0,overflow:"hidden"};return e.jsx(xa,{nodeRef:m,position:{x:s.x*o,y:s.y*o},onStop:(v,w)=>{n(s.id,{x:w.x/o,y:w.y/o}),l()},scale:1,disabled:a,children:e.jsx("div",{ref:m,className:`absolute pointer-events-auto cursor-move ${t?"ring-2 ring-blue-500 ring-offset-2":""}`,style:{width:s.width*o,minHeight:s.height*o,transform:`rotate(${s.rotation}deg)`,border:a?"1px dashed #3B82F6":"1px solid transparent"},onClick:v=>{i(s.id,v)},onDoubleClick:u,children:a?e.jsx("textarea",{ref:d,value:s.text,onChange:v=>{n(s.id,{text:v.target.value})},onBlur:c,style:h,onMouseDown:v=>v.stopPropagation()}):e.jsx("div",{className:"w-full h-full overflow-hidden whitespace-pre-wrap select-none",style:h,children:s.text})})})};function Ci({imageElements:s,selectedElementId:t,selectedElementIds:a=[],scale:n,page:i,dispatch:r,currentTool:l="select"}){const o=(u,c)=>{r({type:"UPDATE_IMAGE_ELEMENT",payload:{page:i,id:u,updates:c}})},d=(u,c)=>{c.stopPropagation(),(l==="select"||l==="image")&&(c.ctrlKey||c.metaKey?r({type:"ADD_TO_SELECTION",payload:{id:u,type:"image"}}):r({type:"SET_SELECTED_ELEMENT",payload:{id:u,type:"image"}}))},m=()=>{r({type:"SAVE_TO_HISTORY"})};return e.jsx("div",{className:"absolute inset-0 pointer-events-none",children:s.map(u=>e.jsx(nt,{className:`absolute pointer-events-auto ${t===u.id||a.includes(u.id)?"ring-2 ring-blue-500 ring-offset-2":""}`,size:{width:u.width*n,height:u.height*n},position:{x:u.x*n,y:u.y*n},onDragStop:(c,h)=>{o(u.id,{x:h.x/n,y:h.y/n}),m()},onResizeStop:(c,h,v,w,N)=>{o(u.id,{width:v.offsetWidth/n,height:v.offsetHeight/n,x:N.x/n,y:N.y/n}),m()},onClick:c=>{d(u.id,c)},lockAspectRatio:!0,children:e.jsx("img",{src:u.src,alt:"User uploaded content",className:"w-full h-full",style:{transform:`rotate(${u.rotation}deg)`,opacity:u.opacity||1,border:u.borderWidth?`${u.borderWidth}px solid ${u.borderColor||"#000000"}`:"none"},onDragStart:c=>c.preventDefault()})},u.id))})}function Fi({annotations:s,selectedElementId:t,selectedElementIds:a,scale:n,page:i,dispatch:r,currentTool:l}){const o=(c,h)=>{r({type:"UPDATE_ANNOTATION",payload:{page:i,id:c,updates:h}})},d=(c,h)=>{if(h.stopPropagation(),l==="select"){const v=h.ctrlKey||h.metaKey;r(v?{type:"ADD_TO_SELECTION",payload:{id:c,type:"annotation"}}:{type:"SET_SELECTED_ELEMENT",payload:{id:c,type:"annotation"}})}},m=()=>{r({type:"SAVE_TO_HISTORY"})},u=c=>{r({type:"DELETE_ANNOTATION",payload:{page:i,id:c}}),r({type:"SET_SELECTED_ELEMENT",payload:{id:null,type:null}}),m()};return W.useEffect(()=>{const c=h=>{t&&h.key==="Delete"&&s.find(w=>w.id===t)&&u(t)};return document.addEventListener("keydown",c),()=>document.removeEventListener("keydown",c)},[t,s]),e.jsx("div",{className:"absolute inset-0 pointer-events-none",children:s.map(c=>{const h=a.includes(c.id),v=l==="select";return!v&&!h?e.jsx("div",{className:"absolute",style:{left:c.x*n,top:c.y*n,width:(c.width||0)*n,height:(c.height||0)*n,border:c.type==="highlight"?"none":`${c.strokeWidth||1}px solid ${c.strokeColor||c.color}`,backgroundColor:c.type==="highlight"?c.color:c.fillColor,opacity:c.opacity||1,borderRadius:c.type==="circle"?"50%":`${c.cornerRadius||0}px`,borderStyle:c.strokeStyle||"solid",mixBlendMode:c.blendMode||(c.type==="highlight"?"multiply":"normal"),pointerEvents:"none"}},c.id):e.jsx(nt,{className:`absolute ${v?"pointer-events-auto":"pointer-events-none"} ${h?"ring-2 ring-blue-500 ring-offset-1":""} ${a.length>1&&h?"ring-offset-0":""}`,size:{width:(c.width||0)*n,height:(c.height||0)*n},position:{x:c.x*n,y:c.y*n},onDragStop:(w,N)=>{o(c.id,{x:N.x/n,y:N.y/n}),m()},onResizeStop:(w,N,E,p,C)=>{o(c.id,{width:E.offsetWidth/n,height:E.offsetHeight/n,x:C.x/n,y:C.y/n}),m()},onClick:w=>d(c.id,w),disableDragging:!h||l!=="select",enableResizing:h&&l==="select",disableResizing:!h||l!=="select",children:e.jsx("div",{className:"w-full h-full",style:{border:c.type==="highlight"?"none":`${c.strokeWidth||1}px solid ${c.strokeColor||c.color}`,backgroundColor:c.type==="highlight"?c.color:c.fillColor,opacity:c.opacity||1,borderRadius:c.type==="circle"?"50%":`${c.cornerRadius||0}px`,borderStyle:c.strokeStyle||"solid",mixBlendMode:c.blendMode||(c.type==="highlight"?"multiply":"normal"),cursor:v?"pointer":"default"}})},c.id)})})}function ki({whiteoutBlocks:s,selectedElementId:t,selectedElementIds:a,scale:n,page:i,dispatch:r,currentTool:l}){const o=(c,h)=>{r({type:"UPDATE_WHITEOUT_BLOCK",payload:{page:i,id:c,updates:h}})},d=(c,h)=>{if(h.stopPropagation(),l==="select"){const v=h.ctrlKey||h.metaKey;r(v?{type:"ADD_TO_SELECTION",payload:{id:c,type:"whiteout"}}:{type:"SET_SELECTED_ELEMENT",payload:{id:c,type:"whiteout"}})}},m=()=>{r({type:"SAVE_TO_HISTORY"})},u=c=>{r({type:"DELETE_WHITEOUT_BLOCK",payload:{page:i,id:c}}),r({type:"SET_SELECTED_ELEMENT",payload:{id:null,type:null}}),m()};return W.useEffect(()=>{const c=h=>{t&&h.key==="Delete"&&s.find(w=>w.id===t)&&u(t)};return document.addEventListener("keydown",c),()=>document.removeEventListener("keydown",c)},[t,s]),e.jsx("div",{className:"absolute inset-0 pointer-events-none",children:s.map(c=>{const h=a.includes(c.id),v=l==="select";return!v&&!h?e.jsx("div",{className:"absolute",style:{left:c.x*n,top:c.y*n,width:c.width*n,height:c.height*n,backgroundColor:c.color||"#FFFFFF",pointerEvents:"none"}},c.id):e.jsx(nt,{className:`absolute ${v?"pointer-events-auto":"pointer-events-none"} ${h?"ring-2 ring-blue-500 ring-offset-1":""} ${a.length>1&&h?"ring-offset-0":""}`,size:{width:c.width*n,height:c.height*n},position:{x:c.x*n,y:c.y*n},onDragStop:(w,N)=>{o(c.id,{x:N.x/n,y:N.y/n}),m()},onResizeStop:(w,N,E,p,C)=>{o(c.id,{width:E.offsetWidth/n,height:E.offsetHeight/n,x:C.x/n,y:C.y/n}),m()},onClick:w=>d(c.id,w),disableDragging:!h||l!=="select",enableResizing:h&&l==="select",disableResizing:!h||l!=="select",children:e.jsx("div",{className:"w-full h-full",style:{backgroundColor:c.color||"#FFFFFF",cursor:v?"pointer":"default",border:h?"1px dashed #3B82F6":"none"}})},c.id)})})}const Di=(s,t)=>{if(t==="none"||s.length<3)return s;const a={low:.1,medium:.3,high:.5}[t],n=[s[0]];for(let i=1;i<s.length-1;i++){const r=s[i-1],l=s[i],o=s[i+1];n.push({x:l.x+(r.x+o.x-2*l.x)*a,y:l.y+(r.y+o.y-2*l.y)*a})}return s.length>1&&n.push(s[s.length-1]),n},Ri=s=>{if(s.length===0)return{x:0,y:0,width:0,height:0};let t=1/0,a=1/0,n=-1/0,i=-1/0;return s.forEach(r=>{r.points.forEach(l=>{t=Math.min(t,l.x),a=Math.min(a,l.y),n=Math.max(n,l.x),i=Math.max(i,l.y)})}),{x:t,y:a,width:n-t,height:i-a}},Pi=({elements:s,currentPage:t,scale:a,isDrawing:n,brushSettings:i,selectedElementIds:r,onElementsChange:l,onElementSelect:o})=>{const d=x.useRef(null),[m,u]=x.useState({isDrawing:!1,currentPath:[],startTime:0}),c=x.useCallback(E=>{var j;if(!n)return;const p=(j=d.current)==null?void 0:j.getBoundingClientRect();if(!p)return;const C=(E.clientX-p.left)/a,g=(E.clientY-p.top)/a;u({isDrawing:!0,currentPath:[{x:C,y:g}],startTime:Date.now()})},[n,a]),h=x.useCallback(E=>{var j;if(!m.isDrawing||!n)return;const p=(j=d.current)==null?void 0:j.getBoundingClientRect();if(!p)return;const C=(E.clientX-p.left)/a,g=(E.clientY-p.top)/a;u(T=>({...T,currentPath:[...T.currentPath,{x:C,y:g}]}))},[m.isDrawing,n,a]),v=x.useCallback(()=>{if(!m.isDrawing||m.currentPath.length<2){u({isDrawing:!1,currentPath:[],startTime:0});return}const p={points:Di(m.currentPath,i.smoothing),color:i.color,opacity:i.opacity,brushSize:i.brushSize,smoothing:i.smoothing},C={id:`freeform-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,page:t,paths:[p],bounds:Ri([p])};l([...s,C]),u({isDrawing:!1,currentPath:[],startTime:0})},[m,i,t,s,l]),w=x.useCallback((E,p)=>{p.stopPropagation(),o(E,p)},[o]),N=E=>{if(E.length<2)return"";let p=`M ${E[0].x*a} ${E[0].y*a}`;for(let C=1;C<E.length;C++)p+=` L ${E[C].x*a} ${E[C].y*a}`;return p};return e.jsxs("svg",{ref:d,className:"absolute inset-0 pointer-events-auto",style:{cursor:n?"crosshair":"default"},onMouseDown:c,onMouseMove:h,onMouseUp:v,onMouseLeave:v,children:[s.filter(E=>E.page===t).map(E=>e.jsxs("g",{children:[E.paths.map((p,C)=>e.jsx("path",{d:N(p.points),stroke:p.color,strokeWidth:p.brushSize*a,strokeOpacity:p.opacity,fill:"none",strokeLinecap:"round",strokeLinejoin:"round",className:r.includes(E.id)?"ring-2 ring-blue-500":"",onClick:g=>w(E.id,g),style:{cursor:"pointer"}},C)),r.includes(E.id)&&e.jsx("rect",{x:E.bounds.x*a-5,y:E.bounds.y*a-5,width:E.bounds.width*a+10,height:E.bounds.height*a+10,fill:"none",stroke:"#3b82f6",strokeWidth:"2",strokeDasharray:"5,5",pointerEvents:"none"})]},E.id)),m.isDrawing&&m.currentPath.length>1&&e.jsx("path",{d:N(m.currentPath),stroke:i.color,strokeWidth:i.brushSize*a,strokeOpacity:i.opacity,fill:"none",strokeLinecap:"round",strokeLinejoin:"round",pointerEvents:"none"})]})};class ge{constructor(){this.fontCache=new Map,this.systemFonts=new Set(["Arial","Helvetica","Times","Times New Roman","Courier","Courier New","Georgia","Verdana","Tahoma","Impact","Comic Sans MS","Trebuchet MS","Palatino","Garamond","Bookman","Avant Garde"])}static getInstance(){return ge.instance||(ge.instance=new ge),ge.instance}async analyzePDFFonts(t){const a=[];for(let n=1;n<=t.numPages;n++){const i=await this.analyzePageFonts(t,n);a.push(i)}return a}async analyzePageFonts(t,a){const n=await t.getPage(a),i=await n.getTextContent(),r=n.getViewport({scale:1}),l=[],o=new Map;return i.items.forEach((d,m)=>{if(!d.str||d.str.trim()==="")return;const u=d.transform,c=Math.abs(u[0]),h=u[4],v=r.height-u[5],w=i.styles[d.fontName],N=this.extractFontInfo(d.fontName,w,c),E={id:`text-${a}-${m}`,page:a,x:h,y:v-c,width:d.width,height:d.height||c,text:d.str,fontName:d.fontName,fontSize:c,fontWeight:N.fontWeight,fontStyle:N.fontStyle,color:"#000000",rotation:this.getRotationFromTransform(u),isEditing:!1,originalFontInfo:N};l.push(E);const p=`${N.fontFamily}-${N.fontWeight}-${N.fontStyle}`;if(o.has(p)){const C=o.get(p);C.instances++,C.pages.includes(a)||C.pages.push(a)}else o.set(p,{...N,instances:1,pages:[a]})}),{page:a,fonts:Array.from(o.values()),textRegions:l,confidence:this.calculateConfidence(Array.from(o.values()))}}extractFontInfo(t,a,n){const i=`${t}-${n}`;if(this.fontCache.has(i))return{...this.fontCache.get(i)};const{family:r,weight:l,styleInfo:o}=this.parseFontName(t,a),d={id:i,fontName:t,fontFamily:r,fontSize:n,fontWeight:l,fontStyle:o,isSystemFont:this.systemFonts.has(r),fallbackFont:this.getFallbackFont(r),instances:0,pages:[],confidence:this.calculateFontConfidence(r,t)};return this.fontCache.set(i,d),d}parseFontName(t,a){let n=(a==null?void 0:a.fontFamily)||"Unknown",i="normal",r="normal";n=n.replace(/['"]/g,"").split(",")[0].trim();const l=t.toLowerCase(),o=n.toLowerCase();return(l.includes("bold")||o.includes("bold")||l.includes("heavy")||o.includes("heavy"))&&(i="bold"),(l.includes("italic")||o.includes("italic")||l.includes("oblique")||o.includes("oblique"))&&(r="italic"),{family:{helvetica:"Helvetica",arial:"Arial",times:"Times New Roman",courier:"Courier New",georgia:"Georgia",verdana:"Verdana"}[o]||n,weight:i,styleInfo:r}}getFallbackFont(t){return{Helvetica:"Arial",Times:"Times New Roman",Courier:"Courier New",Palatino:"Georgia",Optima:"Verdana"}[t]||"Arial"}getRotationFromTransform(t){return Math.atan2(t[1],t[0])*180/Math.PI}calculateFontConfidence(t,a){return this.systemFonts.has(t)?.9:t!=="Unknown"?.7:.3}calculateConfidence(t){if(t.length===0)return 0;const a=t.reduce((n,i)=>n+i.confidence,0)/t.length;return Math.min(a+(t.length>1?.1:0),1)}async matchSystemFont(t){const{fontFamily:a,fontWeight:n,fontStyle:i}=t;return await this.isFontAvailable(a)?this.buildFontString(a,n,i):t.fallbackFont&&await this.isFontAvailable(t.fallbackFont)?this.buildFontString(t.fallbackFont,n,i):this.buildFontString("Arial",n,i)}async isFontAvailable(t){try{const a=new FontFace("test-font",`local("${t}")`);return await a.load(),a.status==="loaded"}catch{return this.systemFonts.has(t)}}buildFontString(t,a,n){const i=[];return n==="italic"&&i.push("italic"),a==="bold"&&i.push("bold"),i.push(`"${t}"`),i.join(" ")}findBestFontMatch(t,a){if(!a.length)return null;let n=a.find(l=>l.fontFamily.toLowerCase()===t.toLowerCase());if(n)return n;let i=a.find(l=>l.fontFamily.toLowerCase().includes(t.toLowerCase())||t.toLowerCase().includes(l.fontFamily.toLowerCase()));if(i)return i;let r=a.find(l=>{var o;return((o=l.fallbackFont)==null?void 0:o.toLowerCase())===t.toLowerCase()});return r||a.reduce((l,o)=>o.confidence>l.confidence?o:l)}findSimilarFonts(t,a,n=5){return a.map(r=>({font:r,score:this.calculateFontSimilarity(t,r)})).sort((r,l)=>l.score-r.score).slice(0,n).map(r=>r.font)}calculateFontSimilarity(t,a){let n=0;t.fontFamily===a.fontFamily?n+=.5:(t.fontFamily.toLowerCase().includes(a.fontFamily.toLowerCase())||a.fontFamily.toLowerCase().includes(t.fontFamily.toLowerCase()))&&(n+=.3),t.fontWeight===a.fontWeight&&(n+=.2),t.fontStyle===a.fontStyle&&(n+=.2);const i=Math.abs(t.fontSize-a.fontSize);return i<=2?n+=.1:i<=5&&(n+=.05),n}generateFontStack(t){const a=[t.fontFamily];return t.fallbackFont&&t.fallbackFont!==t.fontFamily&&a.push(t.fallbackFont),t.fontFamily.toLowerCase().includes("serif")||["Times","Georgia","Garamond"].some(n=>t.fontFamily.includes(n))?a.push("serif"):t.fontFamily.toLowerCase().includes("mono")||["Courier","Monaco","Consolas"].some(n=>t.fontFamily.includes(n))?a.push("monospace"):a.push("sans-serif"),a.map(n=>n.includes(" ")?`"${n}"`:n).join(", ")}clearCache(){this.fontCache.clear()}}const at=ge.getInstance();function Ai({textRegion:s,onSave:t,onCancel:a,scale:n,rotation:i,detectedFonts:r=[]}){const[l,o]=x.useState(s.text),[d,m]=x.useState(s.text.length>50),[u,c]=x.useState(!1),h=x.useRef(null),v=x.useRef(null),w=x.useMemo(()=>{var j,T;if(!((j=s.originalFontInfo)!=null&&j.fontFamily)||!r.length)return((T=s.originalFontInfo)==null?void 0:T.fontFamily)||"Arial";const g=at.findBestFontMatch(s.originalFontInfo.fontFamily,r);return g?at.generateFontStack(g):s.originalFontInfo.fontFamily},[s.originalFontInfo,r]);x.useEffect(()=>{const g=d?v.current:h.current;g&&(g.focus(),g.select())},[d]);const N=()=>{t(l)},E=g=>{g.key==="Enter"&&!g.shiftKey&&!d?(g.preventDefault(),N()):g.key==="Escape"&&(g.preventDefault(),a())},p={fontFamily:w,fontSize:`${Math.max(s.fontSize*n,12)}px`,fontWeight:s.fontWeight,fontStyle:s.fontStyle,color:s.color,lineHeight:1.2,transform:i!==0?`rotate(${i}deg)`:void 0,wordWrap:"break-word",overflowWrap:"break-word",hyphens:"auto"},C=x.useMemo(()=>{const j=document.createElement("canvas").getContext("2d");if(!j)return{willOverflow:!1,estimatedHeight:s.height};j.font=`${p.fontWeight} ${p.fontSize} ${p.fontFamily}`;const T=j.measureText(l).width,f=s.width*n-8,b=T>f,A=Math.ceil(T/f),F=A*(s.fontSize*n*1.2);return{willOverflow:b,estimatedHeight:F,lines:A}},[l,p,s,n]);return e.jsxs("div",{className:"absolute z-50 animate-in fade-in-0 zoom-in-95 duration-200",style:{left:s.x*n,top:s.y*n,width:s.width*n,minHeight:Math.max(s.height*n,C.estimatedHeight)},"data-testid":"inline-text-editor",children:[e.jsx("div",{className:O("absolute inset-0 rounded-sm shadow-lg -z-10",C.willOverflow?"bg-yellow-50 border-2 border-yellow-400":"bg-blue-50 border-2 border-primary")}),C.willOverflow&&e.jsxs("div",{className:"absolute -top-6 right-0 text-xs text-yellow-600 bg-yellow-100 px-2 py-1 rounded",children:["Text may overflow (",C.lines," lines)"]}),d?e.jsx("textarea",{ref:v,value:l,onChange:g=>o(g.target.value),onKeyDown:E,className:O("w-full h-full px-2 py-1 bg-transparent resize-none outline-none","border-none focus:ring-0"),style:p,"data-testid":"textarea-editor"}):e.jsx(z,{ref:h,value:l,onChange:g=>o(g.target.value),onKeyDown:E,className:O("w-full h-full px-2 py-1 bg-transparent border-none focus:ring-0","focus-visible:ring-0 focus-visible:ring-offset-0"),style:p,"data-testid":"input-editor"}),e.jsxs("div",{className:"absolute -top-10 left-0 flex items-center gap-1 bg-white shadow-lg rounded-md border border-gray-200 p-1",children:[e.jsx(R,{size:"sm",variant:"ghost",onClick:N,className:"h-6 w-6 p-0 text-green-600 hover:text-green-700 hover:bg-green-50",title:"Save Changes","data-testid":"button-save",children:e.jsx(De,{className:"h-3 w-3"})}),e.jsx(R,{size:"sm",variant:"ghost",onClick:a,className:"h-6 w-6 p-0 text-red-600 hover:text-red-700 hover:bg-red-50",title:"Cancel","data-testid":"button-cancel",children:e.jsx(Be,{className:"h-3 w-3"})}),e.jsx("div",{className:"w-px h-4 bg-gray-300 mx-1"}),e.jsx(R,{size:"sm",variant:"ghost",onClick:()=>m(!d),className:"h-6 w-6 p-0 text-gray-600 hover:text-gray-700 hover:bg-gray-50",title:"Toggle Multiline","data-testid":"button-multiline",children:e.jsx(rt,{className:"h-3 w-3"})}),e.jsx(R,{size:"sm",variant:"ghost",onClick:()=>c(!u),className:"h-6 w-6 p-0 text-blue-600 hover:text-blue-700 hover:bg-blue-50",title:"Toggle Preview","data-testid":"button-preview",children:e.jsx(Ga,{className:"h-3 w-3"})})]}),u&&e.jsxs("div",{className:"absolute -right-2 top-0 w-48 bg-white border border-gray-200 rounded-md shadow-lg p-2 z-10",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Preview:"}),e.jsx("div",{className:"text-sm border border-gray-100 rounded p-1 bg-gray-50",style:{fontFamily:w,fontSize:"12px",fontWeight:s.fontWeight,fontStyle:s.fontStyle,color:s.color,wordWrap:"break-word"},children:l||"Type to see preview..."}),e.jsxs("div",{className:"text-xs text-gray-400 mt-1",children:["Font: ",w,C.willOverflow&&e.jsx("span",{className:"text-yellow-600",children:" ⚠ Overflow"})]})]}),e.jsx("div",{className:"absolute -right-1 -bottom-1 w-3 h-3 bg-primary rounded-full cursor-se-resize shadow-sm",title:"Resize","data-testid":"resize-handle"})]})}const Ii=({children:s})=>{const{state:t,dispatch:a}=ee(),{selectedElementIds:n,selectedElementType:i,currentPage:r,annotations:l,textElements:o,imageElements:d,whiteoutBlocks:m,currentTool:u}=t,c=x.useRef(null);x.useEffect(()=>{const p=C=>{if(C.target.tagName==="INPUT"||C.target.tagName==="TEXTAREA"||C.target.contentEditable==="true")return;const g=C.ctrlKey||C.metaKey,j=C.shiftKey;switch(C.key){case"Delete":case"Backspace":C.preventDefault(),h();break;case"a":case"A":g&&(C.preventDefault(),v());break;case"c":case"C":g&&(C.preventDefault(),w());break;case"v":case"V":g&&(C.preventDefault(),N());break;case"d":case"D":g&&(C.preventDefault(),E());break;case"z":case"Z":g&&!j?(C.preventDefault(),a({type:"UNDO"})):g&&j&&(C.preventDefault(),a({type:"REDO"}));break;case"y":case"Y":g&&(C.preventDefault(),a({type:"REDO"}));break;case"Escape":C.preventDefault(),a({type:"CLEAR_SELECTION"});break}};return document.addEventListener("keydown",p),()=>document.removeEventListener("keydown",p)},[n,i,r,u]);const h=()=>{n.length!==0&&(n.forEach(p=>{i==="annotation"?a({type:"DELETE_ANNOTATION",payload:{page:r,id:p}}):i==="text"?a({type:"DELETE_TEXT_ELEMENT",payload:{page:r,id:p}}):i==="image"?a({type:"DELETE_IMAGE_ELEMENT",payload:{page:r,id:p}}):i==="whiteout"&&a({type:"DELETE_WHITEOUT_BLOCK",payload:{page:r,id:p}})}),a({type:"CLEAR_SELECTION"}),a({type:"SAVE_TO_HISTORY"}))},v=()=>{if(u!=="select")return;const p=l[r]||[],C=o[r]||[],g=d[r]||[],j=m[r]||[],T=[...p.map(f=>({...f,elementType:"annotation"})),...C.map(f=>({...f,elementType:"text"})),...g.map(f=>({...f,elementType:"image"})),...j.map(f=>({...f,elementType:"whiteout"}))];if(T.length>0){const f=T.map(b=>b.id);a({type:"SET_SELECTED_ELEMENTS",payload:{ids:f,type:T.length===1?T[0].elementType:null}})}},w=()=>{if(n.length===0||!i)return;const p=[];n.forEach(C=>{let g;i==="annotation"?g=Object.values(l).flat().find(j=>j.id===C):i==="text"?g=Object.values(o).flat().find(j=>j.id===C):i==="image"?g=Object.values(d).flat().find(j=>j.id===C):i==="whiteout"&&(g=Object.values(m).flat().find(j=>j.id===C)),g&&p.push(g)}),c.current={elements:p,type:i}},N=()=>{if(!c.current||c.current.elements.length===0)return;const p=20,C=[];c.current.elements.forEach((g,j)=>{const T=`${c.current.type}-${Date.now()}-${j}`,f={...g,id:T,x:g.x+p,y:g.y+p};C.push(T),c.current.type==="annotation"?a({type:"ADD_ANNOTATION",payload:{page:r,annotation:f}}):c.current.type==="text"?a({type:"ADD_TEXT_ELEMENT",payload:{page:r,element:f}}):c.current.type==="image"?a({type:"ADD_IMAGE_ELEMENT",payload:{page:r,element:f}}):c.current.type==="whiteout"&&a({type:"ADD_WHITEOUT_BLOCK",payload:{page:r,block:f}})}),a({type:"SET_SELECTED_ELEMENTS",payload:{ids:C,type:c.current.type}}),a({type:"SAVE_TO_HISTORY"})},E=()=>{if(n.length===0||!i)return;const p=20,C=[];n.forEach((g,j)=>{let T;if(i==="annotation"?T=Object.values(l).flat().find(f=>f.id===g):i==="text"?T=Object.values(o).flat().find(f=>f.id===g):i==="image"?T=Object.values(d).flat().find(f=>f.id===g):i==="whiteout"&&(T=Object.values(m).flat().find(f=>f.id===g)),T){const f=`${i}-${Date.now()}-${j}`,b={...T,id:f,x:T.x+p,y:T.y+p};C.push(f),i==="annotation"?a({type:"ADD_ANNOTATION",payload:{page:r,annotation:b}}):i==="text"?a({type:"ADD_TEXT_ELEMENT",payload:{page:r,element:b}}):i==="image"?a({type:"ADD_IMAGE_ELEMENT",payload:{page:r,element:b}}):i==="whiteout"&&a({type:"ADD_WHITEOUT_BLOCK",payload:{page:r,block:b}})}}),a({type:"SET_SELECTED_ELEMENTS",payload:{ids:C,type:i}}),a({type:"SAVE_TO_HISTORY"})};return e.jsx(e.Fragment,{children:s})};function Oi({detectedFonts:s,selectedFont:t,fontSize:a,fontWeight:n,fontStyle:i,textColor:r,textAlign:l,onFontChange:o,onFontSizeChange:d,onFontWeightChange:m,onFontStyleChange:u,onTextColorChange:c,onTextAlignChange:h,horizontal:v=!1}){const w=["Arial","Times New Roman","Georgia","Courier New","Verdana","Tahoma","Impact","Comic Sans MS"],E=[...s.map(p=>({value:p.fontFamily,label:`${p.fontFamily} (Detected)`,isDetected:!0})),...w.map(p=>({value:p,label:`${p} (System)`,isDetected:!1}))].filter((p,C,g)=>C===g.findIndex(j=>j.value===p.value));return v?e.jsxs("div",{className:"flex items-center gap-4","data-testid":"font-style-panel",children:[e.jsxs(K,{value:t,onValueChange:o,children:[e.jsx(Y,{className:"w-32",children:e.jsx(X,{placeholder:"Font"})}),e.jsx(q,{children:E.map(p=>e.jsx(L,{value:p.value,children:e.jsx("span",{className:O(p.isDetected?"text-green-700":"text-gray-700"),children:p.label})},p.value))})]}),e.jsx(z,{type:"number",value:a,onChange:p=>d(Number(p.target.value)),min:"8",max:"72",className:"w-16"}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(R,{variant:n==="bold"?"default":"outline",size:"sm",onClick:()=>m(n==="bold"?"normal":"bold"),className:"h-8 px-2",children:e.jsx(Je,{className:"h-3 w-3"})}),e.jsx(R,{variant:i==="italic"?"default":"outline",size:"sm",onClick:()=>u(i==="italic"?"normal":"italic"),className:"h-8 px-2",children:e.jsx(Ze,{className:"h-3 w-3"})})]}),e.jsx("input",{type:"color",value:r,onChange:p=>c(p.target.value),className:"w-8 h-8 border border-gray-300 rounded cursor-pointer"}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(R,{variant:l==="left"?"default":"outline",size:"sm",onClick:()=>h("left"),className:"h-8 px-2",children:e.jsx(Nt,{className:"h-3 w-3"})}),e.jsx(R,{variant:l==="center"?"default":"outline",size:"sm",onClick:()=>h("center"),className:"h-8 px-2",children:e.jsx(wt,{className:"h-3 w-3"})}),e.jsx(R,{variant:l==="right"?"default":"outline",size:"sm",onClick:()=>h("right"),className:"h-8 px-2",children:e.jsx(Et,{className:"h-3 w-3"})}),e.jsx(R,{variant:l==="justify"?"default":"outline",size:"sm",onClick:()=>h("justify"),className:"h-8 px-2",children:e.jsx(Tt,{className:"h-3 w-3"})})]})]}):e.jsxs(V,{"data-testid":"font-style-panel",children:[e.jsx(ne,{className:"pb-3",children:e.jsx(ie,{className:"text-sm",children:"Text Formatting"})}),e.jsxs(G,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{className:"text-xs font-medium text-muted-foreground uppercase tracking-wide",children:"Font Family"}),e.jsxs(K,{value:t,onValueChange:o,children:[e.jsx(Y,{"data-testid":"select-font-family",children:e.jsx(X,{placeholder:"Select font..."})}),e.jsx(q,{children:E.map(p=>e.jsx(L,{value:p.value,children:e.jsx("span",{className:O(p.isDetected?"text-green-700":"text-gray-700"),children:p.label})},p.value))})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{className:"text-xs font-medium text-muted-foreground uppercase tracking-wide",children:"Size"}),e.jsx(z,{type:"number",value:a,onChange:p=>d(Number(p.target.value)),min:"8",max:"72",className:"text-sm","data-testid":"input-font-size"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{className:"text-xs font-medium text-muted-foreground uppercase tracking-wide",children:"Style"}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(R,{variant:n==="bold"?"default":"outline",size:"sm",onClick:()=>m(n==="bold"?"normal":"bold"),className:"flex-1 h-8 px-2","data-testid":"button-font-bold",children:e.jsx(Je,{className:"h-3 w-3"})}),e.jsx(R,{variant:i==="italic"?"default":"outline",size:"sm",onClick:()=>u(i==="italic"?"normal":"italic"),className:"flex-1 h-8 px-2","data-testid":"button-font-italic",children:e.jsx(Ze,{className:"h-3 w-3"})}),e.jsx(R,{variant:"outline",size:"sm",className:"flex-1 h-8 px-2","data-testid":"button-font-underline",children:e.jsx(Ya,{className:"h-3 w-3"})})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{className:"text-xs font-medium text-muted-foreground uppercase tracking-wide",children:"Text Color"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"color",value:r,onChange:p=>c(p.target.value),className:"w-10 h-8 border border-gray-300 rounded cursor-pointer","data-testid":"input-text-color"}),e.jsx(z,{type:"text",value:r,onChange:p=>c(p.target.value),className:"flex-1 text-sm font-mono","data-testid":"input-color-hex"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{className:"text-xs font-medium text-muted-foreground uppercase tracking-wide",children:"Alignment"}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(R,{variant:l==="left"?"default":"outline",size:"sm",onClick:()=>h("left"),className:"flex-1 h-8","data-testid":"button-align-left",children:e.jsx(Nt,{className:"h-3 w-3"})}),e.jsx(R,{variant:l==="center"?"default":"outline",size:"sm",onClick:()=>h("center"),className:"flex-1 h-8","data-testid":"button-align-center",children:e.jsx(wt,{className:"h-3 w-3"})}),e.jsx(R,{variant:l==="right"?"default":"outline",size:"sm",onClick:()=>h("right"),className:"flex-1 h-8","data-testid":"button-align-right",children:e.jsx(Et,{className:"h-3 w-3"})}),e.jsx(R,{variant:l==="justify"?"default":"outline",size:"sm",onClick:()=>h("justify"),className:"flex-1 h-8","data-testid":"button-align-justify",children:e.jsx(Tt,{className:"h-3 w-3"})})]})]})]})]})}const _i=Ma,Li=za,Mi=x.forwardRef(({className:s,inset:t,children:a,...n},i)=>e.jsxs(xs,{ref:i,className:O("flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",t&&"pl-8",s),...n,"data-oid":"hy-ug24",children:[a,e.jsx(Es,{className:"ml-auto","data-oid":"qn5j80p"})]}));Mi.displayName=xs.displayName;const zi=x.forwardRef(({className:s,...t},a)=>e.jsx(fs,{ref:a,className:O("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]",s),...t,"data-oid":"c:rpz1."}));zi.displayName=fs.displayName;const Vs=x.forwardRef(({className:s,sideOffset:t=4,...a},n)=>e.jsx(La,{"data-oid":"s8s3w9i",children:e.jsx(ps,{ref:n,sideOffset:t,className:O("z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]",s),...a,"data-oid":"c88x_g."})}));Vs.displayName=ps.displayName;const Ui=x.forwardRef(({className:s,inset:t,...a},n)=>e.jsx(gs,{ref:n,className:O("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",t&&"pl-8",s),...a,"data-oid":"b_d_4w_"}));Ui.displayName=gs.displayName;const Bi=x.forwardRef(({className:s,children:t,checked:a,...n},i)=>e.jsxs(ys,{ref:i,className:O("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),checked:a,...n,"data-oid":"5h:je5v",children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center","data-oid":"-hd:37e",children:e.jsx(js,{"data-oid":"z3r:9dd",children:e.jsx(De,{className:"h-4 w-4","data-oid":"ny6uffo"})})}),t]}));Bi.displayName=ys.displayName;const Wi=x.forwardRef(({className:s,children:t,...a},n)=>e.jsxs(bs,{ref:n,className:O("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...a,"data-oid":"jha5:8j",children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center","data-oid":"7rb8iv0",children:e.jsx(js,{"data-oid":"5lp4qay",children:e.jsx(qa,{className:"h-2 w-2 fill-current","data-oid":"0r.vd7-"})})}),t]}));Wi.displayName=bs.displayName;const $i=x.forwardRef(({className:s,inset:t,...a},n)=>e.jsx(vs,{ref:n,className:O("px-2 py-1.5 text-sm font-semibold",t&&"pl-8",s),...a,"data-oid":"naztww4"}));$i.displayName=vs.displayName;const Hi=x.forwardRef(({className:s,...t},a)=>e.jsx(Ns,{ref:a,className:O("-mx-1 my-1 h-px bg-muted",s),...t,"data-oid":"zhtdj8n"}));Hi.displayName=Ns.displayName;const Vi=({toolName:s,icon:t,label:a,isActive:n,onToolSelect:i,settings:r,onSettingChange:l,editorState:o})=>{const d=Ue[s],m=d==null?void 0:d.component,u=()=>{i(s)};return m?e.jsxs(_i,{children:[e.jsxs("div",{className:"flex items-center",children:[e.jsxs(R,{variant:n?"default":"outline",size:"sm",onClick:u,className:`flex items-center gap-1 rounded-r-none border-r-0 ${n?"":"bg-white shadow-[0_1px_2px_rgba(0,0,0,0.06)]"}`,children:[t,e.jsx("span",{className:"text-xs",children:a})]}),e.jsx(Li,{asChild:!0,children:e.jsx(R,{variant:n?"default":"outline",size:"sm",className:`px-1 rounded-l-none ${n?"":"bg-white shadow-[0_1px_2px_rgba(0,0,0,0.06)]"}`,children:e.jsx(ot,{className:"h-3 w-3"})})})]}),e.jsx(Vs,{align:"start",className:"z-50 w-auto min-w-[300px] p-3 bg-white/95 backdrop-blur-md border shadow-xl rounded-md",sideOffset:8,children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"text-sm font-medium text-muted-foreground border-b pb-2",children:[a," Settings"]}),W.createElement(m,{settings:r,onSettingChange:l,editorState:o,compact:!0})]})})]}):e.jsxs(R,{variant:n?"default":"outline",size:"sm",onClick:u,className:`flex items-center gap-1 ${n?"":"bg-white shadow-[0_1px_2px_rgba(0,0,0,0.06)]"}`,children:[t,e.jsx("span",{className:"text-xs",children:a})]})};function Gi({className:s="",showThumbnails:t=!1,onToggleThumbnails:a}){const{state:n,dispatch:i}=ee(),{currentPage:r,totalPages:l,scale:o,rotation:d}=n,[m,u]=x.useState(r.toString());x.useEffect(()=>{u(r.toString())},[r]);const c=()=>{r>1&&i({type:"SET_CURRENT_PAGE",payload:1})},h=()=>{r>1&&i({type:"SET_CURRENT_PAGE",payload:r-1})},v=()=>{r<l&&i({type:"SET_CURRENT_PAGE",payload:r+1})},w=()=>{r<l&&i({type:"SET_CURRENT_PAGE",payload:l})},N=T=>{u(T.target.value)},E=T=>{T.preventDefault();const f=parseInt(m,10);f>=1&&f<=l?i({type:"SET_CURRENT_PAGE",payload:f}):u(r.toString())},p=()=>{const T=parseInt(m,10);(isNaN(T)||T<1||T>l)&&u(r.toString())},C=T=>{const f=T==="in"?Math.min(o*1.25,3):T==="out"?Math.max(o*.8,.25):1;i({type:"SET_SCALE",payload:f})},g=()=>{const T=(d+90)%360;i({type:"SET_ROTATION",payload:T})},j=T=>{if(T.target!==document.activeElement)switch(T.key){case"ArrowLeft":T.shiftKey||(T.preventDefault(),h());break;case"ArrowRight":T.shiftKey||(T.preventDefault(),v());break;case"Home":T.preventDefault(),c();break;case"End":T.preventDefault(),w();break}};return x.useEffect(()=>(document.addEventListener("keydown",j),()=>document.removeEventListener("keydown",j)),[r,l]),l<=1?null:e.jsxs("div",{className:`flex items-center gap-2 ${s}`,children:[e.jsx(R,{variant:"ghost",size:"sm",onClick:c,disabled:r===1,title:"First Page (Home)",className:"h-8 w-8 p-0",children:e.jsx(Ka,{className:"h-4 w-4"})}),e.jsx(R,{variant:"ghost",size:"sm",onClick:h,disabled:r===1,title:"Previous Page (←)",className:"h-8 w-8 p-0",children:e.jsx(Xa,{className:"h-4 w-4"})}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("form",{onSubmit:E,className:"flex items-center",children:e.jsx(z,{type:"text",value:m,onChange:N,onBlur:p,className:"w-12 h-8 text-center text-sm border-gray-300",title:"Current Page"})}),e.jsxs("span",{className:"text-sm text-gray-500",children:["/ ",l]})]}),e.jsx(R,{variant:"ghost",size:"sm",onClick:v,disabled:r===l,title:"Next Page (→)",className:"h-8 w-8 p-0",children:e.jsx(Es,{className:"h-4 w-4"})}),e.jsx(R,{variant:"ghost",size:"sm",onClick:w,disabled:r===l,title:"Last Page (End)",className:"h-8 w-8 p-0",children:e.jsx(Ja,{className:"h-4 w-4"})}),e.jsx(Z,{orientation:"vertical",className:"h-6 mx-1"}),e.jsx(R,{variant:"ghost",size:"sm",onClick:()=>C("out"),title:"Zoom Out",className:"h-8 w-8 p-0",children:e.jsx(Za,{className:"h-4 w-4"})}),e.jsxs("span",{className:"text-sm font-medium min-w-12 text-center",children:[Math.round(o*100),"%"]}),e.jsx(R,{variant:"ghost",size:"sm",onClick:()=>C("in"),title:"Zoom In",className:"h-8 w-8 p-0",children:e.jsx(Qa,{className:"h-4 w-4"})}),e.jsx(R,{variant:"ghost",size:"sm",onClick:()=>C("fit"),title:"Fit to Page",className:"h-8 px-2 text-xs",children:"Fit"}),e.jsx(Z,{orientation:"vertical",className:"h-6 mx-1"}),e.jsx(R,{variant:"ghost",size:"sm",onClick:g,title:"Rotate 90°",className:"h-8 w-8 p-0",children:e.jsx(Ke,{className:"h-4 w-4"})}),a&&e.jsxs(e.Fragment,{children:[e.jsx(Z,{orientation:"vertical",className:"h-6 mx-1"}),e.jsx(R,{variant:t?"default":"ghost",size:"sm",onClick:a,title:"Toggle Thumbnails",className:"h-8 w-8 p-0",children:e.jsx(en,{className:"h-4 w-4"})})]})]})}function Yi({isOpen:s,onClose:t,className:a=""}){const{state:n,dispatch:i}=ee(),{pdfDocument:r,currentPage:l,totalPages:o}=n,[d,m]=x.useState({}),[u,c]=x.useState(new Set);x.useRef({});const h=x.useCallback(async w=>{if(!(!r||d[w]||u.has(w))){c(N=>new Set(N).add(w));try{const N=await r.getPage(w),E=N.getViewport({scale:.2}),p=document.createElement("canvas"),C=p.getContext("2d");if(!C)return;p.height=E.height,p.width=E.width,await N.render({canvasContext:C,viewport:E}).promise;const g=p.toDataURL("image/jpeg",.8);m(j=>({...j,[w]:g}))}catch(N){console.error(`Failed to generate thumbnail for page ${w}:`,N)}finally{c(N=>{const E=new Set(N);return E.delete(w),E})}}},[r,d,u]);x.useEffect(()=>{if(!s||!r)return;const w=[],N=3;for(let p=Math.max(1,l-N);p<=Math.min(o,l+N);p++)w.push(p);w.forEach((p,C)=>{setTimeout(()=>h(p),C*50)});const E=[];for(let p=1;p<=o;p++)w.includes(p)||E.push(p);E.forEach((p,C)=>{setTimeout(()=>h(p),(w.length+C)*100)})},[s,r,l,o,h]);const v=w=>{i({type:"SET_CURRENT_PAGE",payload:w}),t()};return x.useEffect(()=>{if(!s)return;const w=N=>{switch(N.key){case"Escape":N.preventDefault(),t();break;case"ArrowLeft":N.preventDefault(),l>1&&i({type:"SET_CURRENT_PAGE",payload:l-1});break;case"ArrowRight":N.preventDefault(),l<o&&i({type:"SET_CURRENT_PAGE",payload:l+1});break;case"Enter":N.preventDefault(),t();break}};return document.addEventListener("keydown",w),()=>document.removeEventListener("keydown",w)},[s,l,o,i,t]),!s||!r?null:e.jsx("div",{className:`fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center ${a}`,children:e.jsxs(V,{className:"w-11/12 h-5/6 max-w-6xl bg-white flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Page Thumbnails"}),e.jsx(R,{variant:"ghost",size:"sm",onClick:t,children:e.jsx(Be,{className:"h-4 w-4"})})]}),e.jsx("div",{className:"flex-1 overflow-auto p-4",children:e.jsx("div",{className:"grid grid-cols-4 md:grid-cols-6 lg:grid-cols-8 gap-4",children:Array.from({length:o},(w,N)=>{const E=N+1,p=E===l,C=d[E],g=u.has(E);return e.jsxs("div",{className:`relative cursor-pointer transition-all duration-200 ${p?"ring-2 ring-blue-500 shadow-lg transform scale-105":"hover:shadow-md hover:scale-102"}`,onClick:()=>v(E),children:[e.jsx(V,{className:"aspect-[3/4] overflow-hidden",children:C?e.jsx("img",{src:C,alt:`Page ${E}`,className:"w-full h-full object-contain bg-white"}):g?e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-100",children:e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-500"})}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-100",children:e.jsx("span",{className:"text-gray-400 text-sm",children:"Loading..."})})}),e.jsx("div",{className:`absolute bottom-1 left-1/2 transform -translate-x-1/2 px-2 py-1 rounded text-xs font-medium ${p?"bg-blue-500 text-white":"bg-black bg-opacity-70 text-white"}`,children:E}),p&&e.jsx("div",{className:"absolute top-1 right-1 w-3 h-3 bg-blue-500 rounded-full"})]},E)})})}),e.jsx("div",{className:"p-4 border-t bg-gray-50 text-sm text-gray-600",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Click a thumbnail to navigate to that page"}),e.jsx("span",{children:"Press ESC to close • Use arrow keys to navigate"})]})})]})})}class ye{static getInstance(){return ye.instance||(ye.instance=new ye),ye.instance}async extractTextRegions(t,a,n={}){const i=await t.getPage(a),r=await i.getTextContent(),l=i.getViewport({scale:1}),o=[];return r.items.forEach((d,m)=>{if(!d.str||d.str.trim()==="")return;const u=d.transform,c=Math.abs(u[0]),h=u[4],v=l.height-u[5],w=r.styles[d.fontName],N=this.extractFontProperties(d.fontName,w),E={id:`region-${a}-${m}`,page:a,x:h,y:v-c,width:d.width,height:d.height||c,text:d.str,fontName:d.fontName,fontSize:c,fontWeight:N.weight,fontStyle:N.style,color:"#000000",rotation:this.calculateRotation(u),isEditing:!1};o.push(E)}),n.mergeClosestItems?this.mergeAdjacentRegions(o):o}extractFontProperties(t,a){var o;let n="normal",i="normal";const r=t.toLowerCase(),l=((o=a==null?void 0:a.fontFamily)==null?void 0:o.toLowerCase())||"";return(r.includes("bold")||l.includes("bold")||r.includes("heavy")||l.includes("heavy"))&&(n="bold"),(r.includes("italic")||l.includes("italic")||r.includes("oblique")||l.includes("oblique"))&&(i="italic"),{weight:n,style:i}}calculateRotation(t){return Math.atan2(t[1],t[0])*180/Math.PI}mergeAdjacentRegions(t){const a=[],n=new Set;for(const i of t){if(n.has(i.id))continue;const r=t.filter(l=>!n.has(l.id)&&l.id!==i.id&&this.areRegionsAdjacent(i,l));if(r.length>0){const l=this.combineRegions([i,...r]);a.push(l),n.add(i.id),r.forEach(o=>n.add(o.id))}else a.push(i),n.add(i.id)}return a}areRegionsAdjacent(t,a){const n=Math.max(t.fontSize*.3,5);if(Math.abs(t.rotation-a.rotation)>5)return!1;const r=Math.abs(t.y-a.y)<=n,l=Math.abs(t.x+t.width-a.x)<=n||Math.abs(a.x+a.width-t.x)<=n,o=t.fontName===a.fontName&&Math.abs(t.fontSize-a.fontSize)<=1&&t.fontWeight===a.fontWeight&&t.fontStyle===a.fontStyle;return r&&l&&o}combineRegions(t){const a=t.sort((r,l)=>r.x-l.x),n=a[0],i=a[a.length-1];return{...n,id:`merged-${n.page}-${Date.now()}`,text:a.map(r=>r.text).join(" "),width:i.x+i.width-n.x,height:Math.max(...a.map(r=>r.height))}}convertPDFToScreenCoordinates(t,a,n,i){const r=t.x*a,l=t.y*a,o=t.width*a,d=t.height*a;let m=r,u=l,c=o,h=d;return n===90?(m=l,u=i.height-r-o,c=d,h=o):n===180?(m=i.width-r-o,u=i.height-l-d):n===270&&(m=i.width-l-d,u=r,c=d,h=o),{x:m+i.left,y:u+i.top,width:c,height:h}}async searchText(t,a,n){const i=n?[n]:Array.from({length:t.numPages},(l,o)=>o+1),r=[];for(const l of i){const d=(await this.extractTextRegions(t,l)).filter(m=>m.text.toLowerCase().includes(a.toLowerCase()));r.push(...d)}return r}getTextRegionAt(t,a,n){return t.find(i=>a>=i.x&&a<=i.x+i.width&&n>=i.y&&n<=i.y+i.height)||null}detectTextBoundaries(t){return t.map(a=>{const n=Math.max(a.height,a.fontSize*1.2),i=a.y-(n-a.height)/2;return{...a,y:i,height:n,x:a.x-2,width:a.width+4}})}normalizeRotatedText(t){return t.map(a=>{if(Math.abs(a.rotation)<1)return a;const n=a.rotation*Math.PI/180,i=Math.cos(n),r=Math.sin(n),o=[{x:0,y:0},{x:a.width,y:0},{x:a.width,y:a.height},{x:0,y:a.height}].map(h=>({x:a.x+h.x*i-h.y*r,y:a.y+h.x*r+h.y*i})),d=Math.min(...o.map(h=>h.x)),m=Math.max(...o.map(h=>h.x)),u=Math.min(...o.map(h=>h.y)),c=Math.max(...o.map(h=>h.y));return{...a,x:d,y:u,width:m-d,height:c-u}})}mergeTextLines(t){const a=[],n=new Set;for(const i of t){if(n.has(i.id))continue;const r=[i];n.add(i.id);for(const l of t)n.has(l.id)||this.areOnSameLine(i,l)&&(r.push(l),n.add(l.id));a.push(r)}return a.map(i=>{if(i.length===1)return i[0];i.sort((o,d)=>o.x-d.x);const r=i[0],l=i[i.length-1];return{...r,id:`line-${r.page}-${Date.now()}`,text:i.map(o=>o.text).join(" "),width:l.x+l.width-r.x,height:Math.max(...i.map(o=>o.height))}})}areOnSameLine(t,a){const n=Math.min(t.fontSize,a.fontSize)*.5;return Math.min(t.y+t.height,a.y+a.height)-Math.max(t.y,a.y)>n&&Math.abs(t.rotation-a.rotation)<=5&&t.fontName===a.fontName}async extractTextWithLayout(t,a){let n=await this.extractTextRegions(t,a,{mergeClosestItems:!1,normalizeWhitespace:!0});return n=this.normalizeRotatedText(n),n=this.detectTextBoundaries(n),n=this.mergeTextLines(n),n}}const qi=ye.getInstance(),Gs=()=>{const{state:s}=ee(),t=x.useRef(null),a=x.useRef({renderTime:0,memoryUsage:0,elementCount:0}),n=x.useCallback(()=>{t.current&&(t.current.cancel(),t.current=null)},[]),i=x.useCallback(()=>{typeof window<"u"&&"gc"in window&&window.gc(),document.querySelectorAll("canvas").forEach(c=>{const h=c.getContext("2d");h&&h.clearRect(0,0,c.width,c.height)}),document.querySelectorAll('img[src^="blob:"]').forEach(c=>{const h=c.src;h.startsWith("blob:")&&URL.revokeObjectURL(h)})},[]),r=x.useCallback((()=>{let m;return(u,c=16)=>{clearTimeout(m),m=setTimeout(u,c)}})(),[]),l=x.useCallback(()=>{var h;const m=performance.now(),u=Object.values(s.annotations).flat().length+Object.values(s.textElements).flat().length+Object.values(s.imageElements).flat().length+Object.values(s.whiteoutBlocks).flat().length+Object.values(s.freeformElements).flat().length+Object.values(s.formFields).flat().length,c=u*1024+(((h=s.originalPdfData)==null?void 0:h.length)||0);return a.current={renderTime:performance.now()-m,memoryUsage:c,elementCount:u},a.current},[s]),o=x.useCallback(m=>{const u=m.getContext("2d");return u?(u.imageSmoothingEnabled=!0,u.imageSmoothingQuality="high",()=>{const h=m.getBoundingClientRect();h.width===0||h.height===0||requestAnimationFrame(()=>{})}):void 0},[]),d=x.useCallback(m=>{const u=s.currentPage;return Math.abs(m-u)<=2},[s.currentPage]);return x.useEffect(()=>{const u=setInterval(()=>{const c=l();c.memoryUsage>104857600&&(console.warn("High memory usage detected:",c.memoryUsage/1048576,"MB"),i())},3e4);return()=>clearInterval(u)},[l,i]),x.useEffect(()=>()=>{n(),i()},[n,i]),{cancelRenderTask:n,cleanupMemory:i,debouncedRender:r,calculateMetrics:l,optimizeCanvasRendering:o,shouldRenderPage:d,performanceMetrics:a.current,setRenderTask:m=>{t.current=m}}},Ki=()=>{const{state:s}=ee(),{calculateMetrics:t,cleanupMemory:a}=Gs(),[n,i]=x.useState({totalElements:0,memoryUsage:0,renderTime:0,pageCount:0,isHighUsage:!1}),[r,l]=x.useState(!1),o=x.useCallback(()=>{const u=t(),c=Object.values(s.annotations).flat().length+Object.values(s.textElements).flat().length+Object.values(s.imageElements).flat().length+Object.values(s.whiteoutBlocks).flat().length+Object.values(s.freeformElements).flat().length+Object.values(s.formFields).flat().length,h=u.memoryUsage,v=h>50*1024*1024;i({totalElements:c,memoryUsage:h,renderTime:u.renderTime,pageCount:s.totalPages,isHighUsage:v})},[t,s]);x.useEffect(()=>{o();const u=setInterval(o,5e3);return()=>clearInterval(u)},[o]),x.useEffect(()=>{n.isHighUsage&&!r&&l(!0)},[n.isHighUsage,r]);const d=u=>u<1024?`${u} B`:u<1024*1024?`${(u/1024).toFixed(1)} KB`:`${(u/(1024*1024)).toFixed(1)} MB`,m=x.useCallback(()=>{a(),o()},[a,o]);return r?e.jsxs(V,{className:"fixed bottom-4 right-4 w-80 z-50 shadow-lg",children:[e.jsx(ne,{className:"pb-2",children:e.jsxs(ie,{className:"text-sm flex items-center justify-between",children:[e.jsxs("span",{className:"flex items-center",children:[e.jsx(he,{className:"h-4 w-4 mr-2"}),"Performance Monitor"]}),e.jsx(R,{variant:"ghost",size:"sm",onClick:()=>l(!1),className:"h-6 w-6 p-0",children:"×"})]})}),e.jsxs(G,{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-xs mb-1",children:[e.jsx("span",{children:"Memory Usage"}),e.jsx("span",{className:n.isHighUsage?"text-red-600":"text-green-600",children:d(n.memoryUsage)})]}),e.jsx(Ce,{value:Math.min(n.memoryUsage/(100*1024*1024)*100,100),className:"h-2"}),n.isHighUsage&&e.jsxs("div",{className:"flex items-center text-xs text-red-600 mt-1",children:[e.jsx(qe,{className:"h-3 w-3 mr-1"}),"High memory usage detected"]})]}),e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsx("span",{children:"Total Elements:"}),e.jsx("span",{children:n.totalElements})]}),e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsx("span",{children:"PDF Pages:"}),e.jsx("span",{children:n.pageCount})]}),e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsx("span",{children:"Last Render:"}),e.jsxs("span",{children:[n.renderTime.toFixed(1),"ms"]})]}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsxs(R,{variant:"outline",size:"sm",onClick:m,className:"flex-1 text-xs",children:[e.jsx(Se,{className:"h-3 w-3 mr-1"}),"Cleanup"]}),e.jsxs(R,{variant:"outline",size:"sm",onClick:o,className:"flex-1 text-xs",children:[e.jsx(he,{className:"h-3 w-3 mr-1"}),"Refresh"]})]}),n.isHighUsage&&e.jsxs("div",{className:"text-xs text-gray-600 bg-yellow-50 p-2 rounded",children:[e.jsx("strong",{children:"Tips:"}),e.jsxs("ul",{className:"mt-1 space-y-1",children:[e.jsx("li",{children:"• Reduce number of elements per page"}),e.jsx("li",{children:"• Use smaller image sizes"}),e.jsx("li",{children:"• Clear unused annotations"})]})]})]})]}):e.jsxs(R,{variant:"outline",size:"sm",onClick:()=>l(!0),className:"fixed bottom-4 right-4 z-50",children:[e.jsx(he,{className:"h-4 w-4 mr-1"}),"Performance"]})};function Xi(){var xt,ft,pt,gt,yt;const{state:s,dispatch:t,canvasRef:a,fileInputRef:n,loadPDF:i,renderPage:r,savePDF:l}=ee(),{toast:o}=wi();Gs();const[d,m]=x.useState(!1),[u,c]=x.useState(0),[h,v]=x.useState(null),[w,N]=x.useState(null),E=x.useRef(null),[p,C]=x.useState({whiteout:!0,annotations:!0,text:!0,images:!0,freeform:!0,textExtraction:!0}),[g,j]=x.useState(!1),[T,f]=x.useState({fontFamily:"Arial",fontSize:14,fontWeight:"normal",fontStyle:"normal",textColor:"#000000",textAlign:"left"}),{currentPage:b,totalPages:A,pdfDocument:F,currentTool:k,toolSettings:y,scale:D,rotation:S,historyIndex:_,history:$,inlineEditingRegion:B,fileName:J,extractedTextRegions:te,detectedFonts:U,annotations:se,textElements:ae,imageElements:oe,whiteoutBlocks:ue,freeformElements:me,selectedElementId:le,selectedElementIds:Ne}=s,ut=W.useMemo(()=>te[b]||[],[te,b]),mt=W.useMemo(()=>Object.values(U).flat(),[U]),qs=W.useMemo(()=>se[b]||[],[se,b]),Ks=W.useMemo(()=>ae[b]||[],[ae,b]),Xs=W.useMemo(()=>oe[b]||[],[oe,b]),Js=W.useMemo(()=>ue[b]||[],[ue,b]),$e=W.useMemo(()=>me[b]||[],[me,b]);x.useEffect(()=>{F&&r()},[F,b,D,S,r]),x.useEffect(()=>{F&&ut.length===0&&k==="inlineEdit"&&ea()},[F,b,k]);const Pe=x.useCallback(P=>{const I=a.current;if(!I)return{x:0,y:0};const H=I.getBoundingClientRect();return{x:(P.clientX-H.left)/D,y:(P.clientY-H.top)/D}},[D,a]),Zs=x.useCallback(async P=>{var H;const I=(H=P.target.files)==null?void 0:H[0];I&&I.type==="application/pdf"&&(await i(I),o({title:"PDF Loaded",description:`Successfully loaded ${I.name}`})),P.target&&(P.target.value="")},[i,o]),Qs=x.useCallback(async P=>{var ce;const I=(ce=P.target.files)==null?void 0:ce[0];if(!I)return;const H=new FileReader;H.onload=He=>{var bt;const jt=(bt=He.target)==null?void 0:bt.result,de=new Image;de.onload=()=>{const ua={id:`image-${Date.now()}`,page:b,src:jt,x:100,y:100,width:de.width>200?200:de.width,height:de.width>200?de.height*200/de.width:de.height,rotation:0,opacity:1};t({type:"ADD_IMAGE_ELEMENT",payload:{page:b,element:ua}}),t({type:"SAVE_TO_HISTORY"})},de.src=jt},H.readAsDataURL(I),P.target.value=""},[b,t]),ea=x.useCallback(async()=>{if(F){m(!0),c(30);try{const P=await qi.extractTextRegions(F,b);c(60);const I=await at.analyzePageFonts(F,b);t({type:"SET_EXTRACTED_TEXT_REGIONS",payload:{page:b,regions:P}}),t({type:"SET_DETECTED_FONTS",payload:{page:b,fonts:I.fonts}}),c(100),o({title:"Page Analyzed",description:`Found ${I.fonts.length} fonts and ${P.length} text regions.`})}catch(P){console.error("Analysis failed:",P),o({title:"Analysis Failed",description:"Could not analyze this page.",variant:"destructive"})}finally{m(!1)}}},[F,b,t,o]),ta=P=>{t({type:"SET_CURRENT_TOOL",payload:P})},sa=x.useCallback(P=>{if(P.target.closest(".react-rnd, .inline-text-editor, .text-region-overlay"))return;if(k==="image"&&E.current){E.current.click();return}const I=Pe(P);N(I);const H=y[k];if(k==="select"){t({type:"CLEAR_SELECTION"});return}if(["rectangle","circle","highlight","whiteout","line","freeform"].includes(k)){const ce={type:k,page:b,x:I.x,y:I.y,...H,width:0,height:0,points:k==="freeform"?[{x:I.x,y:I.y}]:void 0,strokeColor:k==="freeform"?H.color:H.strokeColor,strokeWidth:k==="freeform"?H.brushSize:H.strokeWidth};v(ce)}},[b,k,y,D,Pe,t]),aa=x.useCallback(P=>{if(!w)return;const I=Pe(P);k==="freeform"&&h?v(H=>({...H,points:[...(H==null?void 0:H.points)||[],{x:I.x,y:I.y}]})):h&&v({...h,x:Math.min(w.x,I.x),y:Math.min(w.y,I.y),width:Math.abs(w.x-I.x),height:Math.abs(w.y-I.y)})},[w,h,k,Pe]),na=x.useCallback(()=>{var P;if(k==="text"&&w&&(!h||h.width===0&&h.height===0)){const I={id:`text-${Date.now()}`,page:b,text:"New Text",x:w.x,y:w.y,width:200,height:20,...y.text,bold:!1,italic:!1,underline:!1,rotation:0,lineHeight:1.2,textAlign:"left",color:"#000000",fontFamily:"Arial",fontSize:16};t({type:"ADD_TEXT_ELEMENT",payload:{page:b,element:I}}),t({type:"SAVE_TO_HISTORY"})}else if(h&&w){const I={...h,id:`${h.type}-${Date.now()}`};((I.width||0)>2||(I.height||0)>2||(((P=I.points)==null?void 0:P.length)||0)>1)&&(I.type==="whiteout"?t({type:"ADD_WHITEOUT_BLOCK",payload:{page:b,block:I}}):t({type:"ADD_ANNOTATION",payload:{page:b,annotation:I}}),t({type:"SAVE_TO_HISTORY"}))}v(null),N(null)},[h,w,t,b,k,y]),ia=P=>{var I;k==="inlineEdit"&&(t({type:"SET_INLINE_EDITING_REGION",payload:P}),f({fontFamily:((I=P.originalFontInfo)==null?void 0:I.fontFamily)||"Arial",fontSize:P.fontSize,fontWeight:P.fontWeight,fontStyle:P.fontStyle,textColor:P.color,textAlign:"left"}))},ra=P=>{if(!B)return;const I={id:`whiteout-for-${B.id}`,page:b,x:B.x,y:B.y,width:B.width,height:B.height,color:"#FFFFFF"},H={id:`text-from-region-${B.id}`,page:b,text:P,x:B.x,y:B.y,width:B.width,height:B.height,fontFamily:T.fontFamily,fontSize:T.fontSize,color:T.textColor,bold:T.fontWeight==="bold",italic:T.fontStyle==="italic",underline:!1,textAlign:T.textAlign,lineHeight:1.2,rotation:B.rotation};t({type:"ADD_WHITEOUT_BLOCK",payload:{page:b,block:I}}),t({type:"ADD_TEXT_ELEMENT",payload:{page:b,element:H}}),t({type:"SET_INLINE_EDITING_REGION",payload:null}),t({type:"SAVE_TO_HISTORY"}),o({title:"Text Updated",description:"Original text has been covered and new text added."})},la=()=>{t({type:"SET_INLINE_EDITING_REGION",payload:null})},oa=x.useCallback(P=>{const I=$e,H=P.filter(ce=>!I.find(He=>He.id===ce.id));H.forEach(ce=>{t({type:"ADD_FREEFORM_ELEMENT",payload:{page:b,element:ce}})}),H.length>0&&t({type:"SAVE_TO_HISTORY"})},[$e,b,t]),ca=x.useCallback((P,I)=>{k==="select"&&(I.stopPropagation(),I.ctrlKey||I.metaKey?t({type:"ADD_TO_SELECTION",payload:{id:P,type:"freeform"}}):t({type:"SET_SELECTED_ELEMENT",payload:{id:P,type:"freeform"}}))},[k,t]),da=P=>{C(I=>({...I,[P]:!I[P]}))},ha=()=>{j(P=>!P)};return(xt=Ue[k])==null||xt.component,e.jsx(Ii,{children:e.jsxs("div",{className:"h-full w-full flex flex-col bg-gray-50",children:[e.jsxs("header",{className:"bg-white border-b px-4 py-3 flex items-center justify-between flex-shrink-0 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(tt,{className:"h-5 w-5 text-primary"}),e.jsx("h1",{className:"text-lg font-semibold",children:"PDF4EVER"}),e.jsx(Z,{orientation:"vertical",className:"h-6"}),e.jsxs(R,{size:"sm",onClick:()=>{var P;return(P=n.current)==null?void 0:P.click()},children:[e.jsx(be,{className:"h-4 w-4 mr-2"})," Upload PDF"]}),e.jsx("input",{ref:n,type:"file",accept:".pdf",onChange:Zs,className:"hidden"}),e.jsx("input",{ref:E,type:"file",accept:"image/png, image/jpeg",onChange:Qs,className:"hidden"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[J&&e.jsx("div",{className:"text-sm text-muted-foreground",children:J}),F&&e.jsx(Gi,{showThumbnails:g,onToggleThumbnails:ha})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(R,{variant:"ghost",size:"sm",onClick:()=>t({type:"UNDO"}),disabled:_<=0,title:"Undo (Ctrl+Z)",children:[" ",e.jsx(tn,{className:"h-4 w-4"})," "]}),e.jsxs(R,{variant:"ghost",size:"sm",onClick:()=>t({type:"REDO"}),disabled:_>=$.length-1,title:"Redo (Ctrl+Y)",children:[" ",e.jsx(sn,{className:"h-4 w-4"})," "]}),e.jsx(Z,{orientation:"vertical",className:"h-6 mx-2"}),e.jsxs(R,{onClick:l,disabled:!F,children:[" ",e.jsx(an,{className:"h-4 w-4 mr-2"})," Save PDF "]})]})]}),e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[F&&e.jsx("div",{className:"bg-white border-b px-4 py-2 flex-shrink-0 overflow-x-auto",children:e.jsxs("div",{className:"flex items-center gap-4 min-w-fit",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 mr-2 whitespace-nowrap",children:"Tools:"}),e.jsx("div",{className:"flex items-center gap-1 flex-wrap",children:Object.values(Ue).map(P=>e.jsx(Vi,{toolName:P.name,icon:P.icon,label:P.label,isActive:k===P.name,onToolSelect:ta,settings:y[P.name]||{},onSettingChange:(I,H)=>t({type:"UPDATE_TOOL_SETTING",payload:{toolId:P.name,key:I,value:H}}),editorState:s},P.name))})]}),k==="inlineEdit"&&e.jsxs(e.Fragment,{children:[e.jsx(Z,{orientation:"vertical",className:"h-6 flex-shrink-0"}),e.jsx("div",{className:"text-xs text-muted-foreground whitespace-nowrap",children:"Inline Edit Mode - Click text regions to edit"})]}),e.jsx(Z,{orientation:"vertical",className:"h-6 flex-shrink-0"}),e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[e.jsx("span",{className:"text-xs text-gray-600 whitespace-nowrap",children:"Layers:"}),e.jsx("div",{className:"flex items-center gap-1 flex-wrap",children:Object.entries(p).map(([P,I])=>e.jsx(R,{variant:I?"default":"outline",size:"sm",className:"h-6 px-2 text-xs capitalize whitespace-nowrap",onClick:()=>da(P),title:`Toggle ${P} layer`,children:P},P))})]})]})}),F&&k==="inlineEdit"&&e.jsx("div",{className:"bg-gray-50 border-b px-4 py-2 flex-shrink-0 overflow-x-auto",children:e.jsxs("div",{className:"flex items-center gap-4 min-w-fit",children:[e.jsx("span",{className:"text-xs font-medium text-gray-700 whitespace-nowrap",children:"Text Formatting:"}),e.jsx(Oi,{selectedFont:T.fontFamily,fontSize:T.fontSize,fontWeight:T.fontWeight,fontStyle:T.fontStyle,textColor:T.textColor,textAlign:T.textAlign,onFontChange:P=>f(I=>({...I,fontFamily:P})),onFontSizeChange:P=>f(I=>({...I,fontSize:P})),onFontWeightChange:P=>f(I=>({...I,fontWeight:P})),onFontStyleChange:P=>f(I=>({...I,fontStyle:P})),onTextColorChange:P=>f(I=>({...I,textColor:P})),onTextAlignChange:P=>f(I=>({...I,textAlign:P})),detectedFonts:mt,horizontal:!0})]})}),e.jsx("main",{className:"flex-1 flex justify-center overflow-auto p-8 bg-gray-100",onMouseUp:na,children:F?e.jsxs("div",{className:"relative shadow-2xl my-auto",onMouseDown:sa,onMouseMove:aa,children:[e.jsx("canvas",{ref:a,className:"block"}),e.jsxs("div",{className:"absolute inset-0 pointer-events-none",children:[p.whiteout&&e.jsx(ki,{whiteoutBlocks:Js,selectedElementId:le,selectedElementIds:Ne,scale:D,page:b,dispatch:t,currentTool:k}),p.annotations&&e.jsx(Fi,{annotations:qs,selectedElementId:le,selectedElementIds:Ne,scale:D,page:b,dispatch:t,currentTool:k}),h&&e.jsx("div",{className:"absolute pointer-events-none",style:{left:h.x*D,top:h.y*D,width:h.width*D,height:h.height*D,border:"2px dashed #3B82F6",backgroundColor:"#3B82F630",borderRadius:h.type==="circle"?"50%":`${h.cornerRadius||0}px`}}),p.text&&e.jsx(Ti,{textElements:Ks,selectedElementId:le,selectedElementIds:Ne,scale:D,page:b,dispatch:t,currentTool:k}),p.images&&e.jsx(Ci,{imageElements:Xs,selectedElementId:le,selectedElementIds:Ne,scale:D,page:b,dispatch:t,currentTool:k}),p.freeform&&e.jsx(Pi,{elements:$e,currentPage:b,scale:D,isDrawing:k==="freeform",brushSettings:{color:((ft=y.freeform)==null?void 0:ft.color)||"#000000",opacity:((pt=y.freeform)==null?void 0:pt.opacity)||1,brushSize:((gt=y.freeform)==null?void 0:gt.brushSize)||3,smoothing:((yt=y.freeform)==null?void 0:yt.smoothing)||"medium"},selectedElementIds:Ne,onElementsChange:oa,onElementSelect:ca}),p.textExtraction&&e.jsx(Ei,{page:b,textRegions:ut,scale:D,rotation:S,onRegionClick:ia,showRegions:k==="inlineEdit"})]}),B&&e.jsx(Ai,{textRegion:B,onSave:ra,onCancel:la,scale:D,rotation:S,detectedFonts:mt})]}):e.jsx(V,{className:"w-full max-w-md",children:e.jsxs(G,{className:"pt-6 text-center",children:[e.jsx(tt,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{children:"No PDF Loaded"}),e.jsx("p",{className:"text-muted-foreground",children:"Upload a PDF file to get started."}),e.jsxs(R,{className:"mt-4",onClick:()=>{var P;return(P=n.current)==null?void 0:P.click()},children:[e.jsx(be,{className:"h-4 w-4 mr-2"}),"Upload PDF"]})]})})}),e.jsx(Ki,{}),e.jsx(Yi,{isOpen:g,onClose:()=>j(!1)})]})]})})}function Ji(){return e.jsxs(e.Fragment,{children:[e.jsxs("section",{className:"container mx-auto px-4 py-16",children:[e.jsx("h2",{className:"text-3xl font-bold text-center mb-12",children:"Why Choose PDF4EVER?"}),e.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-4 gap-8",children:[e.jsx(V,{className:"text-center p-6",children:e.jsxs(G,{className:"pt-6",children:[e.jsx(Me,{className:"h-12 w-12 text-blue-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Complete Privacy"}),e.jsx("p",{className:"text-muted-foreground",children:"All processing happens locally. We never store your files on our servers."})]})}),e.jsx(V,{className:"text-center p-6",children:e.jsxs(G,{className:"pt-6",children:[e.jsx(nn,{className:"h-12 w-12 text-purple-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Data Respect"}),e.jsx("p",{className:"text-muted-foreground",children:"Your personal information is never shared. We protect your privacy above all."})]})}),e.jsx(V,{className:"text-center p-6",children:e.jsxs(G,{className:"pt-6",children:[e.jsx(ws,{className:"h-12 w-12 text-orange-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Professional Tools"}),e.jsx("p",{className:"text-muted-foreground",children:"Advanced editing, annotations, signatures, OCR, and form filling capabilities."})]})}),e.jsx(V,{className:"text-center p-6",children:e.jsxs(G,{className:"pt-6",children:[e.jsx(he,{className:"h-12 w-12 text-green-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Lightning Fast"}),e.jsx("p",{className:"text-muted-foreground",children:"No uploads, no waiting. Start editing immediately in your browser."})]})})]})]}),e.jsx("section",{className:"bg-primary/90 py-16",children:e.jsxs("div",{className:"container mx-auto px-4 text-center",children:[e.jsx("h2",{className:"text-3xl font-bold mb-4 text-primary-foreground",children:"Ready to Own Your PDF Editor?"}),e.jsx("p",{className:"text-xl mb-8 text-primary-foreground/80",children:"Pay once, own forever. Get lifetime access with all future updates included."}),e.jsx(R,{size:"lg",variant:"secondary",asChild:!0,children:e.jsx("a",{href:"/pricing",children:"View Lifetime Deal"})})]})})]})}function Zi(){return e.jsxs("div",{className:"min-h-screen bg-background flex flex-col items-center",children:[e.jsx("header",{className:"w-full border-b bg-background sticky top-0 z-50",children:e.jsxs("div",{className:"container mx-auto px-4 py-3 flex items-center justify-between",children:[e.jsxs(_t,{to:"/",className:"flex items-center space-x-3",children:[e.jsx("img",{src:"/70x70logo.png",alt:"PDF4EVER Logo",className:"h-8 w-8"}),e.jsxs("span",{className:"text-xl font-bold",children:[e.jsx("span",{className:"text-blue-600",children:"PDF4"}),e.jsx("span",{className:"text-orange-500",children:"EVER"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(zn,{}),e.jsx(R,{variant:"ghost",size:"sm",children:"Sign In"}),e.jsx(R,{size:"sm",children:"Sign Up"})]})]})}),e.jsx("div",{className:"w-full border-b shadow-inner-lg bg-gray-100 dark:bg-gray-900",children:e.jsx("div",{className:"container mx-auto",children:e.jsx("div",{className:"h-[calc(100vh-61px)] max-h-[800px]",children:e.jsx(ti,{children:e.jsx(gi,{children:e.jsx(Xi,{})})})})})}),e.jsx("div",{className:"w-full",children:e.jsx(Ji,{})}),e.jsx("footer",{className:"w-full bg-gray-900 text-white py-8",children:e.jsx("div",{className:"container mx-auto px-4 text-center",children:e.jsx("p",{className:"text-gray-400",children:"© 2025 PDF4EVER. Privacy-first PDF editing for everyone."})})})]})}function Qi(){const[s,t]=x.useState(!1),a=()=>{t(!0),console.log("Redirecting to checkout...")};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-background to-secondary/20",children:[e.jsx("header",{className:"absolute top-0 left-0 p-4",children:e.jsx(R,{asChild:!0,variant:"outline",children:e.jsxs(_t,{to:"/",children:[e.jsx(dt,{className:"h-4 w-4 mr-2"}),"Back to Home"]})})}),e.jsxs("div",{className:"container mx-auto px-4 py-16",children:[e.jsxs("div",{className:"text-center mb-16",children:[e.jsxs("h1",{className:"text-4xl md:text-6xl font-bold mb-4",children:["PDF4EVER ",e.jsx("span",{className:"text-primary",children:"Lifetime Access"})]}),e.jsx("p",{className:"text-xl text-muted-foreground max-w-2xl mx-auto",children:"Pay once, own forever. Get lifetime access to the most advanced PDF editor with all future updates included."})]}),e.jsx("div",{className:"max-w-lg mx-auto",children:e.jsxs(V,{className:"border-2 border-primary shadow-xl",children:[e.jsxs(ne,{className:"text-center pb-8",children:[e.jsx("div",{className:"w-16 h-16 bg-primary/10 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(tt,{className:"w-8 h-8 text-primary"})}),e.jsx(ie,{className:"text-2xl",children:"Lifetime Access"}),e.jsxs("div",{className:"flex items-center justify-center gap-2 mt-4",children:[e.jsx("span",{className:"text-4xl font-bold",children:"$50"}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"text-sm text-muted-foreground line-through",children:"$197"}),e.jsx(Fe,{variant:"destructive",children:"75% OFF"})]})]})]}),e.jsxs(G,{children:[e.jsx("ul",{className:"space-y-3 mb-8",children:["Complete PDF Editor Suite","Text Editing & Formatting","Digital Signatures","Form Filling & OCR","Document Management","Unlimited PDF Processing","All Future Updates","Priority Support","Commercial License","No Monthly Fees Ever"].map(n=>e.jsxs("li",{className:"flex items-center gap-3",children:[e.jsx(De,{className:"w-5 h-5 text-green-500 flex-shrink-0"}),e.jsx("span",{children:n})]},n))}),e.jsxs(R,{onClick:a,disabled:s,className:"w-full h-12 text-lg",children:[e.jsx(he,{className:"w-5 h-5 mr-2"}),s?"Processing...":"Get Lifetime Access"]}),e.jsx("p",{className:"text-sm text-muted-foreground text-center mt-4",children:"Secure payment powered by Stripe."})]})]})})]})]})}function er(){return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx("header",{className:"border-b bg-background/95 backdrop-blur sticky top-0 z-50",children:e.jsxs("div",{className:"container mx-auto px-4 py-4 flex items-center justify-between",children:[e.jsx(ze,{href:"/",children:e.jsxs("div",{className:"flex items-center space-x-3 cursor-pointer",children:[e.jsx("img",{src:"/70x70logo.png",alt:"PDF4EVER Logo",className:"h-10 w-10"}),e.jsx("span",{className:"text-2xl font-bold bg-gradient-to-r from-blue-600 to-orange-500 bg-clip-text text-transparent",children:"PDF4EVER"})]})}),e.jsx(ze,{href:"/",children:e.jsxs(R,{variant:"ghost",children:[e.jsx(dt,{className:"h-4 w-4 mr-2"}),"Back to Home"]})})]})}),e.jsxs("div",{className:"container mx-auto px-4 py-12 max-w-4xl",children:[e.jsx("h1",{className:"text-4xl font-bold mb-8",children:"Privacy Policy"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-8",children:"Effective Date: December 6, 2024"}),e.jsxs("div",{className:"prose prose-lg dark:prose-invert max-w-none space-y-8",children:[e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"1. Introduction"}),e.jsx("p",{children:'PDF4EVER ("we," "our," or "us") is committed to protecting your privacy and ensuring the security of your personal information. This Privacy Policy explains how we collect, use, disclose, and safeguard your information when you use our PDF editing web application and services (the "Service"). This policy complies with applicable federal laws and the laws of the State of Missouri.'})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"2. Our Privacy-First Commitment"}),e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-6 rounded-lg border-l-4 border-blue-500",children:[e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"Zero File Storage Policy"}),e.jsxs("p",{children:[e.jsx("strong",{children:"We do not store, save, or retain any PDF files or documents you process through our Service."})," ","All PDF editing, processing, and manipulation occurs entirely within your web browser using client-side technology. Your files never leave your device or are transmitted to our servers."]})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"3. Information We Collect"}),e.jsx("h3",{className:"text-xl font-medium mb-3",children:"3.1 Personal Information"}),e.jsx("p",{children:"When you create an account, we collect:"}),e.jsxs("ul",{className:"list-disc ml-6 space-y-2",children:[e.jsx("li",{children:"Email address (required for account creation and communication)"}),e.jsx("li",{children:"First and last name (for account personalization)"}),e.jsx("li",{children:"Password (securely hashed and encrypted)"}),e.jsx("li",{children:"Profile information from OAuth providers (Google) if you choose to sign in via these services"})]}),e.jsx("h3",{className:"text-xl font-medium mb-3 mt-6",children:"3.2 Usage Information"}),e.jsx("p",{children:"We automatically collect certain information when you use our Service:"}),e.jsxs("ul",{className:"list-disc ml-6 space-y-2",children:[e.jsx("li",{children:"Device information (browser type, operating system, device identifiers)"}),e.jsx("li",{children:"Usage analytics (pages visited, features used, time spent on Service)"}),e.jsx("li",{children:"IP address and location data (for security and fraud prevention)"}),e.jsx("li",{children:"Log files and technical data (for debugging and service improvement)"})]}),e.jsx("h3",{className:"text-xl font-medium mb-3 mt-6",children:"3.3 Cookies and Tracking Technologies"}),e.jsx("p",{children:"We use cookies and similar technologies for:"}),e.jsxs("ul",{className:"list-disc ml-6 space-y-2",children:[e.jsx("li",{children:"Authentication and session management"}),e.jsx("li",{children:"User preferences and settings"}),e.jsx("li",{children:"Security features and fraud prevention"}),e.jsx("li",{children:"Analytics and service improvement"})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"4. How We Use Your Information"}),e.jsx("p",{children:"We use collected information solely for the following purposes:"}),e.jsxs("ul",{className:"list-disc ml-6 space-y-2",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Service Provision:"})," To provide, maintain, and improve our PDF editing services"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Account Management:"})," To create and manage your user account"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Authentication:"})," To verify your identity and secure your account"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Communication:"})," To send important updates, security alerts, and support messages"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Security:"})," To detect, prevent, and address technical issues and security threats"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Legal Compliance:"})," To comply with applicable laws and regulations"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Service Improvement:"})," To analyze usage patterns and improve our Service"]})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"5. Information Sharing and Disclosure"}),e.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 p-6 rounded-lg border-l-4 border-green-500 mb-6",children:[e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"No Third-Party Data Sharing"}),e.jsxs("p",{children:[e.jsx("strong",{children:"We do not sell, rent, trade, or otherwise share your personal information with third parties for their marketing or commercial purposes."})," ","Your data is used exclusively for the functioning of our Service."]})]}),e.jsx("h3",{className:"text-xl font-medium mb-3",children:"Limited Disclosure Circumstances"}),e.jsx("p",{children:"We may disclose your information only in the following limited circumstances:"}),e.jsxs("ul",{className:"list-disc ml-6 space-y-2",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Legal Requirements:"})," When required by law, court order, or government request"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Safety and Security:"})," To protect the rights, property, or safety of PDF4EVER, our users, or the public"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Business Transfers:"})," In connection with a merger, acquisition, or sale of assets (with user notification)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Consent:"})," When you have given explicit consent for specific sharing"]})]}),e.jsx("h3",{className:"text-xl font-medium mb-3 mt-6",children:"Service Providers"}),e.jsx("p",{children:"We may share information with trusted service providers who assist us in operating our Service, including:"}),e.jsxs("ul",{className:"list-disc ml-6 space-y-2",children:[e.jsx("li",{children:"Supabase (database and authentication services)"}),e.jsx("li",{children:"Google (OAuth authentication services)"}),e.jsx("li",{children:"Hosting and infrastructure providers"})]}),e.jsx("p",{className:"mt-3",children:"These providers are contractually bound to protect your information and use it only for the specified purposes."})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"6. Data Security"}),e.jsx("p",{children:"We implement comprehensive security measures to protect your information:"}),e.jsxs("ul",{className:"list-disc ml-6 space-y-2",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Encryption:"})," All data transmission uses industry-standard SSL/TLS encryption"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Password Security:"})," Passwords are hashed using bcrypt with salt"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Access Controls:"})," Strict access controls and authentication requirements"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Regular Audits:"})," Regular security assessments and vulnerability testing"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Data Minimization:"})," We collect and retain only necessary information"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Secure Infrastructure:"})," Use of reputable cloud providers with robust security measures"]})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"7. Your Rights and Choices"}),e.jsx("p",{children:"You have the following rights regarding your personal information:"}),e.jsxs("ul",{className:"list-disc ml-6 space-y-2",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Access:"})," Request access to your personal information"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Correction:"})," Request correction of inaccurate information"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Deletion:"})," Request deletion of your account and associated data"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Portability:"})," Request a copy of your data in a portable format"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Opt-out:"})," Unsubscribe from promotional communications"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Cookie Control:"})," Manage cookie preferences through your browser settings"]})]}),e.jsx("p",{className:"mt-3",children:"To exercise these rights, contact us at privacy@pdf4ever.com"})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"8. Data Retention"}),e.jsx("p",{children:"We retain your information for the following periods:"}),e.jsxs("ul",{className:"list-disc ml-6 space-y-2",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Account Information:"})," Until you delete your account or request deletion"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Usage Data:"})," Up to 2 years for analytics and service improvement"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Legal Compliance:"})," As required by applicable laws and regulations"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Security Logs:"})," Up to 1 year for security and fraud prevention"]})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"9. Children's Privacy"}),e.jsx("p",{children:"Our Service is not intended for children under 13 years of age. We do not knowingly collect personal information from children under 13. If we become aware that we have collected personal information from a child under 13, we will take steps to delete such information promptly."})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"10. International Users"}),e.jsx("p",{children:"Our Service is operated from the United States. If you are accessing our Service from outside the United States, please be aware that your information may be transferred to, stored, and processed in the United States where our servers are located and our central database is operated."})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"11. Changes to This Privacy Policy"}),e.jsx("p",{children:'We may update this Privacy Policy from time to time. We will notify you of any material changes by posting the new Privacy Policy on this page and updating the "Effective Date" at the top. We encourage you to review this Privacy Policy periodically for any changes.'})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"12. Contact Information"}),e.jsx("p",{children:"If you have any questions about this Privacy Policy or our privacy practices, please contact us:"}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 p-4 rounded-lg mt-4",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Email:"})," privacy@pdf4ever.com"]}),e.jsx("p",{children:e.jsx("strong",{children:"Mailing Address:"})}),e.jsxs("p",{children:["PDF4EVER Privacy Team",e.jsx("br",{}),"[Your Business Address]",e.jsx("br",{}),"[City], Missouri [ZIP Code]",e.jsx("br",{}),"United States"]})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"13. Missouri-Specific Rights"}),e.jsx("p",{children:"As a resident of Missouri, you may have additional rights under Missouri state law. We comply with all applicable Missouri data protection requirements, including proper notification procedures for data breaches and adherence to Missouri's consumer protection laws."})]})]})]})]})}function tr(){return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx("header",{className:"border-b bg-background/95 backdrop-blur sticky top-0 z-50",children:e.jsxs("div",{className:"container mx-auto px-4 py-4 flex items-center justify-between",children:[e.jsx(ze,{href:"/",children:e.jsxs("div",{className:"flex items-center space-x-3 cursor-pointer",children:[e.jsx("img",{src:"/70x70logo.png",alt:"PDF4EVER Logo",className:"h-10 w-10"}),e.jsx("span",{className:"text-2xl font-bold bg-gradient-to-r from-blue-600 to-orange-500 bg-clip-text text-transparent",children:"PDF4EVER"})]})}),e.jsx(ze,{href:"/",children:e.jsxs(R,{variant:"ghost",children:[e.jsx(dt,{className:"h-4 w-4 mr-2"}),"Back to Home"]})})]})}),e.jsxs("div",{className:"container mx-auto px-4 py-12 max-w-4xl",children:[e.jsx("h1",{className:"text-4xl font-bold mb-8",children:"Terms of Service"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-8",children:"Effective Date: December 6, 2024"}),e.jsxs("div",{className:"prose prose-lg dark:prose-invert max-w-none space-y-8",children:[e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"1. Acceptance of Terms"}),e.jsx("p",{children:'Welcome to PDF4EVER. These Terms of Service ("Terms") constitute a legally binding agreement between you ("User," "you," or "your") and PDF4EVER ("Company," "we," "our," or "us") regarding your use of our PDF editing web application and related services (collectively, the "Service"). By accessing or using our Service, you agree to be bound by these Terms and our Privacy Policy, which is incorporated herein by reference.'}),e.jsx("p",{children:"If you do not agree to these Terms, you may not access or use our Service. These Terms are governed by the laws of the State of Missouri and applicable federal laws of the United States."})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"2. Description of Service"}),e.jsx("p",{children:"PDF4EVER provides a web-based PDF editing platform that allows users to edit, annotate, merge, split, and manipulate PDF documents entirely within their web browser. Our Service operates on a privacy-first principle where all document processing occurs client-side, ensuring that your files never leave your device."}),e.jsx("h3",{className:"text-xl font-medium mb-3",children:"2.1 Service Features"}),e.jsxs("ul",{className:"list-disc ml-6 space-y-2",children:[e.jsx("li",{children:"PDF text editing and formatting"}),e.jsx("li",{children:"Digital signature capabilities"}),e.jsx("li",{children:"Form filling and completion"}),e.jsx("li",{children:"OCR (Optical Character Recognition) text extraction"}),e.jsx("li",{children:"Page merging and splitting"}),e.jsx("li",{children:"Annotation tools and markup"}),e.jsx("li",{children:"Font matching and text detection"}),e.jsx("li",{children:"Invoice generation and document templates"})]}),e.jsx("h3",{className:"text-xl font-medium mb-3 mt-6",children:"2.2 Privacy-First Architecture"}),e.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-6 rounded-lg border-l-4 border-blue-500",children:e.jsxs("p",{children:[e.jsx("strong",{children:"Important:"})," All PDF processing occurs locally in your web browser. We do not upload, store, or retain any PDF files or document content on our servers. This ensures complete privacy and security of your documents."]})})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"3. User Accounts and Registration"}),e.jsx("h3",{className:"text-xl font-medium mb-3",children:"3.1 Account Creation"}),e.jsx("p",{children:"To access certain features of our Service, you must create a user account. You may register using:"}),e.jsxs("ul",{className:"list-disc ml-6 space-y-2",children:[e.jsx("li",{children:"Email address and password"}),e.jsx("li",{children:"Google OAuth authentication"})]}),e.jsx("h3",{className:"text-xl font-medium mb-3 mt-6",children:"3.2 Account Responsibilities"}),e.jsx("p",{children:"You are responsible for:"}),e.jsxs("ul",{className:"list-disc ml-6 space-y-2",children:[e.jsx("li",{children:"Providing accurate and complete registration information"}),e.jsx("li",{children:"Maintaining the confidentiality of your account credentials"}),e.jsx("li",{children:"All activities that occur under your account"}),e.jsx("li",{children:"Immediately notifying us of any unauthorized use of your account"}),e.jsx("li",{children:"Using strong passwords that meet our security requirements"})]}),e.jsx("h3",{className:"text-xl font-medium mb-3 mt-6",children:"3.3 Account Termination"}),e.jsx("p",{children:"You may terminate your account at any time. We reserve the right to suspend or terminate accounts that violate these Terms or engage in prohibited activities."})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"4. Acceptable Use Policy"}),e.jsx("h3",{className:"text-xl font-medium mb-3",children:"4.1 Permitted Uses"}),e.jsx("p",{children:"You may use our Service for lawful purposes, including:"}),e.jsxs("ul",{className:"list-disc ml-6 space-y-2",children:[e.jsx("li",{children:"Personal document editing and management"}),e.jsx("li",{children:"Business document processing and workflow"}),e.jsx("li",{children:"Educational and academic document preparation"}),e.jsx("li",{children:"Legal document review and editing (non-attorney users)"})]}),e.jsx("h3",{className:"text-xl font-medium mb-3 mt-6",children:"4.2 Prohibited Uses"}),e.jsx("p",{children:"You agree not to use our Service to:"}),e.jsxs("ul",{className:"list-disc ml-6 space-y-2",children:[e.jsx("li",{children:"Process documents containing illegal content or activities"}),e.jsx("li",{children:"Violate any applicable laws, regulations, or third-party rights"}),e.jsx("li",{children:"Distribute malware, viruses, or other harmful code"}),e.jsx("li",{children:"Attempt to gain unauthorized access to our systems or other users' accounts"}),e.jsx("li",{children:"Reverse engineer, decompile, or attempt to extract source code"}),e.jsx("li",{children:"Use automated scripts or bots to access the Service"}),e.jsx("li",{children:"Interfere with or disrupt the Service's functionality"}),e.jsx("li",{children:"Create fraudulent or misleading documents"}),e.jsx("li",{children:"Process documents containing personal information of others without consent"}),e.jsx("li",{children:"Violate intellectual property rights of third parties"})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"5. Intellectual Property Rights"}),e.jsx("h3",{className:"text-xl font-medium mb-3",children:"5.1 Our Intellectual Property"}),e.jsx("p",{children:"The Service, including its software, design, text, graphics, logos, and other content, is owned by PDF4EVER and is protected by intellectual property laws. You are granted a limited, non-exclusive, non-transferable license to use the Service for its intended purpose."}),e.jsx("h3",{className:"text-xl font-medium mb-3 mt-6",children:"5.2 Your Content"}),e.jsx("p",{children:"You retain all rights to the documents and content you process through our Service. Since we do not store your files, we do not claim any ownership rights to your content. You are solely responsible for ensuring you have the right to process any documents you upload to the Service."}),e.jsx("h3",{className:"text-xl font-medium mb-3 mt-6",children:"5.3 Feedback and Suggestions"}),e.jsx("p",{children:"Any feedback, suggestions, or ideas you provide to us regarding the Service may be used by us without any obligation to compensate you."})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"6. Privacy and Data Protection"}),e.jsx("p",{children:"Your privacy is fundamental to our Service. We encourage you to review our Privacy Policy, which explains our data collection, use, and protection practices. Key privacy principles include:"}),e.jsxs("ul",{className:"list-disc ml-6 space-y-2",children:[e.jsx("li",{children:"No storage of your PDF files or document content"}),e.jsx("li",{children:"Client-side processing to ensure document privacy"}),e.jsx("li",{children:"Minimal data collection for account functionality only"}),e.jsx("li",{children:"No sharing of personal information with third parties for marketing purposes"}),e.jsx("li",{children:"Strong security measures to protect account information"})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"7. Service Availability and Modifications"}),e.jsx("h3",{className:"text-xl font-medium mb-3",children:"7.1 Service Availability"}),e.jsx("p",{children:"We strive to maintain continuous Service availability but cannot guarantee uninterrupted access. The Service may be temporarily unavailable due to maintenance, updates, or technical issues."}),e.jsx("h3",{className:"text-xl font-medium mb-3 mt-6",children:"7.2 Service Modifications"}),e.jsx("p",{children:"We reserve the right to modify, update, or discontinue features of the Service at any time. We will provide reasonable notice of material changes that affect Service functionality."})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"8. Disclaimers and Limitations of Liability"}),e.jsx("h3",{className:"text-xl font-medium mb-3",children:"8.1 Service Disclaimers"}),e.jsx("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 p-6 rounded-lg border-l-4 border-yellow-500",children:e.jsx("p",{children:'THE SERVICE IS PROVIDED "AS IS" AND "AS AVAILABLE" WITHOUT WARRANTIES OF ANY KIND, EITHER EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE, OR NON-INFRINGEMENT.'})}),e.jsx("h3",{className:"text-xl font-medium mb-3 mt-6",children:"8.2 Limitation of Liability"}),e.jsx("p",{children:"TO THE MAXIMUM EXTENT PERMITTED BY LAW, PDF4EVER SHALL NOT BE LIABLE FOR ANY INDIRECT, INCIDENTAL, SPECIAL, CONSEQUENTIAL, OR PUNITIVE DAMAGES, INCLUDING BUT NOT LIMITED TO LOSS OF DATA, LOSS OF PROFITS, OR BUSINESS INTERRUPTION."}),e.jsx("p",{children:"OUR TOTAL LIABILITY TO YOU FOR ANY CLAIMS ARISING OUT OF OR RELATING TO THESE TERMS OR THE SERVICE SHALL NOT EXCEED THE AMOUNT YOU PAID TO US IN THE TWELVE (12) MONTHS PRECEDING THE CLAIM."}),e.jsx("h3",{className:"text-xl font-medium mb-3 mt-6",children:"8.3 Missouri Law Compliance"}),e.jsx("p",{children:"Some jurisdictions do not allow the exclusion of certain warranties or limitation of liability. In such cases, our liability will be limited to the maximum extent permitted by Missouri state law."})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"9. Indemnification"}),e.jsx("p",{children:"You agree to indemnify, defend, and hold harmless PDF4EVER, its officers, directors, employees, and agents from and against any claims, damages, losses, costs, and expenses (including reasonable attorneys' fees) arising out of or relating to:"}),e.jsxs("ul",{className:"list-disc ml-6 space-y-2",children:[e.jsx("li",{children:"Your use of the Service"}),e.jsx("li",{children:"Your violation of these Terms"}),e.jsx("li",{children:"Your violation of any applicable laws or regulations"}),e.jsx("li",{children:"Your infringement of any third-party rights"}),e.jsx("li",{children:"Content you process through the Service"})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"10. Governing Law and Dispute Resolution"}),e.jsx("h3",{className:"text-xl font-medium mb-3",children:"10.1 Governing Law"}),e.jsx("p",{children:"These Terms are governed by and construed in accordance with the laws of the State of Missouri, without regard to its conflict of law principles. Any disputes shall be resolved in the state or federal courts located in Missouri."}),e.jsx("h3",{className:"text-xl font-medium mb-3 mt-6",children:"10.2 Dispute Resolution"}),e.jsx("p",{children:"Before filing any legal claim, you agree to first contact us to attempt to resolve the dispute informally. We will work in good faith to resolve any issues through direct communication."}),e.jsx("h3",{className:"text-xl font-medium mb-3 mt-6",children:"10.3 Class Action Waiver"}),e.jsx("p",{children:"You agree that any dispute resolution proceedings will be conducted only on an individual basis and not in a class, consolidated, or representative action."})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"11. Termination"}),e.jsx("p",{children:"Either party may terminate this agreement at any time. Upon termination:"}),e.jsxs("ul",{className:"list-disc ml-6 space-y-2",children:[e.jsx("li",{children:"Your access to the Service will be immediately suspended"}),e.jsx("li",{children:"Your account information may be deleted in accordance with our Privacy Policy"}),e.jsx("li",{children:"Provisions that should survive termination will remain in effect"})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"12. Changes to Terms"}),e.jsx("p",{children:"We may update these Terms from time to time to reflect changes in our Service, legal requirements, or business practices. Material changes will be communicated through:"}),e.jsxs("ul",{className:"list-disc ml-6 space-y-2",children:[e.jsx("li",{children:"Email notification to registered users"}),e.jsx("li",{children:"Prominent notice on our website"}),e.jsx("li",{children:"In-app notifications"})]}),e.jsx("p",{children:"Continued use of the Service after changes take effect constitutes acceptance of the updated Terms."})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"13. Severability"}),e.jsx("p",{children:"If any provision of these Terms is found to be unenforceable or invalid, the remaining provisions will continue in full force and effect."})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"14. Entire Agreement"}),e.jsx("p",{children:"These Terms, together with our Privacy Policy, constitute the entire agreement between you and PDF4EVER regarding the Service and supersede all prior agreements and understandings."})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"15. Contact Information"}),e.jsx("p",{children:"If you have any questions about these Terms of Service, please contact us:"}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 p-4 rounded-lg mt-4",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Email:"})," legal@pdf4ever.com"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Support:"})," support@pdf4ever.com"]}),e.jsx("p",{children:e.jsx("strong",{children:"Mailing Address:"})}),e.jsxs("p",{children:["PDF4EVER Legal Department",e.jsx("br",{}),"[Your Business Address]",e.jsx("br",{}),"[City], Missouri [ZIP Code]",e.jsx("br",{}),"United States"]})]})]}),e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-6 rounded-lg border-l-4 border-blue-500 mt-8",children:[e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"Questions or Concerns?"}),e.jsx("p",{children:"We're committed to transparency and user satisfaction. If you have any questions about these Terms or need clarification on any provision, please don't hesitate to contact our support team."})]})]})]})]})}function sr(){return e.jsx("div",{className:"min-h-screen w-full flex items-center justify-center bg-gray-50",children:e.jsx(V,{className:"w-full max-w-md mx-4",children:e.jsxs(G,{className:"pt-6",children:[e.jsxs("div",{className:"flex mb-4 gap-2",children:[e.jsx(ct,{className:"h-8 w-8 text-red-500"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"404 Page Not Found"})]}),e.jsx("p",{className:"mt-4 text-sm text-gray-600",children:"Did you forget to add the page to the router?"})]})})})}function ar(){return e.jsx(vn,{defaultTheme:"dark",storageKey:"pdf-app-theme","data-oid":"prycx75",children:e.jsx(fa,{"data-oid":"8x.8iba",children:e.jsxs(Mn,{"data-oid":"c4648-d",children:[e.jsx(jn,{"data-oid":"lum4:yf"}),e.jsxs(pa,{"data-oid":"d-9:2oi",children:[e.jsx(we,{path:"/",element:e.jsx(Zi,{"data-oid":"7notf10"}),"data-oid":"blb0mui"}),e.jsx(we,{path:"/pricing",element:e.jsx(Qi,{"data-oid":"pxo1qwo"}),"data-oid":"arr733o"}),e.jsx(we,{path:"/privacy-policy",element:e.jsx(er,{"data-oid":"gj-fdks"}),"data-oid":"-q8dwnv"}),e.jsx(we,{path:"/terms-of-service",element:e.jsx(tr,{"data-oid":"263dp6z"}),"data-oid":"gmub-i."}),e.jsx(we,{path:"*",element:e.jsx(sr,{"data-oid":"gtv3b:b"}),"data-oid":"5w__k4d"})]})]})})})}const nr=new dn,Ys=document.getElementById("root");if(!Ys)throw new Error("Root element not found!");ga.createRoot(Ys).render(e.jsx(W.StrictMode,{children:e.jsx(hn,{client:nr,children:e.jsx(ar,{})})}));
